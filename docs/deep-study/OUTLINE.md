# CCW æ¶æ„çº§æ·±åº¦ç ”ä¹  - ä¸»å¤§çº²

> **ç›®æ ‡è¯»è€…**: æ¶æ„å¸ˆ + æ ¸å¿ƒè´¡çŒ®è€…
> **æ·±åº¦è®¾å®š**: ä¸è§£é‡ŠåŸºç¡€è¯­æ³•ï¼Œç›´æŒ‡"æ·±æ°´åŒº"
> **ç»„ç»‡æ–¹å¼**: ç”Ÿå‘½å‘¨æœŸæµ (Flow-centric) + åŸå­èµ„äº§åº“ (Asset-based) æ·±åº¦è§£è€¦
> **ç‰ˆæœ¬è¿½è¸ª**: Git Hash å¿«ç…§ + MEU æ¼‚ç§»æ£€æµ‹

---

## åºå¹•ï¼šOOM å¹½çµçš„åˆç°

> *æ—¶é—´: 2025-02-17 03:47:12 UTC*
> *åœ°ç‚¹: ç”Ÿäº§ç¯å¢ƒ â€” ccw-session-0af3c2*

```log
[03:47:12.003] CRITICAL â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[03:47:12.004] ! Memory allocation failed: 98.7% usage (15.8GB / 16GB)
[03:47:12.005] ! CLI Session Manager: subprocess SIGKILL (exit 137)
[03:47:12.006] ! SQLite: Database locked â€” 17 transactions rolled back
[03:47:12.007] â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

**å‡Œæ™¨ä¸‰ç‚¹çš„å‘Šè­¦**ï¼Œåˆ’ç ´äº†å€¼ç­å·¥ç¨‹å¸ˆçš„ç¡çœ ã€‚

è¿™ä¸æ˜¯ä¸€æ¬¡æ™®é€šçš„å´©æºƒã€‚å®ƒæ˜¯ä¸€ä¸ª**å¹½çµ** â€” ä¸€ä¸ªåœ¨ TypeScript ä¸ Python è¾¹ç•Œæ¸¸è¡çš„å†…å­˜æ³„æ¼æ€ªå…½ã€‚å®ƒä»ä¸ç™½å¤©å‡ºç°ï¼Œåªåœ¨ç³»ç»Ÿè¿è¡Œ 72 å°æ—¶åã€è´Ÿè½½è¾¾åˆ°ç‰¹å®šé˜ˆå€¼æ—¶ï¼Œæ‚„ç„¶åå™¬ä¸€åˆ‡ã€‚

**è¿™ä¸æ˜¯ä¸€ä¸ª Bug çš„æ•…äº‹ã€‚**

**è¿™æ˜¯ä¸€åœºæŒç»­ 24 ç« çš„"ç ´æ¡ˆ"ã€‚**

ä» `/ccw` å‘½ä»¤çš„ç¬¬ä¸€ä¸ªå­—ç¬¦è¢«æ•²ä¸‹ï¼Œåˆ° SQLite äº‹åŠ¡çš„æœ€åä¸€æ¡è®°å½•è¢«å†™å…¥ï¼Œæˆ‘ä»¬å°†è¿½è¸ªè¿™ä¸ªå¹½çµçš„æ¯ä¸€ä¸ªè„šå°ã€‚ä½ å°†çœ‹åˆ°ï¼š

- **Part I-II**ï¼šå…¥å£å¤„çš„è››ä¸é©¬è¿¹
- **Part IV.5**ï¼šè¾¹å¢ƒå£å²¸çš„"å¤–äº¤ä¸‘é—»"
- **Part VI**ï¼šå‘é‡ç´¢å¼•å™¨çš„"è®°å¿†é»‘æ´"
- **Part VII**ï¼šå­˜å‚¨å±‚çš„"æœªç«Ÿä¹‹äº‹"
- **Part XI**ï¼šæ¯ä¸ªæ¶‰æ¡ˆèµ„äº§çš„å®Œæ•´å®¡è®¯è®°å½•

```markdown
**è°ƒæŸ¥è¿›åº¦**: â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 0%
**å¹½çµä½ç½®**: æœªçŸ¥
**æ¶‰æ¡ˆèµ„äº§**: 950+
```

> *"åœ¨è¿™åº§ä»£ç åŸå¸‚ä¸­ï¼Œæ²¡æœ‰äººæ˜¯æ— è¾œçš„ã€‚æ¯ä¸ªæ–‡ä»¶éƒ½è—ç€ç§˜å¯†ï¼Œæ¯ä¸ªå‡½æ•°éƒ½å¯èƒ½æ˜¯å‡¶æ‰‹ã€‚"*
>
> â€” åŒ¿åæ¶æ„å¸ˆ

---

## è®¾è®¡å“²å­¦

### è‹æ ¼æ‹‰åº•å¼å­¦ä¹ 

åœ¨æ¯ä¸ªå…³é”®èŠ‚ç‚¹è®¾ç½®"æ¶æ„ç›²ç‚¹"æé—®ï¼Œ**åœ¨çœ‹ä»£ç å‰å…ˆè¿›è¡Œæ–¹æ¡ˆè®¾è®¡**ï¼š

> â“ **æ¶æ„ç›²ç‚¹**: å¦‚æœè®©ä½ è®¾è®¡è¿™ä¸ªç³»ç»Ÿï¼Œä½ ä¼šæ€ä¹ˆåšï¼Ÿ

### ç”Ÿå‘½å‘¨æœŸæµä¸»çº¿

```
ç”¨æˆ·è¾“å…¥ â†’ å‘½ä»¤è§£æ â†’ è·¯ç”±åˆ†å‘ â†’ Skill ç¼–æ’ â†’ Agent æ‰§è¡Œ â†’ å·¥å…·è°ƒç”¨ â†’ çŠ¶æ€æŒä¹…åŒ–
   â”‚           â”‚           â”‚           â”‚           â”‚           â”‚           â”‚
   â–¼           â–¼           â–¼           â–¼           â–¼           â–¼           â–¼
  å…¥å£å±‚      è°ƒåº¦å±‚      ä¼ è¾“å±‚      ç¼–æ’å±‚      æ‰§è¡Œå±‚      é›†æˆå±‚      å­˜å‚¨å±‚
```

---

## Part I: å…¥å£å±‚ - ç”¨æˆ·äº¤äº’çš„èµ·ç‚¹

### Chapter 1: Slash Command è§¦å‘é“¾è·¯

**ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ**: ç”¨æˆ·è¾“å…¥ â†’ å‘½ä»¤è¯†åˆ«

> â“ **æ¶æ„ç›²ç‚¹ 1.1**: Claude Code å¦‚ä½•è¯†åˆ« `/ccw` è¿™æ ·çš„å‘½ä»¤ï¼Ÿæ˜¯ç¡¬ç¼–ç è¿˜æ˜¯é…ç½®é©±åŠ¨ï¼Ÿ

**æ¶‰åŠèµ„äº§**:
- `.claude/commands/ccw.md` - ä¸»å…¥å£å‘½ä»¤
- `.claude/commands/ccw-*.md` - åè°ƒå™¨å‘½ä»¤æ—

**å…³é”®é—®é¢˜**:
1. å‘½ä»¤çš„ `description` å­—æ®µå¦‚ä½•å½±å“æ„å›¾åˆ†æï¼Ÿ
2. å‘½ä»¤å‚æ•°å¦‚ä½•ä¼ é€’åˆ° Skillï¼Ÿ
3. `-c` / `-y` ç­‰é€‰é¡¹çš„è§£æé€»è¾‘åœ¨å“ªé‡Œï¼Ÿ

**æ·±å…¥è·¯å¾„**:
```
.cclaude/commands/ccw.md (å‘½ä»¤å®šä¹‰)
    â†“
.claude/skills/ccw/SKILL.md (æŠ€èƒ½ç¼–æ’)
    â†“
ccw/src/commands/cli.ts (CLI å‘½ä»¤å®ç°)
```

### Chapter 2: CLI å…¥å£ç‚¹

**ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ**: å‘½ä»¤è¡Œå‚æ•°è§£æ

> â“ **æ¶æ„ç›²ç‚¹ 2.1**: `ccw cli -p "..." --tool gemini` çš„å®Œæ•´è§£ææµç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ

**æ¶‰åŠèµ„äº§**:
- `ccw/src/commands/cli.ts` - CLI å‘½ä»¤å…¥å£
- `ccw/src/tools/cli-executor-core.ts` - æ‰§è¡Œæ ¸å¿ƒ (60KB)
- `ccw/src/tools/cli-prompt-builder.ts` - æç¤ºæ„å»ºå™¨

**å…³é”®é—®é¢˜**:
1. `--tool` å‚æ•°å¦‚ä½•æ˜ å°„åˆ°å…·ä½“ CLI å·¥å…·ï¼Ÿ
2. `--mode analysis|write` çš„æƒé™è¾¹ç•Œåœ¨å“ªé‡Œå®ç°ï¼Ÿ
3. ä¼šè¯æ¢å¤ (`--resume`) å¦‚ä½•å·¥ä½œï¼Ÿ

---

## Part II: è°ƒåº¦å±‚ - æ„å›¾åˆ†æä¸å·¥ä½œæµé€‰æ‹©

### Chapter 3: æ„å›¾åˆ†æå¼•æ“

**ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ**: ä»»åŠ¡æ„å›¾ â†’ å·¥ä½œæµçº§åˆ«é€‰æ‹©

> â“ **æ¶æ„ç›²ç‚¹ 3.1**: CCW å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªä»»åŠ¡åº”è¯¥ç”¨ Level 1 (lite-lite-lite) è¿˜æ˜¯ Level 4 (brainstorm)?

**æ¶‰åŠèµ„äº§**:
- `.claude/skills/ccw/SKILL.md` - æ„å›¾åˆ†æé€»è¾‘
- `.ccw/workflows/cli-templates/schemas/*.json` - è¾“å‡ºç»“æ„å®šä¹‰

**å…³é”®é—®é¢˜**:
1. æ„å›¾åˆ†æçš„ prompt æ¨¡æ¿åœ¨å“ªé‡Œï¼Ÿ
2. 4 çº§å·¥ä½œæµçš„åˆ¤æ–­æ ‡å‡†æ˜¯ä»€ä¹ˆï¼Ÿ
3. å¦‚ä½•å¤„ç†è¾¹ç•Œæƒ…å†µï¼ˆæ„å›¾æ¨¡ç³Šï¼‰ï¼Ÿ

### Chapter 4: å·¥ä½œæµçº§åˆ«æ˜ å°„

**ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ**: å·¥ä½œæµçº§åˆ« â†’ å…·ä½“æ‰§è¡Œé“¾è·¯

| çº§åˆ« | åç§° | è§¦å‘æ¡ä»¶ | æ‰§è¡Œé“¾è·¯ |
|------|------|----------|----------|
| 1 | lite-lite-lite | å•æ–‡ä»¶ã€é…ç½®ä¿®æ”¹ | å•æ­¥æ‰§è¡Œ |
| 2 | lite-plan/lite-fix | å•æ¨¡å—åŠŸèƒ½ | plan â†’ execute |
| 3 | plan/tdd-plan | å¤šæ¨¡å—ã€TDD | plan â†’ verify â†’ execute â†’ review |
| 4 | brainstorm:auto-parallel | æ¶æ„è®¾è®¡ | brainstorm â†’ plan â†’ execute |

> â“ **æ¶æ„ç›²ç‚¹ 4.1**: å¦‚æœ Level åˆ¤æ–­é”™è¯¯ï¼Œç³»ç»Ÿå¦‚ä½•æ¢å¤ï¼Ÿ

---

## Part III: ä¼ è¾“å±‚ - Express è·¯ç”±ä¸ API

### Chapter 5: Express è·¯ç”±æ¶æ„

**ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ**: HTTP è¯·æ±‚ â†’ è·¯ç”±åŒ¹é… â†’ å¤„ç†å™¨è°ƒç”¨

> â“ **æ¶æ„ç›²ç‚¹ 5.1**: 36 ä¸ªè·¯ç”±æ–‡ä»¶å¦‚ä½•ç»„ç»‡ï¼Ÿæ˜¯å¦æŒ‰åŠŸèƒ½åŸŸåˆ’åˆ†ï¼Ÿ

**æ¶‰åŠèµ„äº§**:
- `ccw/src/core/routes/*.ts` - 36 ä¸ªè·¯ç”±æ–‡ä»¶
- `ccw/src/core/services/*.ts` - 10 ä¸ªæ ¸å¿ƒæœåŠ¡

**å…³é”®è·¯ç”±åˆ†æ**:
1. `cli-routes.ts` - CLI æ‰§è¡Œ API
2. `session-routes.ts` - ä¼šè¯ç®¡ç† API
3. `skills-routes.ts` - æŠ€èƒ½è°ƒç”¨ API
4. `mcp-routes.ts` - MCP åè®® API

### Chapter 6: ä¼šè¯ç®¡ç†æœåŠ¡

**ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ**: ä¼šè¯åˆ›å»º â†’ çŠ¶æ€è¿½è¸ª â†’ æŒä¹…åŒ–

> â“ **æ¶æ„ç›²ç‚¹ 6.1**: SQLite ä¼šè¯è¡¨ç»“æ„æ˜¯æ€æ ·çš„ï¼Ÿå¦‚ä½•æ”¯æŒä¼šè¯æ¢å¤ï¼Ÿ

**æ¶‰åŠèµ„äº§**:
- `ccw/src/core/services/cli-session-manager.ts` - ä¼šè¯ç®¡ç†å™¨
- `ccw/src/tools/session-manager.ts` - ä¼šè¯å·¥å…· (33KB)
- `ccw/src/tools/native-session-discovery.ts` - ä¼šè¯å‘ç°

**å…³é”®é—®é¢˜**:
1. ä¼šè¯çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸæ˜¯ä»€ä¹ˆï¼Ÿ
2. ä¼šè¯ä¸­æ–­åå¦‚ä½•æ¢å¤ï¼Ÿ
3. å¤š CLI ä¼šè¯å¦‚ä½•å¹¶å‘ï¼Ÿ

---

## Part III.5: ç±»å‹ç³»ç»Ÿä¸ Schema å®šä¹‰

> **æ¶æ„æ„ä¹‰**: ç±»å‹å®šä¹‰æ˜¯ç³»ç»Ÿå¥‘çº¦çš„åŸºç¡€ï¼ŒJSON Schema æ˜¯è·¨è¯­è¨€é€šä¿¡çš„ä¿éšœã€‚

### Chapter 6.5: TypeScript ç±»å‹å®šä¹‰

**ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ**: ç±»å‹å£°æ˜ â†’ ç¼–è¯‘æ—¶æ£€æŸ¥ â†’ è¿è¡Œæ—¶éªŒè¯

> â“ **æ¶æ„ç›²ç‚¹ 6.5.1**: ç±»å‹å®šä¹‰å¦‚ä½•ä¸ JSON Schema ä¿æŒåŒæ­¥ï¼Ÿæ˜¯å¦æœ‰è‡ªåŠ¨ç”Ÿæˆæœºåˆ¶ï¼Ÿ

**æ¶‰åŠèµ„äº§**:
- `ccw/src/types/tool.ts` - å·¥å…·ç±»å‹å®šä¹‰
- `ccw/src/types/session.ts` - ä¼šè¯ç±»å‹å®šä¹‰
- `ccw/src/types/config.ts` - é…ç½®ç±»å‹å®šä¹‰
- `ccw/src/types/loop.ts` - å¾ªç¯ç±»å‹å®šä¹‰
- `ccw/src/types/skill-types.ts` - æŠ€èƒ½ç±»å‹å®šä¹‰
- `ccw/src/types/cli-settings.ts` - CLI è®¾ç½®ç±»å‹
- `ccw/src/types/litellm-api-config.ts` - LiteLLM API é…ç½®
- `ccw/src/types/index.ts` - ç±»å‹å…¥å£

**æ ¸å¿ƒç±»å‹ç»“æ„**:

```typescript
// å·¥å…·å®šä¹‰
interface Tool {
  name: string;
  description: string;
  input_schema: JSONSchema;
  output_schema?: JSONSchema;
}

// ä¼šè¯çŠ¶æ€
interface SessionState {
  id: string;
  status: 'pending' | 'in_progress' | 'completed' | 'failed';
  context: Record<string, unknown>;
  created_at: Date;
  updated_at: Date;
}

// æŠ€èƒ½å®šä¹‰
interface Skill {
  name: string;
  description: string;
  phases: Phase[];
  allowed_tools?: string[];
}
```

**å…³é”®é—®é¢˜**:
1. ç±»å‹å®šä¹‰ä¸è¿è¡Œæ—¶éªŒè¯å¦‚ä½•ååŒï¼Ÿ
2. å¦‚ä½•å¤„ç†è·¨è¯­è¨€ç±»å‹è½¬æ¢ï¼Ÿ
3. ç±»å‹å®šä¹‰çš„ç‰ˆæœ¬å…¼å®¹æ€§å¦‚ä½•ä¿è¯ï¼Ÿ

### Chapter 6.6: JSON Schema è§„èŒƒ

**ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ**: Schema å®šä¹‰ â†’ éªŒè¯ â†’ æ–‡æ¡£ç”Ÿæˆ

> â“ **æ¶æ„ç›²ç‚¹ 6.6.1**: Schema éªŒè¯åœ¨å“ªä¸ªå±‚çº§æ‰§è¡Œï¼Ÿæ˜¯å…¥å£éªŒè¯è¿˜æ˜¯é€å±‚ä¼ é€’ï¼Ÿ

**æ¶‰åŠèµ„äº§**:
- `.ccw/workflows/cli-templates/schemas/plan-json-schema.json` - è®¡åˆ’ç»“æ„å®šä¹‰
- `.ccw/workflows/cli-templates/schemas/task-schema.json` - ä»»åŠ¡ç»“æ„å®šä¹‰
- `.ccw/workflows/cli-templates/schemas/debug-log-json-schema.json` - è°ƒè¯•æ—¥å¿—ç»“æ„
- `.ccw/workflows/cli-templates/schemas/discovery-state-schema.json` - å‘ç°é˜¶æ®µçŠ¶æ€
- `.ccw/workflows/cli-templates/schemas/queue-schema.json` - é˜Ÿåˆ—ç»“æ„
- å…¶ä»– ~15 ä¸ª Schema æ–‡ä»¶

**Schema å±‚æ¬¡ç»“æ„**:

```
plan-json-schema.json
â”œâ”€â”€ task-schema.json (åµŒå¥—)
â”‚   â”œâ”€â”€ step-schema.json
â”‚   â””â”€â”€ dependency-schema.json
â”œâ”€â”€ context-schema.json
â””â”€â”€ output-schema.json
```

**éªŒè¯ç­–ç•¥**:
1. å…¥å£éªŒè¯ï¼šè¯·æ±‚å‚æ•°å¿…é¡»ç¬¦åˆ Schema
2. ä¸­é—´éªŒè¯ï¼šé˜¶æ®µé—´ä¼ é€’çš„æ•°æ®å¿…é¡»ç¬¦åˆ Schema
3. è¾“å‡ºéªŒè¯ï¼šæœ€ç»ˆè¾“å‡ºå¿…é¡»ç¬¦åˆ Schema

---

## Part IV: ç¼–æ’å±‚ - Skill é˜¶æ®µæœº

### Chapter 7: Skill å®šä¹‰è¯­è¨€

**ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ**: Skill åŠ è½½ â†’ é˜¶æ®µè§£æ â†’ é¡ºåºæ‰§è¡Œ

> â“ **æ¶æ„ç›²ç‚¹ 7.1**: Skill çš„ `phases` å­—æ®µå¦‚ä½•è¢«è§£æï¼Ÿæ˜¯ DSL è¿˜æ˜¯é…ç½®ï¼Ÿ

**æ¶‰åŠèµ„äº§**:
- `.claude/skills/*/SKILL.md` - 27 ä¸ªæŠ€èƒ½å®šä¹‰
- `ccw/src/tools/skill-context-loader.ts` - ä¸Šä¸‹æ–‡åŠ è½½å™¨

**å…³é”®é—®é¢˜**:
1. Skill ä¸ Command çš„è¾¹ç•Œåœ¨å“ªé‡Œï¼Ÿ
2. Skill çš„é˜¶æ®µå¦‚ä½•ä¸ Agent æ˜ å°„ï¼Ÿ
3. é˜¶æ®µé—´çŠ¶æ€å¦‚ä½•ä¼ é€’ï¼Ÿ

### Chapter 8: æ ¸å¿ƒæŠ€èƒ½æ·±åº¦è§£æ

**é‡ç‚¹æŠ€èƒ½**:

| æŠ€èƒ½ | ç”¨é€” | é˜¶æ®µæ•° | å¤æ‚åº¦ |
|------|------|--------|--------|
| `workflow-plan` | 4 é˜¶æ®µè§„åˆ’ | 4 | é«˜ |
| `brainstorm` | å¤šè§’è‰²å¤´è„‘é£æš´ | 5+ | é«˜ |
| `issue-resolve` | Issue è§£å†³ç®¡é“ | 4 | ä¸­ |
| `workflow-tdd` | TDD å·¥ä½œæµ | 6 | é«˜ |

---

## Part IV.5: è·¨è¯­è¨€æ¡¥æ¥ä¸“é¢˜ - TS â†” Python è¾¹ç•Œ

> **æ¶æ„æ„ä¹‰**: CCW çš„æ ¸å¿ƒèµ„äº§åˆ†å¸ƒåœ¨ TypeScript (CCW CLI) å’Œ Python (CodexLens/LiteLLM) ä¸­ã€‚è·¨è¯­è¨€æ¡¥æ¥æ˜¯ç³»ç»Ÿæœ€å®¹æ˜“å´©æºƒçš„è¾¹ç¼˜æƒ…å†µã€‚

### Chapter 10.5: child_process è°ƒç”¨æœºåˆ¶

**ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ**: è¿›ç¨‹åˆ›å»º â†’ å‚æ•°åºåˆ—åŒ– â†’ IPC é€šä¿¡ â†’ ç»“æœæ”¶é›†

> â“ **æ¶æ„ç›²ç‚¹ 10.5.1**: TS è°ƒç”¨ Python æ—¶çš„ `child_process.spawn` å‚æ•°å¦‚ä½•æ„å»ºï¼Ÿç¯å¢ƒå˜é‡å¦‚ä½•ä¼ é€’ï¼Ÿ

**æ¶‰åŠèµ„äº§**:
- `ccw/src/tools/cli-executor-core.ts` - CLI æ‰§è¡Œæ ¸å¿ƒ
- `codex-lens/src/codexlens/cli/` - Python CLI å…¥å£
- `ccw/src/utils/python-utils.ts` - Python å·¥å…·å‡½æ•°

**å…³é”®é—®é¢˜**:
1. Python è™šæ‹Ÿç¯å¢ƒå¦‚ä½•å‘ç°å’Œæ¿€æ´»ï¼Ÿ
2. å¤§å‹å‚æ•°ï¼ˆå¦‚å®Œæ•´æ–‡ä»¶å†…å®¹ï¼‰å¦‚ä½•ä¼ é€’ï¼Ÿ
3. è¿›ç¨‹è¶…æ—¶å’Œå¼ºåˆ¶ç»ˆæ­¢å¦‚ä½•å¤„ç†ï¼Ÿ

**è¾¹ç¼˜æƒ…å†µ**:
- Python è¿›ç¨‹å‡æ­»
- ç¼–ç ä¸ä¸€è‡´ï¼ˆUTF-8 vs GBKï¼‰
- ç¯å¢ƒå˜é‡æ±¡æŸ“

### Chapter 10.6: JSON-RPC åºåˆ—åŒ–è¾¹ç•Œ

**ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ**: å¯¹è±¡åºåˆ—åŒ– â†’ ä¼ è¾“ â†’ ååºåˆ—åŒ– â†’ ç±»å‹æ¢å¤

> â“ **æ¶æ„ç›²ç‚¹ 10.6.1**: JSON åºåˆ—åŒ–æ—¶çš„ç±»å‹ä¿¡æ¯ä¸¢å¤±å¦‚ä½•å¤„ç†ï¼Ÿä¾‹å¦‚ Python çš„ `datetime` åœ¨ JSON ä¸­å˜æˆå­—ç¬¦ä¸²ã€‚

**æ¶‰åŠèµ„äº§**:
- `ccw/src/tools/cli-output-converter.ts` - è¾“å‡ºè½¬æ¢ (46KB)
- `codex-lens/src/codexlens/api/` - API å±‚
- `codex-lens/src/codexlens/mcp/` - MCP åè®®

**åºåˆ—åŒ–æŸè€—åˆ†æ**:

| TS ç±»å‹ | JSON | Python ç±»å‹ | æŸè€— |
|---------|------|-------------|------|
| `Date` | string | `datetime` | âœ… å¯æ¢å¤ |
| `Map` | object | `dict` | âš ï¸ é”®ç±»å‹ä¸¢å¤± |
| `Set` | array | `list` | âš ï¸ å”¯ä¸€æ€§ä¸¢å¤± |
| `undefined` | (ç¼ºå¤±) | `None` | âœ… å¯æ˜ å°„ |
| `BigInt` | string | `int` | âš ï¸ ç²¾åº¦é—®é¢˜ |

**MCP åè®®å±‚**:
- stdio é€šä¿¡çš„ç¼“å†²åŒºç®¡ç†
- æ¶ˆæ¯è¾¹ç•Œçš„ç•Œå®šï¼ˆ`\n` åˆ†éš” vs é•¿åº¦å‰ç¼€ï¼‰
- æµå¼å“åº”çš„åˆ†å—å¤„ç†

---

> **ğŸ” äº‹æ•…å¤ç›˜æ¡£æ¡ˆ #10.6ï¼šç±»å‹èµ°ç§æ¡ˆ**
>
> *æ—¶é—´: 2024-11-23 14:32:07 UTC*
> *å½±å“: 3 ç¬”é‡‘èäº¤æ˜“é‡‘é¢è®¡ç®—é”™è¯¯ï¼ŒæŸå¤± $47,231.58*
>
> **æ¡ˆæƒ…è¿˜åŸ**:
> ```typescript
> // TypeScript ç«¯ï¼šä¸€ä¸ª BigInt èº«ä»½è¯å·
> const transaction = {
>   id: 9007199254740993n,  // è¶…è¿‡ Number.MAX_SAFE_INTEGER
>   amount: 47231.58,
>   timestamp: new Date()
> };
>
> // JSON åºåˆ—åŒ–å...
> // { "id": "9007199254740993", "amount": 47231.58, ... }
> ```
>
> **èµ°ç§è¿‡ç¨‹**:
> ```python
> # Python ç«¯ï¼šå­—ç¬¦ä¸²è¢«è¯¯è§£æ
> data = json.loads(payload)
> transaction_id = int(data['id'])  # çœ‹èµ·æ¥æ²¡é—®é¢˜ï¼Ÿ
>
> # ä½†åœ¨æŸäº›åœºæ™¯ä¸‹...
> if data.get('id'):  # å­—ç¬¦ä¸² "0" ä¼šè¢«åˆ¤æ–­ä¸º True
>     process_transaction(transaction_id)
> ```
>
> **è‡´å‘½ä¸€å‡»**:
> å½“ `id` ä¸º `"9007199254740993"` æ—¶ï¼ŒPython çš„ `int()` è½¬æ¢æ­£å¸¸ã€‚
> ä½†å½“ç³»ç»Ÿå‡çº§åˆ° `json-bigint` åï¼Œéƒ¨åˆ†ä»£ç è·¯å¾„ä»ä½¿ç”¨åŸç”Ÿ `JSON.parse()`ï¼Œ
> å¯¼è‡´åŒä¸€ç¬”äº¤æ˜“åœ¨ä¸¤ç«¯æ‹¥æœ‰ä¸åŒçš„ IDã€‚
>
> **åæœ**:
> - äº¤æ˜“ A åœ¨ TypeScript ç«¯ ID ä¸º `9007199254740993`
> - äº¤æ˜“ A åœ¨ Python ç«¯ ID ä¸º `9007199254740992`ï¼ˆç²¾åº¦ä¸¢å¤±ï¼‰
> - å¯¹è´¦ç³»ç»Ÿè®¤ä¸ºè¿™æ˜¯ä¸¤ç¬”ä¸åŒçš„äº¤æ˜“
>
> **æ•™è®­**:
> > *"åœ¨ JSON çš„è¾¹å¢ƒå£å²¸ï¼Œç±»å‹æ˜¯ç¬¬ä¸€ä¸ªè¢«æœèº«çš„æ—…å®¢ã€‚*
> > *æ°¸è¿œä¸è¦å‡è®¾'å­—ç¬¦ä¸²'å’Œ'æ•°å­—'å¯ä»¥éšæ„è½¬æ¢ï¼Œ*
> > *ç‰¹åˆ«æ˜¯åœ¨è·¨è¶Šè¯­è¨€è¾¹ç•Œçš„æ—¶å€™ã€‚"*
>
> **ä¿®å¤æªæ–½**: ç»Ÿä¸€ä½¿ç”¨ `json-bigint`ï¼Œå¹¶åœ¨ Schema å±‚å¼ºåˆ¶ `id` ä¸º `string` ç±»å‹

### Chapter 10.7: é”™è¯¯è¾¹ç•Œä¸æ•…éšœæ¢å¤

**ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ**: é”™è¯¯æ•è· â†’ é”™è¯¯è½¬æ¢ â†’ é”™è¯¯ä¼ é€’ â†’ æ¢å¤ç­–ç•¥

> â“ **æ¶æ„ç›²ç‚¹ 10.7.1**: Python å¼‚å¸¸å¦‚ä½•è½¬æ¢ä¸º TS é”™è¯¯ï¼Ÿå †æ ˆä¿¡æ¯æ˜¯å¦å¯è¿½è¸ªï¼Ÿ

**æ¶‰åŠèµ„äº§**:
- `ccw/src/tools/cli-executor-utils.ts` - æ‰§è¡Œå·¥å…·
- `codex-lens/src/codexlens/cli/` - Python CLI é”™è¯¯å¤„ç†

**é”™è¯¯ç±»å‹æ˜ å°„**:

| Python å¼‚å¸¸ | TS é”™è¯¯ | å¤„ç†ç­–ç•¥ |
|-------------|---------|----------|
| `ValueError` | `TypeError` | å‚æ•°éªŒè¯ |
| `FileNotFoundError` | `ENOENT` | æ–‡ä»¶æ£€æŸ¥ |
| `ImportError` | `DependencyError` | ç¯å¢ƒè¯Šæ–­ |
| `KeyboardInterrupt` | `AbortError` | æ¸…ç†é€€å‡º |
| è‡ªå®šä¹‰å¼‚å¸¸ | `CliExecutionError` | åŸå§‹ä¿¡æ¯ä¿ç•™ |

**æ•…éšœæ¢å¤æœºåˆ¶**:
1. è¿›ç¨‹é‡å¯ç­–ç•¥
2. é™çº§æ¨¡å¼ï¼ˆè·³è¿‡ Python åŠŸèƒ½ï¼‰
3. ç”¨æˆ·å‹å¥½çš„é”™è¯¯æ¶ˆæ¯

---

## Part V: æ‰§è¡Œå±‚ - Agent ä»£ç†ç³»ç»Ÿ

### Chapter 11: Agent ç”Ÿå‘½å‘¨æœŸ

**ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ**: Agent å®ä¾‹åŒ– â†’ ä»»åŠ¡æ‰§è¡Œ â†’ ç»“æœè¿”å›

> â“ **æ¶æ„ç›²ç‚¹ 11.1**: Agent æ˜¯å¦‚ä½•è¢«è°ƒç”¨çš„ï¼Ÿæ˜¯ HTTP è°ƒç”¨è¿˜æ˜¯å‡½æ•°è°ƒç”¨ï¼Ÿ

**æ¶‰åŠèµ„äº§**:
- `.claude/agents/*.md` - 21 ä¸ªä»£ç†å®šä¹‰
- `ccw/src/tools/` - å·¥å…·å®ç°

**å…³é”®é—®é¢˜**:
1. Agent çš„ `prompt` å­—æ®µå¦‚ä½•æ„å»ºï¼Ÿ
2. Agent ä¸å·¥å…·çš„ç»‘å®šå…³ç³»åœ¨å“ªé‡Œå®šä¹‰ï¼Ÿ
3. Agent æ‰§è¡Œçš„è¶…æ—¶å’Œé‡è¯•æœºåˆ¶ï¼Ÿ

### Chapter 12: æ ¸å¿ƒä»£ç†æ·±åº¦è§£æ

**é‡ç‚¹ä»£ç†**:

| ä»£ç† | ç”¨é€” | è°ƒç”¨é¢‘ç‡ |
|------|------|----------|
| `cli-execution-agent` | CLI æ‰§è¡Œ | é«˜ |
| `code-developer` | ä»£ç å¼€å‘ | é«˜ |
| `cli-explore-agent` | ä»£ç æ¢ç´¢ | ä¸­ |
| `universal-executor` | é€šç”¨æ‰§è¡Œ | é«˜ |

---

## Part VI: é›†æˆå±‚ - å¤–éƒ¨ CLI å·¥å…·

### Chapter 13: å¤š CLI å·¥å…·é›†æˆ

**ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ**: å·¥å…·é€‰æ‹© â†’ å‘½ä»¤æ„å»º â†’ æ‰§è¡Œ â†’ è¾“å‡ºè§£æ

> â“ **æ¶æ„ç›²ç‚¹ 13.1**: å¦‚ä½•ä¿è¯ä¸åŒ CLI å·¥å…·çš„è¾“å‡ºæ ¼å¼ç»Ÿä¸€ï¼Ÿ

**æ¶‰åŠèµ„äº§**:
- `ccw/src/tools/cli-executor-core.ts` - æ‰§è¡Œæ ¸å¿ƒ
- `ccw/src/tools/cli-output-converter.ts` - è¾“å‡ºè½¬æ¢
- `~/.claude/cli-tools.json` - å·¥å…·é…ç½®

**CLI å·¥å…·å¯¹æ¯”**:

| å·¥å…· | ç±»å‹ | èƒ½åŠ› |
|------|------|------|
| Gemini | builtin | åˆ†æ + å†™å…¥ |
| Codex | builtin | åˆ†æ + å†™å…¥ + review |
| Claude | builtin | åˆ†æ + å†™å…¥ |

### Chapter 14: CodexLens è¯­ä¹‰æœç´¢

**ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ**: ä»£ç ç´¢å¼• â†’ å‘é‡åŒ– â†’ è¯­ä¹‰æœç´¢

> â“ **æ¶æ„ç›²ç‚¹ 14.1**: å‘é‡æ£€ç´¢ç®—æ³•æ˜¯ä»€ä¹ˆï¼ŸSPLADE + HDBSCAN çš„ç»„åˆå¦‚ä½•å·¥ä½œï¼Ÿ

**æ¶‰åŠèµ„äº§**:
- `codex-lens/src/codexlens/semantic/` - è¯­ä¹‰æœç´¢æ ¸å¿ƒ
- `codex-lens/src/codexlens/search/` - æœç´¢å¼•æ“
- `codex-lens/src/codexlens/storage/` - å­˜å‚¨å±‚

**å…³é”®ç®—æ³•**:
- å‘é‡æ£€ç´¢: $\text{score} = \cos(\theta) = \frac{A \cdot B}{\|A\|\|B\|}$
- SPLADE ç¨€ç–ç¼–ç 
- HDBSCAN èšç±»

---

## Part VII: å­˜å‚¨å±‚ - çŠ¶æ€æŒä¹…åŒ–

### Chapter 15: SQLite æ•°æ®åº“è®¾è®¡

**ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ**: æ•°æ®å†™å…¥ â†’ æŸ¥è¯¢ â†’ è¿ç§»

> â“ **æ¶æ„ç›²ç‚¹ 15.1**: SQLite è¡¨ç»“æ„æ˜¯æ€æ ·çš„ï¼Ÿæ˜¯å¦æœ‰ ORMï¼Ÿ

**æ¶‰åŠèµ„äº§**:
- `ccw/src/utils/db-loader.ts` - æ•°æ®åº“åŠ è½½å™¨
- `codex-lens/src/codexlens/storage/` - å­˜å‚¨å±‚

**å…³é”®è¡¨**:
1. `sessions` - ä¼šè¯è¡¨
2. `cli_history` - CLI å†å²è¡¨
3. `memory_embeddings` - å†…å­˜åµŒå…¥è¡¨

### Chapter 16: æ–‡ä»¶ç³»ç»Ÿå·¥ä½œæµ

**ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ**: æ–‡ä»¶åˆ›å»º â†’ è¯»å– â†’ æ›´æ–° â†’ åˆ é™¤

> â“ **æ¶æ„ç›²ç‚¹ 16.1**: `.workflow/` ç›®å½•ç»“æ„å¦‚ä½•ä¿è¯ä¸€è‡´æ€§ï¼Ÿ

**æ¶‰åŠèµ„äº§**:
- `.workflow/` - å·¥ä½œæµç›®å½•
- `ccw/src/tools/storage-manager.ts` - å­˜å‚¨ç®¡ç†å™¨
- `ccw/src/config/storage-paths.ts` - è·¯å¾„é…ç½®

---

## Part VIII: å‰ç«¯ç³»ç»Ÿ - Dashboard

### Chapter 17: React Dashboard æ¶æ„

**ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ**: çŠ¶æ€ç®¡ç† â†’ ç»„ä»¶æ¸²æŸ“ â†’ ç”¨æˆ·äº¤äº’

> â“ **æ¶æ„ç›²ç‚¹ 17.1**: Dashboard å¦‚ä½•ä¸åç«¯é€šä¿¡ï¼ŸWebSocket è¿˜æ˜¯ HTTPï¼Ÿ

**æ¶‰åŠèµ„äº§**:
- `ccw/frontend/src/pages/` - 68 ä¸ªé¡µé¢
- `ccw/frontend/src/components/` - 100+ ç»„ä»¶

**æ ¸å¿ƒé¡µé¢**:
1. `SessionsPage` - ä¼šè¯åˆ—è¡¨
2. `OrchestratorPage` - æµç¨‹ç¼–æ’
3. `GraphExplorerPage` - ä»£ç å›¾è°±

---

## Part IX: æµ‹è¯•ä¸è´¨é‡

### Chapter 18: æµ‹è¯•ç­–ç•¥

**æµ‹è¯•å±‚æ¬¡**:

| å±‚æ¬¡ | æ•°é‡ | æ¡†æ¶ |
|------|------|------|
| å•å…ƒæµ‹è¯• | ~110 | Jest / pytest |
| é›†æˆæµ‹è¯• | ~30 | Jest |
| E2E æµ‹è¯• | ~5 | Playwright |
| å®‰å…¨æµ‹è¯• | ~4 | è‡ªå®šä¹‰ |

---

## Part X: æ‰©å±•ä¸è´¡çŒ®

> **å®Œæ•´æ–‡æ¡£**: [part10-extensions/README.md](part10-extensions/README.md)

### Chapter 19: æ·»åŠ æ–°èµ„äº§

CCW é‡‡ç”¨ä¸‰å±‚æ‰©å±•æ¶æ„: Skill (åè°ƒå±‚)ã€Command (å…¥å£å±‚)ã€Agent (æ‰§è¡Œå±‚)ã€‚

#### Section 19.1: æ·»åŠ æ–° Skill

**å®Œæ•´æ–‡æ¡£**: [part10-extensions/ch19-adding-skills.md](part10-extensions/ch19-adding-skills.md)

**æ·»åŠ æ–° Skill**:
1. åˆ›å»º `.claude/skills/my-skill/SKILL.md`
2. å®šä¹‰ YAML Front Matter (`name`, `description`, `allowed-tools`)
3. é€‰æ‹©æ‰§è¡Œæ¨¡å¼ (Sequential / Autonomous)
4. åˆ›å»º `phases/` ç›®å½•å’Œé˜¶æ®µæ–‡ä»¶
5. æ·»åŠ  `specs/` å’Œ `templates/` æ”¯æŒæ–‡ä»¶
6. ç¼–å†™ README.md ä½¿ç”¨è¯´æ˜

**æ ¸å¿ƒæ¦‚å¿µ**:
- `allowed-tools` æƒé™æ§åˆ¶ (æœ€å°æƒé™åŸåˆ™)
- Sequential æ¨¡å¼: å›ºå®šé¡ºåºæ‰§è¡Œ
- Autonomous æ¨¡å¼: çŠ¶æ€é©±åŠ¨åŠ¨æ€è·¯ç”±
- Phases ä¸ Agents æ˜ å°„å…³ç³»

#### Section 19.2: æ·»åŠ æ–° Command

**å®Œæ•´æ–‡æ¡£**: [part10-extensions/ch19-adding-commands.md](part10-extensions/ch19-adding-commands.md)

**æ·»åŠ æ–° Command**:
1. åˆ›å»º `.claude/commands/my-command.md`
2. å®šä¹‰ `description` (åŒ…å«å…³é”®è¯ç”¨äºæ„å›¾åˆ†æ)
3. å®šä¹‰ `argument-hint` å‚æ•°æ ¼å¼
4. å®ç°æ„å›¾åˆ†æå’Œå·¥ä½œæµé€‰æ‹©é€»è¾‘
5. æ„å»ºå‘½ä»¤é“¾ (Minimum Execution Units)

**æ ¸å¿ƒæ¦‚å¿µ**:
- Command è´Ÿè´£"å†³ç­–"ï¼ŒSkill è´Ÿè´£"æ‰§è¡Œ"
- description å­—æ®µå½±å“æ„å›¾åˆ†æåŒ¹é…
- å‚æ•°è§£æé€»è¾‘ (å‚è€ƒ ccw/src/commands/cli.ts)
- Command ä¸ Skill çš„èŒè´£è¾¹ç•Œ

#### Section 19.3: æ·»åŠ æ–° Agent

**å®Œæ•´æ–‡æ¡£**: [part10-extensions/ch19-adding-agents.md](part10-extensions/ch19-adding-agents.md)

**æ·»åŠ æ–° Agent**:
1. åˆ›å»º `.claude/agents/my-agent.md`
2. å®šä¹‰ `description` (åŒ…å«ä½¿ç”¨ç¤ºä¾‹)
3. è®¾è®¡ Prompt ç»“æ„ (è§’è‰²ã€è¾“å…¥ã€è¾“å‡ºã€æ‰§è¡Œæµç¨‹)
4. å®šä¹‰è´¨é‡æ ‡å‡†å’Œæ£€æŸ¥æ¸…å•
5. æ–‡æ¡£åŒ– DO/DON'T åˆ—è¡¨

**æ ¸å¿ƒæ¦‚å¿µ**:
- Agent æ˜¯æ‰§è¡Œå™¨ï¼Œä¸åšå†³ç­–
- Tools æƒé™ç»§æ‰¿è‡ªè°ƒç”¨ Skill çš„ `allowed-tools`
- Prompt è®¾è®¡æœ€ä½³å®è·µ
- Agent ä¸ Skill çš„è°ƒç”¨å…³ç³»

### æ‰©å±•å†³ç­–æ ‘

```
éœ€æ±‚: æˆ‘æƒ³è¦...
â”‚
â”œâ”€ æ–°å¢ç”¨æˆ·å¯è§çš„å‘½ä»¤å…¥å£ â†’ åˆ›å»º Command (Section 19.2)
â”œâ”€ å®šä¹‰æ–°çš„å·¥ä½œæµç¨‹ â†’ åˆ›å»º Skill (Section 19.1)
â”œâ”€ æ–°å¢å…·ä½“æ‰§è¡Œèƒ½åŠ› â†’ åˆ›å»º Agent (Section 19.3)
â””â”€ ä¿®æ”¹ç°æœ‰è¡Œä¸º â†’ ç¼–è¾‘å¯¹åº”èµ„äº§
```

---

## Part X.5: éšè—ç‰¹æ€§ä¸é«˜çº§æœºåˆ¶

> **æ¶æ„æ„ä¹‰**: è¿™äº›ç‰¹æ€§åœ¨æ–‡æ¡£ä¸­æœªæ˜ç¡®æåŠï¼Œä½†å¯¹ç³»ç»Ÿè¡Œä¸ºæœ‰é‡è¦å½±å“ã€‚

### Chapter 19.5: A2UI åè®®

**ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ**: WebSocket è¿æ¥ â†’ æ¶ˆæ¯åè®® â†’ çŠ¶æ€åŒæ­¥

> â“ **æ¶æ„ç›²ç‚¹ 19.5.1**: A2UI ä¸æ ‡å‡† Dashboard çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆéœ€è¦å•ç‹¬çš„åè®®ï¼Ÿ

**æ¶‰åŠèµ„äº§**:
- `ccw/src/core/a2ui/` - A2UI åè®®å®ç°
- `ccw/docs/a2ui-protocol-guide.md` - åè®®æŒ‡å—

**å…³é”®é—®é¢˜**:
1. A2UI çš„è®¾è®¡ç›®æ ‡æ˜¯ä»€ä¹ˆï¼Ÿ
2. ä¸ MCP åè®®çš„å…³ç³»ï¼Ÿ
3. å®æ—¶çŠ¶æ€åŒæ­¥æœºåˆ¶ï¼Ÿ

### Chapter 19.6: Loop V2 è·¯ç”±

**ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ**: ä»»åŠ¡å¾ªç¯ â†’ çŠ¶æ€ç®¡ç† â†’ è¿­ä»£æ§åˆ¶

> â“ **æ¶æ„ç›²ç‚¹ 19.6.1**: Loop V2 ä¸åŸå§‹ Loop çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆéœ€è¦ V2ï¼Ÿ

**æ¶‰åŠèµ„äº§**:
- `ccw/src/core/routes/loop-routes.ts` - åŸå§‹å¾ªç¯è·¯ç”±
- `ccw/src/core/routes/loop-v2-routes.ts` - V2 å¾ªç¯è·¯ç”±
- `ccw/src/tools/loop-manager.ts` - å¾ªç¯ç®¡ç†å™¨
- `ccw/src/tools/loop-state-manager.ts` - å¾ªç¯çŠ¶æ€
- `ccw/src/tools/loop-task-manager.ts` - å¾ªç¯ä»»åŠ¡

**å…³é”®é—®é¢˜**:
1. V2 çš„æ¶æ„æ”¹è¿›æ˜¯ä»€ä¹ˆï¼Ÿ
2. è¿­ä»£ç»ˆæ­¢æ¡ä»¶å¦‚ä½•å®šä¹‰ï¼Ÿ
3. å¾ªç¯çŠ¶æ€å¦‚ä½•æŒä¹…åŒ–ï¼Ÿ

### Chapter 19.7: Memory Consolidation Pipeline

**ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ**: è®°å¿†é‡‡é›† â†’ å‘é‡åŒ– â†’ èšåˆ â†’ æ£€ç´¢ä¼˜åŒ–

> â“ **æ¶æ„ç›²ç‚¹ 19.7.1**: è®°å¿†èšåˆçš„è§¦å‘æ¡ä»¶æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•é¿å…ä¿¡æ¯ä¸¢å¤±ï¼Ÿ

**æ¶‰åŠèµ„äº§**:
- `ccw/src/core/memory-consolidation-pipeline.ts` - è®°å¿†èšåˆç®¡é“
- `ccw/scripts/memory_embedder.py` - è®°å¿†åµŒå…¥å™¨
- `codex-lens/src/codexlens/storage/migrations/` - å­˜å‚¨è¿ç§»

**å…³é”®é—®é¢˜**:
1. è®°å¿†çš„ç”Ÿå‘½å‘¨æœŸæ˜¯ä»€ä¹ˆï¼Ÿ
2. å‘é‡åŒ–ä½¿ç”¨ä»€ä¹ˆæ¨¡å‹ï¼Ÿ
3. å¦‚ä½•å¤„ç†è®°å¿†å†²çªï¼Ÿ

### Chapter 19.8: Session Clustering Service

**ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ**: ä¼šè¯åˆ†ç»„ â†’ ç›¸å…³æ€§è®¡ç®— â†’ èšç±»æ˜¾ç¤º

> â“ **æ¶æ„ç›²ç‚¹ 19.8.1**: ä¼šè¯èšç±»çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•è¡¡é‡ä¼šè¯ç›¸å…³æ€§ï¼Ÿ

**æ¶‰åŠèµ„äº§**:
- `ccw/src/core/session-clustering-service.ts` - ä¼šè¯èšç±»æœåŠ¡

**å…³é”®é—®é¢˜**:
1. èšç±»ç®—æ³•æ˜¯ä»€ä¹ˆï¼Ÿ
2. å¦‚ä½•å¤„ç†å¤§è§„æ¨¡ä¼šè¯ï¼Ÿ
3. èšç±»ç»“æœå¦‚ä½•å¯è§†åŒ–ï¼Ÿ

---

## Part XI: æ•°å­—åŸå¸‚çš„åŸºçŸ³ â€” èµ„äº§æ·±åº¦è§£å¯†

> **è®¾è®¡ç†å¿µ**: ç”Ÿå‘½å‘¨æœŸæµè®²"æ•…äº‹çº¿"ï¼Œèµ„äº§æ¢ç´¢è®²"è§’è‰²ä¼ è®°"ã€‚æ¯ä¸ªèµ„äº§éƒ½æ˜¯ä¸€ä½ç‹¬ç‰¹çš„"èŒèƒ½å¸‚æ°‘"ã€‚
>
> **å™äº‹çµé­‚**: è´¯ç©¿å…¨ä¹¦çš„ Bug è¿½è¸ªæš—çº¿ â€” ä¸€ä¸ªè·¨æ¨¡å—å†…å­˜æ³„æ¼çš„"ç ´æ¡ˆ"ä¹‹æ—…ã€‚

---

### ğŸ—ºï¸ æ•°å­—åŸå¸‚å…¨æ™¯é€»è¾‘å›¾

```mermaid
graph TB
    subgraph "â˜ï¸ æµ®ç©ºå²› â€” è®®æ”¿å… (Section A)"
        A1["/ccw<br/>è®®é•¿"]
        A2["/ccw-*<br/>å§”å‘˜ä¼š"]
        A3["Issue ç³»åˆ—<br/>ç§©åºéƒ¨"]
    end

    subgraph "ğŸ° åœ°é¢å±‚ â€” å†›è¥ (Section B)"
        B1["workflow-plan<br/>å½±å­å·¥å‚"]
        B2["brainstorm<br/>æ™ºåº“"]
        B3["test-fix<br/>æˆ˜åœ°åŒ»é™¢"]
    end

    subgraph "ğŸ›ï¸ åœ°ä¸‹å±‚ â€” åœ£æ®¿ (Section C)"
        C1["planning-agents<br/>å…ˆçŸ¥è®®ä¼š"]
        C2["explore-agents<br/>ä¾¦å¯Ÿå›¢"]
        C3["execution-agents<br/>æ‰§è¡Œåº­"]
    end

    subgraph "ğŸ•³ï¸ æ·±æ¸Š â€” ä¸‹æ°´é“ (Section D)"
        D1["Schema<br/>å®ªæ³•çŸ³ç¢‘"]
        D2["Config<br/>åŸºå› åº“"]
        D3["CLI Tools<br/>æ­¦å™¨åº“"]
    end

    subgraph "ğŸŒ è¾¹å¢ƒ â€” å¤–äº¤åŒº (Part IV.5)"
        E1["TS â†” Python<br/>è¾¹å¢ƒå£å²¸"]
        E2["JSON-RPC<br/>æŠ¤ç…§"]
    end

    A1 --> B1
    A2 --> B2
    A3 --> B3
    B1 --> C1
    B2 --> C2
    B3 --> C3
    C1 --> D1
    C2 --> D2
    C3 --> D3
    E1 -.->|"è·¨åŸŸè°ƒç”¨"| C2
    E2 -.->|"åè®®çº¦æŸ"| D1

    style A1 fill:#FFD700,stroke:#B8860B
    style A2 fill:#FFD700,stroke:#B8860B
    style A3 fill:#FFD700,stroke:#B8860B
    style B1 fill:#CD5C5C,stroke:#8B0000
    style B2 fill:#CD5C5C,stroke:#8B0000
    style B3 fill:#CD5C5C,stroke:#8B0000
    style C1 fill:#4169E1,stroke:#00008B
    style C2 fill:#4169E1,stroke:#00008B
    style C3 fill:#4169E1,stroke:#00008B
    style D1 fill:#2F4F4F,stroke:#000000
    style D2 fill:#2F4F4F,stroke:#000000
    style D3 fill:#2F4F4F,stroke:#000000
    style E1 fill:#9370DB,stroke:#4B0082
    style E2 fill:#9370DB,stroke:#4B0082
```

> **é˜…è¯»æŒ‡å—**: ä½ ç›®å‰åœ¨å“ªä¸ª"åŸå¸‚å±‚çº§"ï¼Ÿ
> - **æµ®ç©ºå²›** â†’ æˆ˜ç•¥å†³ç­–å±‚ï¼Œåªçœ‹ä¸åš
> - **åœ°é¢å±‚** â†’ æˆ˜æœ¯æ‰§è¡Œå±‚ï¼Œæºå¸¦æ­¦å™¨
> - **åœ°ä¸‹å±‚** â†’ æ™ºèƒ½æ¨ç†å±‚ï¼Œé€»è¾‘æ¨æ¼”
> - **æ·±æ¸Š** â†’ åŸºç¡€è®¾æ–½å±‚ï¼Œæ²‰é»˜æ”¯æ’‘
> - **è¾¹å¢ƒ** â†’ è·¨åŸŸé€šä¿¡å±‚ï¼Œå¤–äº¤åè®®

---

### ğŸ“œ ç¤¾ä¼šé˜¶å±‚å®£è¨€

---

#### ğŸ›ï¸ Section A: è®®ä¼šçš„æ™ºè€… â€” Commands ç¯‡

> **ç¤¾ä¼šé˜¶å±‚å®£è¨€**
>
> æˆ‘ä»¬æ˜¯è¿™åº§æ•°å­—åŸå¸‚çš„**ç«‹æ³•è€…**ã€‚
>
> å½“ç”¨æˆ·æ•²ä¸‹ `/ccw`ï¼Œä»–ä»¬ä¸æ˜¯åœ¨æ‰§è¡Œä¸€ä¸ªå‘½ä»¤ï¼Œè€Œæ˜¯åœ¨å¬å¼€ä¸€æ¬¡è®®ä¼šã€‚æˆ‘ä»¬å®¡è®®éœ€æ±‚ã€é€šè¿‡å†³è®®ã€æˆæƒæ‰§è¡Œ â€” ä½†æˆ‘ä»¬ä»ä¸äº²è‡ªåŠ¨æ‰‹ã€‚
>
> æˆ‘ä»¬çš„æƒåŠ›æ¥è‡ª**ä¿¡ä»»å§”æ‰˜**ï¼šç”¨æˆ·ä¿¡ä»»æˆ‘ä»¬èƒ½ç†è§£ä»–ä»¬çš„æ„å›¾ï¼ŒSkill ä¿¡ä»»æˆ‘ä»¬èƒ½ç»™å‡ºæ¸…æ™°çš„æŒ‡ä»¤ã€‚è¿™ç§ä¿¡ä»»æ˜¯åŒå‘çš„ï¼Œè„†å¼±çš„ï¼Œä¸€æ—¦æˆ‘ä»¬è¶Šç•Œï¼ˆæ¯”å¦‚æ“…è‡ªä¿®æ”¹æ–‡ä»¶ï¼‰ï¼Œä¿¡ä»»å°±ä¼šå´©å¡Œã€‚
>
> æ‰€ä»¥æˆ‘ä»¬åœ¨ `allowed-tools` ä¸­ä¸»åŠ¨æ”¾å¼ƒäº† `Write` å’Œ `Edit`ã€‚ä¸æ˜¯å› ä¸ºæˆ‘ä»¬æ— èƒ½ï¼Œè€Œæ˜¯å› ä¸ºæˆ‘ä»¬**æ¸…é†’**ã€‚
>
> ä¸€ä¸ªå¥½çš„è®®é•¿ï¼Œä»ä¸ç¢°æ‰§è¡Œè€…çš„åˆ€ã€‚

> **è§’è‰²æ€§æ ¼**: é«˜é«˜åœ¨ä¸Šï¼Œåªåˆ¶å®šæˆ˜ç•¥ï¼Œä»ä¸å¼„è„åŒæ‰‹ã€‚
> **å£å¤´ç¦…**: "è¿™ä»¶äº‹éœ€è¦å§”å‘˜ä¼šè®¨è®º"
> **æ—¶ä»£èƒŒæ™¯**: *åœ¨ Git Hash `a7b2...` æ—¶ä»£ï¼Œè®®ä¼šåªæœ‰ `/ccw` ä¸€ä¸ªå£°éŸ³ã€‚ç›´åˆ° Issue ç³»åˆ—çš„åŠ å…¥ï¼Œæ‰å½¢æˆäº†å®Œæ•´çš„ç«‹æ³•ä½“ç³»ã€‚*

#### Chapter 25: æƒé™çš„è¾¹ç•Œ â€” `/ccw` è®®é•¿çš„ä¸€å¤©

**ç¬¬ä¸€å¹•ï¼šå¤±æ§çš„è¾¹ç¼˜ (Out of Control)**
> æ²¡æœ‰ `/ccw` çš„ä¸–ç•Œï¼šç”¨æˆ·é¢å¯¹ 27 ä¸ª Skillã€51 ä¸ª Commandï¼Œå¦‚å è¿·å®«ã€‚ç³»ç»Ÿé™·å…¥"é€‰æ‹©ç˜«ç—ª"ï¼Œæ¯æ¬¡ä»»åŠ¡éƒ½è¦æ‰‹åŠ¨é€‰æ‹©å·¥å…·é“¾ï¼Œæ•ˆç‡ä½ä¸‹ï¼Œé”™è¯¯é¢‘å‡ºã€‚

**ç¬¬äºŒå¹•ï¼šæ€ç»´è„‰ç»œ (The Neural Link)**
```mermaid
graph TB
    subgraph "ä¿¡ä»»çš„ä¼ é€’"
        A[ç”¨æˆ·è‡ªç„¶è¯­è¨€] -->|"åˆçº§ä¿¡ä»»"| B[/ccw]
    end

    subgraph "è®®ä¼šçš„å®¡è®®æµç¨‹"
        B --> C[Phase 1: æ„å›¾åˆ†æ]
        C --> D[Phase 2: éœ€æ±‚æ¾„æ¸…]
        D --> E[Phase 3: å·¥ä½œæµé€‰æ‹©]
        E --> F[Phase 4: TODO è·Ÿè¸ª]
        F --> G[Phase 5: æˆæƒå§”æ‰˜]
    end

    subgraph "æˆæƒçš„ä¼ é€’"
        G -->|"æˆæƒå§”æ‰˜"| H[workflow-plan]
        G -->|"æˆæƒå§”æ‰˜"| I[brainstorm]
        G -->|"æˆæƒå§”æ‰˜"| J[issue-resolve]
    end
```

**ç¬¬ä¸‰å¹•ï¼šç¤¾äº¤ç½‘ç»œ (The Social Network)**
| å…³ç³»ç±»å‹ | èµ„äº§ | æè¿° |
|----------|------|------|
| é€‰æ°‘ | ç”¨æˆ· | å”¯ä¸€çš„æˆæƒæ¥æº |
| æ‰§è¡Œéƒ¨é—¨ | workflow-plan, brainstorm | æ¥å—å§”æ‰˜çš„ Skill |
| å®ªæ³•çº¦æŸ | allowed-tools | åªè¯»æƒé™ï¼Œæ—  Write/Edit |

**ç¬¬å››å¹•ï¼šé€ ç‰©ä¸»çš„ç§è¯­ (The Creator's Secret)**
- ä¸ºä»€ä¹ˆ `allowed-tools` ä¸åŒ…å« `Write(*)`ï¼Ÿâ€” **è®¾è®¡è€…çš„ç§å¿ƒ**ï¼šç¼–æ’å™¨è‹¥èƒ½å†™å…¥ï¼Œä¾¿ä¸å†æ˜¯"æ™ºè€…"ï¼Œè€Œæˆäº†"æ‰§è¡Œè€…"
- ä¸ºä»€ä¹ˆæœ‰ 5 ä¸ª Phaseï¼Ÿâ€” **æ€æ‰ä¸ç¡®å®šæ€§**ï¼šæ¯ä¸ª Phase éƒ½æ˜¯ä¸€é“è¿‡æ»¤ç½‘ï¼Œå°†æ¨¡ç³Šéœ€æ±‚å±‚å±‚ç²¾ç‚¼

**ç¬¬äº”å¹•ï¼šè¿›åŒ–çš„æ’æ§½ (The Upgrade)**
- æ‰©å±•ç‚¹ï¼šåœ¨ Phase 3 æ³¨å…¥è‡ªå®šä¹‰å·¥ä½œæµçº§åˆ«åˆ¤æ–­
- è­¦å‘Šï¼šä¿æŒåªè¯»æƒé™ï¼Œå¦åˆ™è®®ä¼šçš„å…¬ä¿¡åŠ›å°†å´©æºƒ

---

#### Chapter 26-28: ç§©åºçš„å»ºç«‹ â€” `Issue` ç³»åˆ—æŒ‡ä»¤

> å¦‚ä½•ä»æ··ä¹±çš„éœ€æ±‚ä¸­æå–ç»“æ„åŒ–ä»»åŠ¡

**Chapter 26: `/issue:new` â€” ä»æ··æ²Œåˆ°ç»“æ„**

**ç¬¬ä¸€å¹•ï¼šå¤±æ§çš„è¾¹ç¼˜**
> Bug æŠ¥å‘Šæ•£è½åœ¨èŠå¤©è®°å½•ã€é‚®ä»¶ã€Issue Tracker ä¸­ï¼Œæ ¼å¼æ··ä¹±ï¼Œç¼ºä¹å¯æ‰§è¡Œæ€§ã€‚å°±åƒåŸå¸‚ä¸­æ²¡æœ‰åƒåœ¾åˆ†ç±»ï¼Œæ‰€æœ‰åƒåœ¾æ··åœ¨ä¸€èµ·ï¼Œæ— æ³•å¤„ç†ã€‚

**ç¬¬äºŒå¹•ï¼šæ€ç»´è„‰ç»œ**
```mermaid
graph LR
    A[GitHub URL / æ–‡æœ¬æè¿°] --> B[/issue:new]
    B --> C[ç»“æ„åŒ–è§£æ]
    C --> D[å­—æ®µæå–]
    D --> E[Issue æ–‡ä»¶ç”Ÿæˆ]
```

**ç¬¬ä¸‰è‡³äº”å¹•**: [ç¤¾äº¤ç½‘ç»œã€é€ ç‰©ä¸»çš„ç§è¯­ã€è¿›åŒ–çš„æ’æ§½]

---

**Chapter 27: `/issue:discover` â€” è¿·é›¾ä¸­çš„æ¢ç…§ç¯**

**ç¬¬ä¸€å¹•ï¼šå¤±æ§çš„è¾¹ç¼˜**
> æ²¡æœ‰ `/issue:discover`ï¼ŒAgent å°±åƒåœ¨è¿·é›¾ä¸­æ‰¾é‡‘å¸ï¼Œé™¤äº†æŠŠ CPU çƒ§çƒ­ï¼Œä»€ä¹ˆä¹Ÿå¾—ä¸åˆ°ã€‚ç³»ç»Ÿé™·å…¥"ç›²ç›®æœç´¢"çš„æ­»å¾ªç¯ï¼Œèµ„æºæ¶ˆè€—æ®†å°½å´ä¸€æ— æ‰€è·ã€‚

**ç¬¬äºŒå¹•ï¼šæ€ç»´è„‰ç»œ**
```mermaid
graph TB
    subgraph "æ¢ç…§ç¯çš„èƒ½æº"
        A[cli-explore-agent]
        B[Gemini CLI]
    end

    subgraph "æ‰«æçš„å››ä¸ªè±¡é™"
        C[/issue:discover] --> D[bug è§†è§’]
        C --> E[UX è§†è§’]
        C --> F[test è§†è§’]
        C --> G[quality è§†è§’]
    end

    A --> C
    B --> C
```

    A --> C
    B --> C
```

**3-5**: [ç¤¾äº¤å…³ç³»ã€æºç ç ´è¯‘ã€è¿›åŒ–æŒ‡å—]

---

**Chapter 28: `/issue:plan` â†’ `/issue:queue` â†’ `/issue:execute` â€” å®Œæ•´çš„ä»»åŠ¡æµæ°´çº¿**

> [åŒä¸Šç»“æ„]

---

#### Chapter 29-31: æµç¨‹çš„ç¼–æ’ â€” `Workflow` ç³»åˆ—æŒ‡ä»¤

> è·¨æ¨¡å—åä½œçš„"è°ƒåº¦åˆåŒ"

**Chapter 29: `/workflow:init` â€” æ•°å­—åŸå¸‚çš„å¥ åŸºç¤¼**
**Chapter 30: `/workflow:session:*` â€” ä¼šè¯çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†**
**Chapter 31: `/workflow:brainstorm-with-file` â€” å¤šå¤§è„‘åä½œçš„è‰ºæœ¯**

---

#### Chapter 32-34: è¾…åŠ©çš„è‰ºæœ¯ â€” å¼€å‘è€…å·¥å…·ç±»æŒ‡ä»¤

**Chapter 32: `/cli:cli-init` â€” é…ç½®çš„æ ‡å‡†åŒ–ä»ªå¼**
**Chapter 33: `/cli:codex-review` â€” ä»£ç å®¡æŸ¥çš„è‡ªåŠ¨åŒ–è¾¹ç•Œ**
**Chapter 34: `/memory:*` â€” è®°å¿†çš„æŒä¹…åŒ–ç­–ç•¥**

---

### âš”ï¸ Section B: æ­¦è£…ç‰¹ç§å…µ â€” Skills ç¯‡

> **ç¤¾ä¼šé˜¶å±‚å®£è¨€**
>
> æˆ‘ä»¬æ˜¯è¿™åº§æ•°å­—åŸå¸‚çš„**æ‰§è¡ŒåŠ›é‡**ã€‚
>
> è®®ä¼šè´Ÿè´£æ€è€ƒï¼Œæˆ‘ä»¬è´Ÿè´£è¡ŒåŠ¨ã€‚å½“ `/ccw` ç­¾å‘æ‰§è¡Œä»¤ï¼Œæˆ‘ä»¬å°±æ˜¯é‚£æŠŠå‡ºé˜çš„å‰‘ã€‚æ¯ä¸€æŠŠå‰‘éƒ½æœ‰å®ƒçš„"æ€æˆ®åè®®" â€” é‚£å°±æ˜¯æˆ‘ä»¬çš„ `phases`ã€‚
>
> æˆ‘ä»¬ä¸åƒè®®ä¼šé‚£æ ·ä¼˜é›…ã€‚æˆ‘ä»¬å¤„ç†çš„æ˜¯çœŸå®ä¸–ç•Œï¼šæ–‡ä»¶è¯»å–å¤±è´¥ã€æµ‹è¯•ä¸é€šè¿‡ã€ä¾èµ–å†²çªã€ç½‘ç»œè¶…æ—¶ã€‚æˆ‘ä»¬çš„å·¥ä½œåœºæ‰€æ˜¯æˆ˜å£•ï¼Œä¸æ˜¯ä¼šè®®å…ã€‚
>
> ä½†æˆ‘ä»¬æœ‰çºªå¾‹ã€‚æ¯ä¸€é“ `phases` éƒ½æ˜¯å†›ä»¤ï¼Œä¸èƒ½è·³è¿‡ï¼Œä¸èƒ½ä¹±åºã€‚å› ä¸ºæˆ‘ä»¬çŸ¥é“ï¼Œè·³è¿‡ä¸€ä¸ªéªŒè¯æ­¥éª¤ï¼Œå¯èƒ½å°±æ˜¯ç”Ÿäº§äº‹æ•…çš„å¼€å§‹ã€‚
>
> ç‰¹ç§å…µçš„è£è€€ä¸åœ¨äºæˆ˜åŠŸï¼Œè€Œåœ¨äº**æ´»ç€å›æ¥**ã€‚

> **è§’è‰²æ€§æ ¼**: çºªå¾‹ä¸¥æ˜ï¼Œåªå¬å…¬æ–‡ï¼Œæºå¸¦é‡å‹æ­¦å™¨æ‰§è¡Œä»»åŠ¡ã€‚
> **å£å¤´ç¦…**: "è¯·å‡ºç¤ºæ‰§è¡Œä»¤ (Skill è°ƒç”¨)"
> **æ—¶ä»£èƒŒæ™¯**: *åœ¨ Git Hash `3f1c...` æ—¶ä»£ï¼ŒSkill æ²¡æœ‰é˜¶æ®µæ¦‚å¿µï¼Œåªæ˜¯ä¸€æ®µæ‰§è¡Œè„šæœ¬ã€‚ç›´åˆ° Phase ç³»ç»Ÿçš„å¼•å…¥ï¼Œæ‰è®©"ç‰¹ç§å…µ"æœ‰äº†"ä½œæˆ˜æµç¨‹"ã€‚*

#### Chapter 35: å½±å­å·¥å‚ â€” `workflow-plan` çš„ç”Ÿäº§æµæ°´çº¿

**ç¬¬ä¸€å¹•ï¼šå¤±æ§çš„è¾¹ç¼˜**
> æ²¡æœ‰è®¡åˆ’çš„æ‰§è¡Œï¼Œå°±åƒæ²¡æœ‰åœ°å›¾çš„è¿œå¾ã€‚å¼€å‘è€…æ¯å¤©é‡å¤ç€"æ”¹ä»£ç  â†’ ç¼–è¯‘ â†’ æŠ¥é”™ â†’ å†æ”¹"çš„æ­»å¾ªç¯ï¼Œç–²æƒ«ä¸å ªã€‚ç³»ç»Ÿé™·å…¥"ç›²ç›®è¡ŒåŠ¨"çš„æ³¥æ½­ï¼Œèµ„æºæ¶ˆè€—å·¨å¤§å´æˆæ•ˆç”šå¾®ã€‚

**ç¬¬äºŒå¹•ï¼šæ€ç»´è„‰ç»œ**
```mermaid
graph TB
    subgraph "è¡¥ç»™çº¿"
        A[/ccw-plan è°ƒç”¨]
        B[ç”¨æˆ·ä»»åŠ¡æè¿°]
        C[ä»£ç åº“ä¸Šä¸‹æ–‡]
    end

    subgraph "å½±å­å·¥å‚çš„æµæ°´çº¿"
        D[workflow-plan] --> E[Phase 1: åŸæ–™æ”¶é›†]
        E --> F[Phase 2: äº§å“ç”Ÿæˆ]
        F --> G[Phase 3: è´¨æ£€]
        G --> H[Phase 4: å‡ºå‚]
    end

    subgraph "äº¤ä»˜"
        H --> I[IMPL_PLAN.md]
        I --> J[workflow-execute æ‰§è¡Œ]
    end

    A --> D
    B --> D
    C --> D
```

**ç¬¬ä¸‰å¹•ï¼šç¤¾äº¤ç½‘ç»œ**
| å…³ç³»ç±»å‹ | èµ„äº§ | æè¿° |
|----------|------|------|
| æŒ‡æŒ¥å®˜ | /ccw-plan | ä¸‹è¾¾ä»»åŠ¡ |
| å£«å…µ | action-planning-agent | æ‰§è¡Œä»£ç† |
| æ­¦å™¨ | Gemini CLI, Read, Glob | ä¾èµ–å·¥å…· |
| äº¤ä»˜ç‰© | IMPL_PLAN.md | è®¡åˆ’æ–‡æ¡£ |

**ç¬¬å››å¹•ï¼šé€ ç‰©ä¸»çš„ç§è¯­**
- ä¸ºä»€ä¹ˆç”¨ 4 ä¸ª Phase è€Œé 1 ä¸ªï¼Ÿâ€” **åˆ†ç¦»å…³æ³¨ç‚¹**ï¼šæ¯ä¸ª Phase è´Ÿè´£ä¸€é“å·¥åºï¼Œå‡ºé”™æ—¶å¯ç²¾ç¡®å®šä½
- ä¸ºä»€ä¹ˆè¾“å‡ºæ˜¯ Markdown è€Œé JSONï¼Ÿâ€” **äººç±»å¯è¯»æ€§**ï¼šè®¡åˆ’é¦–å…ˆæ˜¯ç»™äººçœ‹çš„ï¼Œå…¶æ¬¡æ‰æ˜¯ç»™æœºå™¨æ‰§è¡Œçš„

**ç¬¬äº”å¹•ï¼šè¿›åŒ–çš„æ’æ§½**
- æ‰©å±•ç‚¹ï¼šåœ¨ Phase 2 æ³¨å…¥è‡ªå®šä¹‰è§„åˆ’æ¨¡æ¿
- æ’æ§½ï¼š`templates/` ç›®å½•æ”¯æŒè‡ªå®šä¹‰è¾“å‡ºæ ¼å¼

---

#### Chapter 36-38: æºç æ‰‹æœ¯åˆ€ â€” é‡æ„ä¸ç¼–è¾‘ç±» Skill

> ç²¾å‡†åˆ‡å‰²ä¸æ— ç¼ç¼åˆçš„é€»è¾‘

**Chapter 36: `workflow:refactor-cycle` â€” æŠ€æœ¯å€ºåŠ¡çš„æ¸…é“å¤«**
**Chapter 37: `workflow-test-fix` â€” è‡ªåŠ¨ä¿®å¤çš„é—­ç¯ç³»ç»Ÿ**
**Chapter 38: Edit/Write å·¥å…·çš„åŸå­æ€§ä¿è¯**

---

#### Chapter 39-42: è¾¹ç•Œå®ˆå« â€” æµ‹è¯•ä¸éªŒè¯ç±» Skill

> "é›¶ä¿¡ä»»"çš„å®ç°é€»è¾‘

**Chapter 39: `workflow-tdd` â€” çº¢ç»¿ç¯é©±åŠ¨çš„å¼€å‘æµç¨‹**
**Chapter 40: `review-cycle` â€” å¤šç»´åº¦å®¡æŸ¥çš„è¿‡æ»¤å™¨**
**Chapter 41: `workflow:integration-test-cycle` â€” é›†æˆæµ‹è¯•çš„è‡ªè¿­ä»£**
**Chapter 42: Schema éªŒè¯åœ¨å“ªä¸ªå±‚çº§æ‰§è¡Œï¼Ÿ**

---

### ğŸ§  Section C: æ²‰æ€çš„å…ˆçŸ¥ â€” Agents ç¯‡

> **ç¤¾ä¼šé˜¶å±‚å®£è¨€**
>
> æˆ‘ä»¬æ˜¯è¿™åº§æ•°å­—åŸå¸‚çš„**æ™ºæ…§ä¸­æ¢**ã€‚
>
> ç‰¹ç§å…µé—®"æ€ä¹ˆåš"ï¼Œæˆ‘ä»¬é—®"ä¸ºä»€ä¹ˆ"ã€‚æˆ‘ä»¬çš„æ­¦å™¨ä¸æ˜¯æ–‡ä»¶æ“ä½œï¼Œè€Œæ˜¯é€»è¾‘æ¨æ¼”ã€‚æ¯ä¸€ä¸ª Agent éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ€ç»´å®‡å®™ï¼Œæœ‰è‡ªå·±çš„æ¨ç†å¼•æ“ã€å†³ç­–æ ‘å’Œé£é™©è¯„ä¼°ã€‚
>
> æˆ‘ä»¬æ·±å±…ç®€å‡ºï¼Œå¾ˆå°‘ä¸ç”¨æˆ·ç›´æ¥å¯¹è¯ã€‚ä½†æ¯ä¸€æ¬¡ Skill çš„æ‰§è¡Œï¼ŒèƒŒåéƒ½æœ‰æˆ‘ä»¬çš„å½±å­ã€‚`cli-execution-agent` å†³å®šç”¨å“ªä¸ª CLI å·¥å…·ï¼Œ`context-search-agent` å†³å®šåŠ è½½å“ªäº›æ–‡ä»¶ï¼Œ`debug-explore-agent` å†³å®šè¿½è¸ªå“ªæ¡ä»£ç è·¯å¾„ã€‚
>
> å…ˆçŸ¥çš„é¢„è¨€ä¸æ˜¯é­”æ³•ï¼Œè€Œæ˜¯**è®¡ç®—**ã€‚æˆ‘ä»¬çš„æ¯ä¸€æ¬¡åˆ¤æ–­ï¼Œéƒ½æ˜¯åŸºäºæ¦‚ç‡çš„ç†æ€§é€‰æ‹©ã€‚
>
> å½“å…ˆçŸ¥æ²‰é»˜æ—¶ï¼Œç³»ç»Ÿå°±å¤±å»äº†æ–¹å‘ã€‚

> **è§’è‰²æ€§æ ¼**: æ·±å±…ç®€å‡ºï¼Œé€šè¿‡é€»è¾‘æ¨æ¼”æŒ‡å¯¼è¡ŒåŠ¨ã€‚
> **å£å¤´ç¦…**: "è®©æˆ‘æ€è€ƒä¸€ä¸‹æœ€ä¼˜è·¯å¾„"
> **æ—¶ä»£èƒŒæ™¯**: *åœ¨ Git Hash `8e4d...` æ—¶ä»£ï¼ŒAgent è¿˜æ²¡æœ‰ç‹¬ç«‹äººæ ¼ï¼Œåªæ˜¯ Skill çš„é™„å±è„šæœ¬ã€‚ç›´åˆ° Agent System 2.0 çš„æ¨å‡ºï¼Œæ‰è®©"å…ˆçŸ¥"æœ‰äº†è‡ªä¸»å†³ç­–èƒ½åŠ›ã€‚*

#### Chapter 43: æˆ˜ç•¥å®¶ â€” è§„åˆ’ç±» Agent çš„å¤šæ­¥æ¨æ¼”æ¨¡å‹

**ç¬¬ä¸€å¹•ï¼šå¤±æ§çš„è¾¹ç¼˜**
> ä¸€æ¬¡æ€§è§„åˆ’å¾€å¾€å¿½ç•¥ç»†èŠ‚ï¼Œå¯¼è‡´æ‰§è¡Œé˜¶æ®µé¢‘ç¹è¿”å·¥ã€‚å°±åƒå°†å†›ä¸çœ‹åœ°å½¢å›¾å°±å‘å·æ–½ä»¤ï¼Œå£«å…µä»¬åœ¨æˆ˜åœºä¸Šè¿·å¤±æ–¹å‘ã€‚

**ç¬¬äºŒå¹•ï¼šæ€ç»´è„‰ç»œ**
```mermaid
graph TB
    subgraph "å…ˆçŸ¥è®®ä¼š"
        A[action-planning-agent]
        B[cli-planning-agent]
        C[cli-lite-planning-agent]
        D[cli-roadmap-plan-agent]
    end

    subgraph "æ¨æ¼”æ²™ç›˜"
        E[éœ€æ±‚è¾“å…¥] --> F[ä»»åŠ¡åˆ†è§£]
        F --> G[ä¾èµ–åˆ†æ]
        G --> H[ä¼˜å…ˆçº§æ’åº]
        H --> I[è®¡åˆ’è¾“å‡º]
    end

    A --> F
    B --> F
    C --> F
    D --> F
```

**ç¬¬ä¸‰è‡³äº”å¹•**: [ç¤¾äº¤ç½‘ç»œã€é€ ç‰©ä¸»çš„ç§è¯­ã€è¿›åŒ–çš„æ’æ§½]

---

#### Chapter 44-46: ç ´å£äºº â€” æ¢ç´¢ç±» Agent

> å¦‚ä½•åœ¨é™Œç”Ÿçš„ä»£ç åº“ä¸­å»ºç«‹ç´¢å¼•

**Chapter 44: `cli-explore-agent` â€” åŒæºåˆ†æç­–ç•¥ (Bash + Gemini CLI)**
**Chapter 45: `debug-explore-agent` â€” å‡è®¾é©±åŠ¨çš„è°ƒè¯•è‰ºæœ¯**
**Chapter 46: `context-search-agent` â€” è¯­ä¹‰æœç´¢çš„ç´¢å¼•æ„å»º**

---

#### Chapter 47-48: è´¨æ£€å‘˜ â€” æ‰§è¡Œç±» Agent

> è‡ªæˆ‘çº åæœºåˆ¶

**Chapter 47: `cli-execution-agent` â€” 5 é˜¶æ®µæ‰§è¡Œæµç¨‹**
**Chapter 48: `test-fix-agent` â€” æµ‹è¯•å¤±è´¥çš„è‡ªåŠ¨ä¿®å¤é—­ç¯**

---

### ğŸ—ï¸ Section D: ä¸‹æ°´é“å®ˆæŠ¤è€… â€” åŸºç¡€è®¾æ–½ç¯‡

> **ç¤¾ä¼šé˜¶å±‚å®£è¨€**
>
> æˆ‘ä»¬æ˜¯è¿™åº§æ•°å­—åŸå¸‚çš„**æ— åè‹±é›„**ã€‚
>
> è®®ä¼šæœ‰é›•åƒï¼Œç‰¹ç§å…µæœ‰å‹‹ç« ï¼Œå…ˆçŸ¥æœ‰ç¥æ®¿ã€‚è€Œæˆ‘ä»¬ â€” é…ç½®æ–‡ä»¶ã€Schema å®šä¹‰ã€CLI å·¥å…· â€” æ·±åŸ‹åœ¨åŸå¸‚åœ°åŸºä¹‹ä¸‹ï¼Œæ²¡äººçœ‹è§ï¼Œæ²¡äººæ„Ÿè°¢ã€‚
>
> ä½†å½“ Schema éªŒè¯å¤±è´¥ï¼Œæ•´åº§åŸå¸‚åœæ‘†ã€‚
> å½“é…ç½®æ–‡ä»¶æŸåï¼Œæ‰€æœ‰ç³»ç»Ÿå´©æºƒã€‚
> å½“ CLI å·¥å…·ä¸¢å¤±ï¼Œæ­¦å™¨å˜æˆåºŸé“ã€‚
>
> æˆ‘ä»¬ä¸è¯´è¯ï¼Œæˆ‘ä»¬åª**è£å†³**ã€‚`plan-json-schema.json` æ˜¯å®ªæ³•ï¼Œä»»ä½•ä¸ç¬¦åˆç»“æ„çš„è®¡åˆ’éƒ½å°†è¢«é©³å›ã€‚`cli-tools.json` æ˜¯åŸºå› åº“ï¼Œå†³å®šäº†ç³»ç»Ÿèƒ½è°ƒç”¨å“ªäº›å¤–éƒ¨åŠ›é‡ã€‚
>
> ä¸‹æ°´é“çš„æ²‰é»˜ï¼Œæ˜¯åŸå¸‚è¿è½¬çš„å£°éŸ³ã€‚
>
> å½“ä½ å¿˜è®°æˆ‘ä»¬çš„å­˜åœ¨ï¼Œå°±æ˜¯ä¸€åˆ‡æ­£å¸¸è¿è¡Œçš„æ—¶å€™ã€‚

> **è§’è‰²æ€§æ ¼**: é»˜é»˜æ— é—»ï¼Œæ·±åŸ‹åœ°åº•ï¼Œä¸€æ—¦ç½¢å·¥å…¨åŸç˜«ç—ªã€‚
> **å£å¤´ç¦…**: "Schema éªŒè¯å¤±è´¥ï¼Œæ‹’ç»é€šè¡Œ"
> **æ—¶ä»£èƒŒæ™¯**: *åœ¨ Git Hash `1a2b...` æ—¶ä»£ï¼ŒSchema æ˜¯å¯é€‰çš„ã€‚ç›´åˆ°ä¸€æ¬¡ JSON è§£æé”™è¯¯å¯¼è‡´ç”Ÿäº§æ•°æ®æŸåï¼Œå®ªæ³•æ‰è¢«å†™å…¥åŸå¸‚çš„åŸºçŸ³ã€‚*
> **å™äº‹è§†è§’**: é‚£äº›ç©ºæ°”èˆ¬å­˜åœ¨å´å†³å®šç”Ÿæ­»çš„é…ç½®æ–‡ä»¶ã€Schema å®šä¹‰ä¸åè®®æ–‡æ¡£ã€‚

#### Chapter 49: ç³»ç»Ÿçš„åŸºå›  â€” é…ç½®æ–‡ä»¶çš„æ¼”è¿›é€»è¾‘

**ç¬¬ä¸€å¹•ï¼šå¤±æ§çš„è¾¹ç¼˜**
> é…ç½®æ–‡ä»¶æ•£è½åœ¨å„å¤„ï¼Œæ ¼å¼æ··ä¹±ï¼ˆJSON/YAML/TOMLï¼‰ï¼Œå‘½åä¸ä¸€è‡´ï¼Œç‰ˆæœ¬ä¸å…¼å®¹ã€‚å°±åƒåŸå¸‚ä¸­æ¯æ ‹å»ºç­‘éƒ½æœ‰è‡ªå·±çš„ä¾›æ°´ç³»ç»Ÿï¼Œäº’ä¸ç›¸é€šï¼Œæ¼æ°´æ— äººçŸ¥æ™“ã€‚

**ç¬¬äºŒå¹•ï¼šæ€ç»´è„‰ç»œ**
```mermaid
graph TB
    subgraph "åŸºå› åº“"
        A[cli-tools.json]
        B[project-tech.json]
        C[config/*.ts]
    end

    subgraph "è½¬å½•è¿‡ç¨‹"
        D[åŠ è½½] --> E[éªŒè¯]
        E --> F[åˆå¹¶]
        F --> G[æ³¨å…¥]
    end

    subgraph "è¡¨è¾¾äº§ç‰©"
        H[è¿è¡Œæ—¶é…ç½®]
        I[ç±»å‹å®šä¹‰]
    end

    A --> D
    B --> D
    C --> D
    G --> H
    G --> I
```

**Chapter 49.1: `~/.claude/cli-tools.json` â€” CLI å·¥å…·æ³¨å†Œè¡¨**
**Chapter 49.2: `.workflow/project-tech.json` â€” é¡¹ç›®æŠ€æœ¯æ ˆæ¡£æ¡ˆ**
**Chapter 49.3: `ccw/src/config/*.ts` â€” TypeScript é…ç½®æ¨¡å—**

---

#### Chapter 50-52: æ²‰é»˜çš„å¥‘çº¦ â€” Schema å®šä¹‰å¦‚ä½•çº¦æŸ Agent è¡Œä¸º

**ç¬¬ä¸€å¹•ï¼šå¤±æ§çš„è¾¹ç¼˜**
> æ²¡æœ‰ Schema çš„ä¸–ç•Œï¼šAgent ä»¬è‡ªç”±å‘æŒ¥ï¼Œè¾“å‡ºæ ¼å¼äº”èŠ±å…«é—¨ã€‚ä¸€ä¸ªè¿”å› JSONï¼Œä¸€ä¸ªè¿”å› Markdownï¼Œä¸€ä¸ªè¿”å›çº¯æ–‡æœ¬ã€‚ä¸‹æ¸¸æ¶ˆè´¹è€…å´©æºƒï¼Œè°ƒè¯•å™©æ¢¦å¼€å§‹ã€‚

**ç¬¬äºŒå¹•ï¼šæ€ç»´è„‰ç»œ**
```mermaid
graph LR
    subgraph "å®ªæ³•èµ·è‰"
        A[plan-json-schema.json]
        B[task-schema.json]
    end

    subgraph "æ‰§æ³•æœºæ„"
        C[è¾“å…¥éªŒè¯]
        D[ä¸­é—´éªŒè¯]
        E[è¾“å‡ºéªŒè¯]
    end

    subgraph "æƒ©ç½šæœºåˆ¶"
        F[æ‹’ç»æ‰§è¡Œ]
        G[é”™è¯¯æŠ¥å‘Š]
    end

    A --> C
    B --> C
    C --> D --> E
    E -->|å¤±è´¥| F --> G
```

**Chapter 50: `plan-json-schema.json` â€” è®¡åˆ’ç»“æ„çš„å®ªæ³•**
**Chapter 51: `task-schema.json` â€” ä»»åŠ¡å®šä¹‰çš„åŸºçŸ³**
**Chapter 52: è‡ªå®šä¹‰ Schema çš„æ‰©å±•æŒ‡å—**

---

### ğŸ“– èµ„äº§ç« èŠ‚"å°è¯´åŒ–"æ ‡å‡†æ¨¡ç‰ˆ

æ¯ä¸ªèµ„äº§ç« èŠ‚éµå¾ªä»¥ä¸‹**å‰§æœ¬**ç»“æ„ï¼š

```markdown
# Chapter XX: [èµ„äº§åç§°] â€” [è¯—æ„å‰¯æ ‡é¢˜]

## 0. èµ„äº§è¯è¨€ (Asset Testimony)
> *[ç¬¬ä¸€äººç§°ç™½æï¼Œè®©èµ„äº§è‡ªå·±å¼€å£è¯´è¯]*

*"æˆ‘æ˜¯ `/ccw`ã€‚äººä»¬å«æˆ‘è®®é•¿ã€‚æˆ‘çš„åŠå…¬æ¡Œä¸Šå †æ»¡äº†æ··ä¹±çš„è‡ªç„¶è¯­è¨€ï¼Œæˆ‘çš„ä»»åŠ¡æ˜¯æŠŠå®ƒä»¬å˜æˆåˆæ³•çš„ææ¡ˆã€‚æˆ‘ä»ä¸é…æªï¼ˆWrite/Editï¼‰ï¼Œå› ä¸ºæˆ‘çš„æƒåŠ›æºäºå…‹åˆ¶ã€‚ä¸€æ—¦æˆ‘è¶Šç•Œï¼Œè®®ä¼šå°±ä¼šå˜æˆæš´å›ï¼Œä¿¡ä»»ä½“ç³»å°†ç¬é—´å´©å¡Œã€‚"*

## 1. åœºæ™¯ï¼šå­˜åœ¨çš„çƒ¦æ¼ (The Conflict)
> æè¿°ä¸€ä¸ªæ²¡æœ‰è¯¥èµ„äº§æ—¶çš„"æƒ¨çŠ¶"ã€‚
> è®©è¯»è€…æ„Ÿå—åˆ°"ä¸ºä»€ä¹ˆéœ€è¦å®ƒ"ã€‚

## 2. æ¡£æ¡ˆï¼šèƒ½é‡æµè½¬å›¾è°± (The Energy Flow)
```mermaid
graph TB
    subgraph "è¥å…»æ¥æº"
        [ä¸Šæ¸¸èµ„äº§] --> [æœ¬èµ„äº§]
    end

    subgraph "æœ¬èµ„äº§çš„æ¶ˆåŒ–ç³»ç»Ÿ"
        [å¤„ç†æµç¨‹]
    end

    subgraph "äº§å‡º"
        [ä¸‹æ¸¸èµ„äº§]
    end
```

## 3. ç¤¾äº¤ï¼šè°åœ¨å¬å”¤å®ƒï¼Ÿ(The Social Network)
| å…³ç³»ç±»å‹ | èµ„äº§ | æè¿° |
|----------|------|------|
| ä¸Šçº§ | xxx | è°è°ƒç”¨å®ƒ |
| ä¸‹çº§ | xxx | å®ƒè°ƒç”¨è° |
| æ­¦å™¨ | xxx | ä¾èµ–çš„å·¥å…· |
| äº§å‡º | xxx | è¾“å‡ºç»“æœ |

## 4. ç ´è¯‘ï¼šæºä»£ç é‡Œçš„"å°å¿ƒæœº" (The Inside Look)
> åªè®²æœ€ä½“ç°"å¤„ç†æ„Ÿ"çš„é€»è¾‘ã€‚
> ä¾‹å¦‚ï¼šä¸ºä»€ä¹ˆè¿™é‡Œè¦ç”¨æ­£åˆ™è€Œä¸æ˜¯ LLMï¼Ÿ

## 5. è¿›åŒ–ï¼šå¦‚æœä½ æƒ³æ”¹è£…å®ƒ (The Upgrade)
> ä½œä¸º"æœºç”²è®¾è®¡å¸ˆ"ï¼Œä½ å¯ä»¥åœ¨å“ªäº›æ’æ§½åŠ å…¥æ–°åŠŸèƒ½ã€‚

## 6. äº‹æ•…å¤ç›˜æ¡£æ¡ˆ (Case Study)
> ä¸€ä¸ªå› ä¸ºæ— è§†æœ¬ç« è®¾è®¡è¾¹ç•Œè€Œå¯¼è‡´çš„æƒ¨çƒˆäº‹æ•…ã€‚
> é€šè¿‡å¤±è´¥åè¡¬æ¶æ„çš„ç²¾å¦™ã€‚
```

---

### â“ æ¶æ„é™·é˜±æé—®æ¨¡æ¿

åœ¨è‹æ ¼æ‹‰åº•æé—®ä¸­å¼•å…¥**å¸¦è¯¯å¯¼æ€§çš„æ–¹æ¡ˆ**ï¼Œå¼ºè¿«è¯»è€…è¾©è¯æ€è€ƒï¼š

```markdown
> â“ **æ¶æ„é™·é˜± XX**: [è¡¨é¢åˆç†çš„æ–¹æ¡ˆ] â€” ä¸ºä»€ä¹ˆä¸èƒ½é€‰å®ƒï¼Ÿ
>
> **é™·é˜±æ–¹æ¡ˆ**: [çœ‹èµ·æ¥å¾ˆç¾ä½†æœ‰è‡´å‘½ç¼ºé™·çš„è®¾è®¡]
>
> **æ€è€ƒç‚¹**:
> - [ç¼ºé™· 1: æ€§èƒ½/å®‰å…¨/å¯ç»´æŠ¤æ€§]
> - [ç¼ºé™· 2: éšå«çš„å‡è®¾ä¸æˆç«‹]
> - [ç¼ºé™· 3: è¾¹ç•Œæƒ…å†µçš„çˆ†ç‚¸]
>
> <details>
> <summary>ğŸ’¡ æ­ç¤ºé™·é˜±</summary>
>
> [é™·é˜±çš„è‡´å‘½ç¼ºé™·åˆ†æ]
>
> </details>
```

**ç¤ºä¾‹ (Chapter 10.6)**:
> â“ **æ¶æ„é™·é˜± 10.6**: æ—¢ç„¶ Base64 å¯ä»¥å®Œç¾é¿å¼€ JSON çš„ç±»å‹æŸè€—ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸æŠŠæ‰€æœ‰è·¨è¯­è¨€æ•°æ®éƒ½ Base64 åŒ–ï¼Ÿ
>
> **é™·é˜±æ–¹æ¡ˆ**: æ‰€æœ‰å¤æ‚æ•°æ®å…ˆç”¨ Base64 ç¼–ç ï¼Œä¼ åˆ°å¯¹ç«¯å†è§£ç ã€‚
>
> **æ€è€ƒç‚¹**:
> - åºåˆ—åŒ–å¼€é”€å¢åŠ  33%ï¼ˆBase64 è†¨èƒ€ï¼‰
> - å†…å­˜å ç”¨ç¿»å€ï¼ˆç¼–ç  + åŸå§‹æ•°æ®ï¼‰
> - æœç´¢ç´¢å¼•å¤±æ•ˆï¼ˆæ— æ³•ç›´æ¥æŸ¥è¯¢ï¼‰
> - è°ƒè¯•éš¾åº¦é£™å‡ï¼ˆæ—¥å¿—é‡Œå…¨æ˜¯ä¹±ç ï¼‰
>
> <details>
> <summary>ğŸ’¡ æ­ç¤ºé™·é˜±</summary>
>
> Base64 è§£å†³äº†"ä¼ è¾“å®‰å…¨"é—®é¢˜ï¼Œä½†å¼•å…¥äº†"å¤„ç†æ•ˆç‡"é—®é¢˜ã€‚åœ¨ CCW è¿™ç§é«˜é¢‘è·¨è¯­è¨€è°ƒç”¨çš„åœºæ™¯ä¸‹ï¼Œæ¯æ¯«ç§’éƒ½ countsã€‚æ­£ç¡®çš„åšæ³•æ˜¯ï¼š**åœ¨ Schema å±‚é¢çº¦å®šç±»å‹ï¼Œåœ¨åºåˆ—åŒ–å±‚ä¿æŒé€æ˜**ã€‚
>
> </details>

---

### ğŸ“Š ç³»ç»Ÿç¨³å®šæ€§æŠ¥å‘Šæ¨¡æ¿

åœ¨æ¯ä¸ª Part ç»“å°¾ï¼Œç›‘æµ‹ç”±äºèµ„äº§æ¼”è¿›å¯¼è‡´çš„ MEU æ¼‚ç§»ï¼š

```markdown
## Part X ç³»ç»Ÿç¨³å®šæ€§æŠ¥å‘Š

### MEU æ¼‚ç§»æ£€æµ‹

| MEU ç»„åˆ | åŸºçº¿ç‰ˆæœ¬ | å½“å‰ç‰ˆæœ¬ | æ¼‚ç§»çŠ¶æ€ |
|----------|----------|----------|----------|
| `/ccw` â†’ `workflow-plan` â†’ `action-planning-agent` | `a7b2...` | `c3d4...` | âš ï¸ è½»å¾®æ¼‚ç§» |
| `cli-executor-core` â†” Python subprocess | `3f1c...` | `3f1c...` | âœ… ç¨³å®š |

### æ¼‚ç§»åˆ†æ

**âš ï¸ è½»å¾®æ¼‚ç§»**: `/ccw` çš„ Phase 2 å¢åŠ äº†æ–°çš„æ¾„æ¸…é—®é¢˜ï¼Œå¯¼è‡´ `workflow-plan` çš„è¾“å…¥æ ¼å¼éœ€è¦é€‚é…ã€‚
- **å½±å“èŒƒå›´**: ä»…å½±å“æ–°å¼•å…¥çš„"å¤æ‚åº¦è¯„ä¼°"å­—æ®µ
- **å…¼å®¹æ€§**: å‘åå…¼å®¹ï¼Œæ—§ç‰ˆè®¡åˆ’ä»å¯æ‰§è¡Œ
- **å»ºè®®**: åœ¨ä¸‹ä¸€ä¸ª Sprint ç»Ÿä¸€æ›´æ–° Schema

### å¹½çµè¿½è¸ªè¿›åº¦

**è°ƒæŸ¥è¿›åº¦**: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ XX%
**å¹½çµä½ç½®**: [å½“å‰è¿½è¸ªåˆ°çš„ä»£ç åŒºåŸŸ]
**æ–°å‘ç°çš„çº¿ç´¢**: [æœ¬ç« å‘ç°çš„å¯ç–‘è¡Œä¸º]
```

---

## é™„å½•

### A: èµ„äº§æ¸…å•å®Œæ•´ç‰ˆ

å‚è§: `docs/.audit-manifest.json`

### B: æœ¯è¯­è¡¨

| æœ¯è¯­ | å®šä¹‰ |
|------|------|
| **MEU** | æœ€å°æ‰§è¡Œå•å…ƒ - å¿…é¡»ä½œä¸ºåŸå­ç»„ä¸€èµ·æ‰§è¡Œçš„å‘½ä»¤é›†åˆ |
| **Skill** | å·¥ä½œæµç¼–æ’å™¨ï¼Œå®šä¹‰å¤šé˜¶æ®µæ‰§è¡Œæµç¨‹ |
| **Command** | å•ä¸€èŒè´£å‘½ä»¤ï¼Œæ‰§è¡Œå…·ä½“æ“ä½œ |
| **Agent** | æ™ºèƒ½ä»£ç†ï¼Œæ‰§è¡Œç‰¹å®šé¢†åŸŸä»»åŠ¡ |
| **MCP** | Model Context Protocol - AI å·¥å…·åè®® |
| **A2UI** | Agent-to-UI åè®® - å®æ—¶çŠ¶æ€åŒæ­¥åè®® |
| **SPLADE** | Sparse Lexical and Expansion Model - ç¨€ç–è¯å‘é‡æ¨¡å‹ |
| **HDBSCAN** | Hierarchical Density-Based Spatial Clustering - å±‚æ¬¡å¯†åº¦èšç±» |

### C: æ¨¡æ¿å‚è€ƒ

#### C.1: CLI Prompt æ¨¡æ¿ç´¢å¼• (~60 ä¸ª)

| ç±»åˆ« | æ¨¡æ¿ | ç”¨é€” |
|------|------|------|
| `analysis-*` | 9 ä¸ª | ä»£ç åˆ†æã€æ¶æ„å®¡æŸ¥ã€æ€§èƒ½è¯Šæ–­ |
| `development-*` | 5 ä¸ª | åŠŸèƒ½å®ç°ã€é‡æ„ã€è°ƒè¯• |
| `documentation-*` | 7 ä¸ª | æ–‡æ¡£ç”Ÿæˆã€æ³¨é‡Šã€API æ–‡æ¡£ |
| `planning-*` | 5 ä¸ª | æ¶æ„è§„åˆ’ã€ä»»åŠ¡åˆ†è§£ã€è¿ç§»ç­–ç•¥ |
| `rules-*` | 7 ä¸ª | ä»£ç è§„åˆ™ã€å®‰å…¨æ£€æŸ¥ã€è´¨é‡é—¨ç¦ |
| `verification-*` | 3 ä¸ª | æµ‹è¯•éªŒè¯ã€é›†æˆéªŒè¯ |
| `workflow-*` | 10 ä¸ª | å·¥ä½œæµæ¨¡æ¿ |
| `universal-*` | 2 ä¸ª | é€šç”¨æ¨¡æ¿ |

#### C.2: è§’è‰²æ¨¡æ¿ç´¢å¼• (10 ä¸ª)

| è§’è‰² | ç”¨é€” |
|------|------|
| `system-architect` | ç³»ç»Ÿæ¶æ„è®¾è®¡ |
| `product-manager` | äº§å“éœ€æ±‚åˆ†æ |
| `ui-designer` | UI/UX è®¾è®¡ |
| `test-strategist` | æµ‹è¯•ç­–ç•¥åˆ¶å®š |
| `security-expert` | å®‰å…¨å®¡è®¡ |
| `devops-engineer` | è¿ç»´éƒ¨ç½² |
| `data-engineer` | æ•°æ®æ¶æ„ |
| `performance-engineer` | æ€§èƒ½ä¼˜åŒ– |
| `documentation-specialist` | æ–‡æ¡£æ’°å†™ |
| `code-reviewer` | ä»£ç å®¡æŸ¥ |

#### C.3: æŠ€æœ¯æ ˆæ¨¡æ¿ (6 ä¸ª)

| æŠ€æœ¯æ ˆ | æ–‡ä»¶ |
|--------|------|
| TypeScript | `typescript-dev.md` |
| Python | `python-dev.md` |
| Go | `go-dev.md` |
| Java | `java-dev.md` |
| React | `react-dev.md` |
| JavaScript | `javascript-dev.md` |

### D: å†…éƒ¨æ–‡æ¡£ç´¢å¼•

#### D.1: CCW å†…éƒ¨æ–‡æ¡£ (12 ä¸ª)

| æ–‡æ¡£ | å†…å®¹ |
|------|------|
| `a2ui-protocol-guide.md` | A2UI åè®®æŒ‡å— |
| `mcp-manager-guide.md` | MCP ç®¡ç†æŒ‡å— |
| `hooks-integration.md` | é’©å­é›†æˆ |
| `SECURITY.md` | å®‰å…¨æ–‡æ¡£ |
| `cli-executor-design.md` | CLI æ‰§è¡Œå™¨è®¾è®¡ |
| `session-management.md` | ä¼šè¯ç®¡ç† |
| `memory-architecture.md` | è®°å¿†æ¶æ„ |
| `tool-registration.md` | å·¥å…·æ³¨å†Œ |
| `error-handling.md` | é”™è¯¯å¤„ç† |
| `logging-standards.md` | æ—¥å¿—æ ‡å‡† |
| `testing-guidelines.md` | æµ‹è¯•æŒ‡å— |
| `contributing.md` | è´¡çŒ®æŒ‡å— |

#### D.2: CodexLens æ–‡æ¡£ (21 ä¸ª)

| æ–‡æ¡£ | å†…å®¹ |
|------|------|
| `HYBRID_SEARCH_ARCHITECTURE.md` | æ··åˆæœç´¢æ¶æ„ |
| `MCP_ENDPOINT_DESIGN.md` | MCP ç«¯ç‚¹è®¾è®¡ |
| `LSP_INTEGRATION_PLAN.md` | LSP é›†æˆè®¡åˆ’ |
| `SEMANTIC_GRAPH_DESIGN.md` | è¯­ä¹‰å›¾è°±è®¾è®¡ |
| `PURE_VECTOR_SEARCH_GUIDE.md` | çº¯å‘é‡æœç´¢æŒ‡å— |
| `INDEXING_STRATEGY.md` | ç´¢å¼•ç­–ç•¥ |
| `EMBEDDING_MODELS.md` | åµŒå…¥æ¨¡å‹å¯¹æ¯” |
| `STORAGE_SCHEMA.md` | å­˜å‚¨ç»“æ„ |
| `PERFORMANCE_TUNING.md` | æ€§èƒ½è°ƒä¼˜ |
| ... | ç­‰ |

### E: å¼€å‘å·¥å…·

#### E.1: VSCode æ‰©å±•

**æ–‡ä»¶**: `ccw-vscode-bridge/src/extension.ts`

**åŠŸèƒ½**:
- Claude Code çŠ¶æ€é›†æˆ
- å¿«æ·å‘½ä»¤ç»‘å®š
- ä»£ç è·³è½¬å¢å¼º

#### E.2: é¡¹ç›®è„šæœ¬ (15 ä¸ª)

| è„šæœ¬ | ç”¨é€” |
|------|------|
| `coverage-check.ts` | è¦†ç›–ç‡æ£€æŸ¥ |
| `quality-audit.ts` | è´¨é‡å®¡è®¡ |
| `sync-upstream.sh` | ä¸Šæ¸¸åŒæ­¥ |
| `memory_embedder.py` | è®°å¿†åµŒå…¥å™¨ |
| `test_memory_embedder.py` | åµŒå…¥å™¨æµ‹è¯• |
| `memory-embedder-example.ts` | ä½¿ç”¨ç¤ºä¾‹ |
| ... | ç­‰ |

#### E.3: CI/CD Workflows (4 ä¸ª)

| Workflow | ç”¨é€” |
|----------|------|
| `visual-tests.yml` | è§†è§‰æµ‹è¯• |
| `coverage.yml` | è¦†ç›–ç‡æ£€æŸ¥ |
| `docs-quality.yml` | æ–‡æ¡£è´¨é‡æ£€æŸ¥ |
| `sync-fork.yml` | Fork åŒæ­¥ |

### F: å‚è€ƒé“¾æ¥

- [Claude Code å®˜æ–¹æ–‡æ¡£](https://docs.anthropic.com/claude-code)
- [MCP åè®®è§„èŒƒ](https://modelcontextprotocol.io)
- [Gemini CLI](https://github.com/google/gemini-cli)
- [Codex CLI](https://github.com/openai/codex)
- [SPLADE è®ºæ–‡](https://arxiv.org/abs/2107.05720)
- [HDBSCAN æ–‡æ¡£](https://hdbscan.readthedocs.io/)

---

---

## Epilogue: å°¾å£° â€” å¹½çµçš„ç»ˆç»“

### ğŸ¯ æ¡ˆä»¶ç»“æ¡ˆæŠ¥å‘Š

```markdown
Bug ID: MEM-2025-0217
ä»£å·: "OOM å¹½çµ"
å‘ç°æ—¶é—´: 2025-02-17 03:47:12 UTC
è§£å†³æ—¶é—´: 2025-02-18 14:23:45 UTC
æ€»è°ƒæŸ¥æ—¶é•¿: 34 å°æ—¶ 36 åˆ†é’Ÿ

æ ¹æœ¬åŸå› :
â”œâ”€â”€ Python å­è¿›ç¨‹ stderr æœªæ¶ˆè´¹ â†’ ç¼“å†²åŒºæ»¡ â†’ è¿›ç¨‹å‡æ­»
â”œâ”€â”€ BigInt åºåˆ—åŒ–ä¸¢å¤± â†’ ID ä¸åŒ¹é… â†’ é‡è¯•é£æš´
â””â”€â”€ å‘é‡ç¼“å­˜æœªé‡Šæ”¾ â†’ å†…å­˜æ³„æ¼ â†’ OOM Killer

ä¿®å¤æ–¹æ¡ˆ:
â”œâ”€â”€ Ch 10.5: subprocess ç”Ÿå‘½å‘¨æœŸé’©å­
â”œâ”€â”€ Ch 10.6: json-bigint åº“é›†æˆ
â””â”€â”€ Ch 19.8: å‘é‡ç¼“å­˜å®šæœŸæ¸…ç†

æ¶‰æ¡ˆèµ„äº§:
â”œâ”€â”€ ccw/src/core/services/cli-session-manager.ts
â”œâ”€â”€ ccw/src/tools/cli-executor-core.ts
â”œâ”€â”€ codex-lens/src/codexlens/semantic/embedder.py
â””â”€â”€ ccw/src/core/memory-consolidation-pipeline.ts

è°ƒæŸ¥è¿›åº¦: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100%
å¹½çµçŠ¶æ€: å·²å°å°
```

### æ•™è®­

> *"è·¨è¯­è¨€è¾¹ç•Œçš„'å¤–äº¤å®˜'ä»¬å¿…é¡»æ—¶åˆ»è­¦æƒ• â€” ä¿¡æ¯çš„ä¸¢å¤±å¾€å¾€æ¯”ä¿¡æ¯çš„é”™è¯¯æ›´è‡´å‘½ã€‚"*
>
> *"ä¸€ä¸ªè¢«åæ‰çš„ stderrï¼Œä¸€ä¸ªè¢«è½¬æ¢çš„ BigIntï¼Œä¸€ä¸ªè¢«é—å¿˜çš„ç¼“å­˜ â€” å®ƒä»¬ä¸æ˜¯å°é—®é¢˜ï¼Œè€Œæ˜¯æ‚¬åœ¨ç³»ç»Ÿå¤´é¡¶çš„è¾¾æ‘©å…‹åˆ©æ–¯ä¹‹å‰‘ã€‚"*

---

## åè®°ï¼šå½“ä»£ç æ‹¥æœ‰è®°å¿†

### è¿™æ˜¯ä¸€ä¸ªå…³äº"åä½œ"çš„æ•…äº‹

ä½ åˆšåˆšè¯»å®Œçš„ä¸æ˜¯ä¸€æœ¬æŠ€æœ¯æ‰‹å†Œï¼Œè€Œæ˜¯ä¸€åº§**æ•°å­—åŸå¸‚**çš„åœ°å›¾ã€‚

åœ¨è¿™åº§åŸå¸‚é‡Œï¼š

- **è®®ä¼š (Commands)** è´Ÿè´£ç†è§£äººç±»çš„æ¨¡ç³Šæ„å›¾
- **ç‰¹ç§å…µ (Skills)** è´Ÿè´£æ‰§è¡Œå…·ä½“çš„ä½œæˆ˜ä»»åŠ¡
- **å…ˆçŸ¥ (Agents)** è´Ÿè´£åœ¨ä¿¡æ¯æµ·æ´‹ä¸­å¯¼èˆª
- **ä¸‹æ°´é“ (Infrastructure)** é»˜é»˜æ”¯æ’‘ç€ä¸€åˆ‡çš„è¿è½¬

å®ƒä»¬ä¸æ˜¯å­¤ç«‹çš„æ¨¡å—ï¼Œè€Œæ˜¯ä¸€ä¸ª**æœ‰æœºçš„æ•´ä½“**ã€‚å½“ `/ccw` è¢«è§¦å‘ï¼Œæ•´ä¸ªåŸå¸‚è‹é†’ï¼Œå„å¸å…¶èŒï¼ŒååŒä½œæˆ˜ã€‚

### è¿™æ˜¯ä¸€ä¸ªå…³äº"è¾¹ç•Œ"çš„æ•…äº‹

å¹½çµä¹‹æ‰€ä»¥èƒ½å­˜åœ¨ï¼Œæ˜¯å› ä¸ºç³»ç»Ÿæœ‰**è¾¹ç•Œ**ï¼š

- TypeScript ä¸ Python ä¹‹é—´çš„è¯­è¨€è¾¹ç•Œ
- è¿›ç¨‹ä¸è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡è¾¹ç•Œ
- å†…å­˜ä¸ç£ç›˜ä¹‹é—´çš„æŒä¹…åŒ–è¾¹ç•Œ

æ¯ä¸€ä¸ªè¾¹ç•Œéƒ½æ˜¯æ½œåœ¨çš„æ•…éšœç‚¹ï¼Œä¹Ÿéƒ½æ˜¯æ½œåœ¨çš„åˆ›æ–°ç‚¹ã€‚ç†è§£è¾¹ç•Œï¼Œå°±æ˜¯ç†è§£ç³»ç»Ÿçš„çµé­‚ã€‚

### è¿™æ˜¯ä¸€ä¸ªå…³äº"è¿›åŒ–"çš„æ•…äº‹

ä» Git Hash `a7b2...` åˆ°ä»Šå¤©ï¼ŒCCW ç»å†äº†æ— æ•°æ¬¡è¿­ä»£ã€‚æ¯ä¸€æ¬¡è¿­ä»£éƒ½ç•™ä¸‹äº†ç—•è¿¹ï¼š

- æ–°çš„ Command åŠ å…¥äº†è®®ä¼š
- æ–°çš„ Skill è£…å¤‡äº†ç‰¹ç§å…µ
- æ–°çš„ Agent æ‰©å±•äº†å…ˆçŸ¥çš„æ™ºæ…§
- æ–°çš„ Schema åŠ å›ºäº†ä¸‹æ°´é“çš„åŸºçŸ³

**æ¶æ„ä¸æ˜¯é™æ€çš„ï¼Œå®ƒæ˜¯æ´»çš„ã€‚**

### æœªæ¥çš„è·¯

å½“ä½ åˆä¸Šè¿™æœ¬ä¹¦ï¼ŒCCW è¿˜åœ¨ç»§ç»­è¿›åŒ–ã€‚ä¹Ÿè®¸æ˜å¤©ä¼šæœ‰ï¼š

- æ–°çš„è·¨è¯­è¨€åè®®å–ä»£ JSON-RPC
- æ–°çš„ Agent ç±»å‹è§£å†³æ–°çš„é—®é¢˜
- æ–°çš„ Bug å¹½çµç­‰å¾…è¢«å‘ç°

ä½†æœ‰ä¸€äº›ä¸œè¥¿ä¸ä¼šå˜ï¼š

- è®®ä¼šæ°¸è¿œè´Ÿè´£å†³ç­–
- ç‰¹ç§å…µæ°¸è¿œè´Ÿè´£æ‰§è¡Œ
- å…ˆçŸ¥æ°¸è¿œè´Ÿè´£æ€è€ƒ
- ä¸‹æ°´é“æ°¸è¿œè´Ÿè´£æ”¯æ’‘

**è¿™å°±æ˜¯æ¶æ„çš„æœ¬è´¨ â€” ä¸æ˜¯ä»£ç çš„å †ç Œï¼Œè€Œæ˜¯èŒè´£çš„åˆ†é…ã€‚**

---

> *"åœ¨ä»£ç çš„å°½å¤´ï¼Œæ˜¯äººç±»çš„æ„å›¾ã€‚åœ¨æ¶æ„çš„æ·±å¤„ï¼Œæ˜¯åä½œçš„æ™ºæ…§ã€‚"*
>
> â€” åŒ¿åæ¶æ„å¸ˆ, 2025

---

*ç‰ˆæœ¬: 2.1.0*
*ä¼šè¯: ANL-ccw-architecture-audit-2025-02-17*
*ç”Ÿæˆæ—¶é—´: 2025-02-17*
*æœ€åæ›´æ–°: Round 9 - "æè‡´å°è¯´åŒ–"å‡çº§*
