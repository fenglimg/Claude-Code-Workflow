{"id":"SOL-ISS-20260217-009-k7r3","description":"撰写 CCW 深度研习文档 Chapter 10.5，分析 TS 调用 Python 的 child_process 机制，升级现有 v1.0 模板至 v2.1 标准","approach":"基于现有 10.5-child-process-diplomat.md 模板进行 v2.1 标准升级，添加资产证言、幽灵追踪线索、事故复盘档案等 7 模块结构。重点分析 spawn 参数构建、Python 虚拟环境发现激活、进程超时强制终止、stderr 缓冲区累积等边缘情况。","tasks":[{"id":"T1","title":"分析 cli-executor-core.ts 进程创建机制","scope":"docs/deep-study/part4-5-cross-language","action":"Update","description":"深入分析 child_process.spawn() 参数构建、环境变量注入、stdio 配置","files":[{"path":"docs/deep-study/part4-5-cross-language/10.5-child-process-diplomat.md","action":"modify","target":"全文重构","change":"升级至 v2.1 标准，添加资产证言、幽灵线索、事故档案等模块"}],"implementation":["读取 ccw/src/tools/cli-executor-core.ts 分析 spawn 参数构建逻辑","提取 killCurrentCliProcess() 中的 SIGTERM/SIGKILL 超时机制","分析 stdin/stdout/stderr 三管道配置方案","绘制进程生命周期状态机图"],"test":{"commands":["grep -n 'spawn(' ccw/src/tools/cli-executor-core.ts | head -20"],"manual_checks":["验证文档中的代码示例与实际源码一致"]},"convergence":{"criteria":["spawn 参数构建逻辑完整记录","环境变量注入方案清晰说明","stdio 三管道配置图示准确"],"verification":"Review 文档结构与 Chapter 4 工作流金字塔风格一致"},"commit":{"type":"docs","scope":"deep-study","message_template":"docs(deep-study): upgrade Chapter 10.5 to v2.1 standard - child_process diplomat"},"depends_on":[],"priority":"high"},{"id":"T2","title":"撰写 Python 虚拟环境发现与激活机制","scope":"docs/deep-study/part4-5-cross-language","action":"Add","description":"分析 python-utils.ts 中的 venv 发现逻辑，Python 版本兼容性检查，CCW_PYTHON 环境变量支持","files":[{"path":"docs/deep-study/part4-5-cross-language/10.5-child-process-diplomat.md","action":"modify","target":"第二幕：思维脉络","change":"添加虚拟环境发现与激活章节"}],"implementation":["分析 getSystemPython() 函数的版本检测逻辑","提取 Windows py launcher 优先级策略 (3.12 > 3.11 > 3.10 > 3.9)","记录 CCW_PYTHON 环境变量的自定义路径支持","绘制跨平台 Python 发现决策树"],"test":{"manual_checks":["验证文档覆盖 Windows/Linux/macOS 三平台"]},"convergence":{"criteria":["venv 发现逻辑完整说明","版本兼容性矩阵 (3.9-3.12) 清晰","CCW_PYTHON 环境变量使用说明准确"],"verification":"技术审校确认内容准确性"},"commit":null,"depends_on":["T1"],"priority":"medium"},{"id":"T3","title":"撰写进程超时与强制终止机制","scope":"docs/deep-study/part4-5-cross-language","action":"Add","description":"分析 killCurrentCliProcess() 中的 SIGTERM → SIGKILL 超时级联机制，幽灵线索：stderr 缓冲区满导致进程假死","files":[{"path":"docs/deep-study/part4-5-cross-language/10.5-child-process-diplomat.md","action":"modify","target":"第五幕：进化的插槽 + 事故复盘档案","change":"添加进程超时机制和幽灵追踪线索"}],"implementation":["分析 2 秒超时后 SIGKILL 的强制终止逻辑","追踪 currentChildProcess 全局变量的生命周期","撰写幽灵线索：stderr 未消费导致缓冲区满 → 进程假死 → OOM","添加事故复盘档案：Level 4 命令链构建异常内存分配案例"],"test":{"manual_checks":["验证超时机制与源码一致"]},"convergence":{"criteria":["SIGTERM/SIGKILL 级联机制清晰","幽灵线索指向 stderr 缓冲区累积问题","事故复盘档案包含根因分析和修复措施"],"verification":"Review 文档完整性"},"commit":null,"depends_on":["T1"],"priority":"medium"},{"id":"T4","title":"添加资产证言与社交网络模块","scope":"docs/deep-study/part4-5-cross-language","action":"Add","description":"撰写 spawn() 的第一人称资产证言，绘制调用关系图（cli-executor-core → child_process → Python CLI）","files":[{"path":"docs/deep-study/part4-5-cross-language/10.5-child-process-diplomat.md","action":"modify","target":"0. 资产证言 + 第三幕：社交网络","change":"添加 spawn() 资产证言和调用关系图"}],"implementation":["撰写 spawn() 第一人称证言：'我是边境检查站...我的职责是...我见过无数次信使失踪...stderr 是间谍通道'","绘制 TypeScript 外交部 → 边境协议 → Python 外交部调用图","标注关键资产：cli-executor-core.ts, python-utils.ts, codexlens/cli/"],"test":{"manual_checks":["资产证言风格与 Chapter 4 一致"]},"convergence":{"criteria":["资产证言符合'小说化'风格","社交网络图清晰展示调用关系","关键资产列表完整"],"verification":"风格审校确认叙事一致性"},"commit":null,"depends_on":["T1"],"priority":"medium"},{"id":"T5","title":"撰写架构陷阱与苏格拉底提问","scope":"docs/deep-study/part4-5-cross-language","action":"Add","description":"添加架构陷阱提问：为什么用 stdio 而非 HTTP？stderr 为什么是间谍通道？","files":[{"path":"docs/deep-study/part4-5-cross-language/10.5-child-process-diplomat.md","action":"modify","target":"苏格拉底式思考 + 第四幕：造物主的私语","change":"添加架构陷阱和设计哲学揭示"}],"implementation":["添加陷阱：为什么不用 HTTP？揭示：无端口冲突、零网络延迟、进程生命周期绑定","添加陷阱：为什么 stderr 是间谍通道？揭示：正式渠道 vs 私下汇报分离","添加陷阱：为什么用 \\\\n 作为消息边界？揭示：TCP 流式协议的分包问题"],"test":{"manual_checks":["陷阱设计符合 OUTLINE.md 规范"]},"convergence":{"criteria":["至少 3 个架构陷阱提问","每个陷阱有揭示部分","设计哲学阐述清晰"],"verification":"Review 提问质量"},"commit":null,"depends_on":["T1"],"priority":"low"}],"exploration_context":{"relevant_files":["ccw/src/tools/cli-executor-core.ts","ccw/src/tools/cli-executor-utils.ts","ccw/src/utils/python-utils.ts","docs/deep-study/part4.5-bridge/10.5-child-process-diplomat.md","docs/deep-study/part2-dispatch-layer/04-workflow-pyramid.md"],"patterns":"spawn参数构建 → 环境变量注入 → stdio管道配置 → 进程生命周期管理 → 超时强制终止","integration_points":"cli-executor-core.ts 调用 buildCommand() 构建参数，调用 spawn() 创建子进程"},"analysis":{"risk":"low","impact":"medium","complexity":"low"},"score":0.92,"is_bound":true,"bound_at":"2026-02-17T14:11:59.631Z"}
