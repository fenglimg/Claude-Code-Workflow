{"id":"SOL-ISS-20260217-003-k7m2","description":"撰写 CCW 深度研习文档 Chapter 9: Agent 生命周期，分析 Agent 代理系统的完整生命周期机制","approach":"基于 21 个 Agent 定义文件 (.claude/agents/*.md) 和工具实现 (ccw/src/tools/)，按照 7 模块 SOP 标准撰写文档。重点分析 Agent 的调用机制 (函数调用 vs HTTP)、prompt 字段构建、工具绑定关系、超时和重试机制。采用 OOM 幽灵叙事风格，延续累计 ~1.2GB 内存 + 8s 延迟的调查线索。","analysis":{"risk":"low","impact":"medium","complexity":"medium"},"score":0.85,"tasks":[{"id":"T1","title":"创建 Chapter 9 文档结构","scope":"docs/deep-study/part5-execution-layer","action":"Create","description":"创建 09-agent-lifecycle.md 文档，按照 7 模块 SOP 标准构建文档框架","files":[{"path":"docs/deep-study/part5-execution-layer/09-agent-lifecycle.md","action":"create","change":"创建完整的 Agent 生命周期章节文档"}],"implementation":["创建文档头部：生命周期阶段、涉及资产、阅读时间、版本追踪","撰写 0. 资产证言 (Asset Testimony) - Agent 第一人称自我介绍","撰写 第一幕：失控的边缘 - 没有 Agent 的世界","撰写 第二幕：思维脉络 - Agent 调用机制流程图","撰写 第三幕：社交网络 - Agent 调用关系图谱","撰写 第四幕：造物主的私语 - 设计决策解析","撰写 第五幕：进化的插槽 - 扩展点设计","撰写 事故复盘档案 - Agent 相关故障案例","撰写 附录：相关文件清单和下一章预告"],"test":{"unit":["验证文档结构符合 7 模块 SOP 标准"],"commands":["ls docs/deep-study/part5-execution-layer/09-agent-lifecycle.md"]},"convergence":{"criteria":["1 个完整的 Agent 生命周期章节文档创建","文档包含全部 7 个 SOP 模块","OOM 幽灵叙事线索延续"],"verification":"ls docs/deep-study/part5-execution-layer/09-agent-lifecycle.md && wc -l docs/deep-study/part5-execution-layer/09-agent-lifecycle.md | awk '$1 > 800'"},"commit":{"type":"docs","scope":"deep-study","message_template":"docs(deep-study): add Chapter 9 Agent lifecycle analysis"},"depends_on":[],"priority":"high"},{"id":"T2","title":"分析 Agent 调用机制","scope":"docs/deep-study/part5-execution-layer","action":"Implement","description":"在 Chapter 9 中详细分析 Agent 的调用机制，包括 HTTP vs 函数调用、prompt 字段构建流程","files":[{"path":"docs/deep-study/part5-execution-layer/09-agent-lifecycle.md","action":"modify","change":"添加 Agent 调用机制的深度分析内容"}],"implementation":["分析 Agent 调用模式：Claude Code 直接加载 .md 文件作为 agent 定义","解析 YAML frontmatter：name, description, color 字段的作用","分析 prompt 字段构建：Markdown 内容如何被注入到 Claude 对话","绘制 Agent 调用流程：Skill → Agent Selection → Prompt Injection → Tool Binding → Execution","分析工具绑定关系：Agent 如何获得 Read/Write/Edit/Bash 等工具的访问权限","分析超时机制：Agent 执行的时间限制和中断处理"],"test":{"unit":["验证调用机制分析准确覆盖 cli-execution-agent, code-developer, cli-explore-agent, universal-executor 四个核心 Agent"],"commands":[]},"convergence":{"criteria":["Agent 调用流程图完整","prompt 字段构建机制说明清晰","工具绑定关系解析准确"],"verification":"grep -c 'Agent 调用' docs/deep-study/part5-execution-layer/09-agent-lifecycle.md"},"depends_on":["T1"],"priority":"high"},{"id":"T3","title":"分析 Agent 生命周期阶段","scope":"docs/deep-study/part5-execution-layer","action":"Implement","description":"在 Chapter 9 中详细分析 Agent 的完整生命周期：实例化 → 任务执行 → 结果返回","files":[{"path":"docs/deep-study/part5-execution-layer/09-agent-lifecycle.md","action":"modify","change":"添加 Agent 生命周期阶段的深度分析"}],"implementation":["分析 Agent 实例化阶段：.md 文件加载、frontmatter 解析、系统提示注入","分析任务执行阶段：意图理解、上下文收集、工具调用、结果生成","分析结果返回阶段：输出格式化、会话日志记录、状态更新","绘制生命周期时序图：展示各阶段的时间消耗","分析内存行为：各阶段的内存分配和释放模式","关联 OOM 幽灵线索：Agent 执行中的内存累积点"],"test":{"unit":["验证生命周期分析覆盖 cli-execution-agent 的 5 阶段执行流程"],"commands":[]},"convergence":{"criteria":["生命周期阶段定义清晰","时序图展示各阶段关系","内存行为分析与 OOM 幽灵关联"],"verification":"grep -c '生命周期' docs/deep-study/part5-execution-layer/09-agent-lifecycle.md"},"depends_on":["T2"],"priority":"high"},{"id":"T4","title":"分析超时和重试机制","scope":"docs/deep-study/part5-execution-layer","action":"Implement","description":"在 Chapter 9 中详细分析 Agent 执行的超时和重试机制","files":[{"path":"docs/deep-study/part5-execution-layer/09-agent-lifecycle.md","action":"modify","change":"添加超时和重试机制的深度分析"}],"implementation":["分析超时配置：Simple 20min | Medium 40min | Complex 60min (Codex x1.5)","分析 CLI 调用的 Bash Tool 配置：run_in_background=false 确保前台执行","分析 fallback 链：Gemini → Qwen → Codex → Bash-only","分析错误处理策略：Gemini 429 处理、MCP Exa 不可用时的本地搜索回退","分析超时后的部分结果收集和中间状态保存","关联 8s 延迟线索：超时配置与实际执行时间的差距"],"test":{"unit":["验证超时机制分析覆盖所有 CLI 工具的执行模式"],"commands":[]},"convergence":{"criteria":["超时配置分级说明清晰","fallback 链完整","错误处理策略详尽"],"verification":"grep -c '超时' docs/deep-study/part5-execution-layer/09-agent-lifecycle.md"},"depends_on":["T3"],"priority":"medium"},{"id":"T5","title":"撰写 Agent 类型分类表","scope":"docs/deep-study/part5-execution-layer","action":"Implement","description":"在 Chapter 9 中创建 Agent 类型分类表，整理 21 个 Agent 的功能和职责","files":[{"path":"docs/deep-study/part5-execution-layer/09-agent-lifecycle.md","action":"modify","change":"添加 Agent 类型分类表"}],"implementation":["按功能分类：Execution Agents, Planning Agents, Explore Agents, Utility Agents","列出每类 Agent 的名称、描述、主要职责","标注高频调用 Agent：cli-execution-agent, code-developer, universal-executor","标注中频调用 Agent：cli-explore-agent, action-planning-agent","标注低频/专用 Agent：tdd-developer, ui-design-agent, memory-bridge","分析各类 Agent 的内存占用模式和调用频率"],"test":{"unit":["验证分类表包含全部 21 个 Agent"],"commands":[]},"convergence":{"criteria":["分类表包含 21 个 Agent","分类逻辑清晰","内存占用模式标注"],"verification":"grep -c '\\|.*agent\\|' docs/deep-study/part5-execution-layer/09-agent-lifecycle.md"},"depends_on":["T1"],"priority":"medium"},{"id":"T6","title":"关联 OOM 幽灵叙事线","scope":"docs/deep-study/part5-execution-layer","action":"Implement","description":"在 Chapter 9 中延续 OOM 幽灵叙事，分析 Agent 执行中的内存累积","files":[{"path":"docs/deep-study/part5-execution-layer/09-agent-lifecycle.md","action":"modify","change":"添加 OOM 幽灵叙事关联内容"}],"implementation":["更新调查进度条：从 35% 推进到 45%","分析 Agent 上下文注入的内存开销：context-package.json 加载","分析 Agent 工具调用的内存累积：多次 Read/CLI 调用","分析 Agent 结果输出的内存占用：会话日志、summary 文件","计算本章新增的内存债务：估计 +180MB","更新幽灵位置：执行层 (Agent 系统的内存行为)","添加幽灵旁白：Agent 执行中的'慢性内存泄漏'"],"test":{"unit":["验证 OOM 叙事线索与前面章节连贯"],"commands":[]},"convergence":{"criteria":["调查进度更新到 45%","内存债务计算准确","幽灵旁白与主题相关"],"verification":"grep '调查进度.*45%' docs/deep-study/part5-execution-layer/09-agent-lifecycle.md"},"depends_on":["T4","T5"],"priority":"medium"}],"is_bound":true,"bound_at":"2026-02-17T14:10:54.347Z"}
