# Requirement (non-leaky): /workflow:start

## Source

- Command doc (oracle, do not paste full contents into spec): `.claude/commands/workflow/session/start.md`

## Command Identity

- group: workflow
- name: start
- description: Discover existing sessions or start new workflow session with intelligent session management and conflict detection
- argument-hint: [--type <workflow|review|tdd|test|docs>] [--auto|--new] [optional: task description for new session]
- allowed-tools: TBD

## Structure Hints (Headings Only)

- Start Workflow Session (/workflow:session:start)
  - Overview
  - Session Types
  - Step 0: Initialize Project State (First-time Only)
    - Check and Initialize
- Check if project state exists (both files required)
  - Mode 1: Discovery Mode (Default)
    - Usage
    - Step 1: List Active Sessions
    - Step 2: Display Session Metadata
    - Step 4: User Decision
  - Mode 2: Auto Mode (Intelligent)
    - Usage
    - Step 1: Check Active Sessions Count
    - Step 2a: No Active Sessions → Create New
- Generate session slug
- Create directory structure
- Create metadata (include type field, default to "workflow" if not specified)
    - Step 2b: Single Active Session → Check Relevance
- Extract session ID
- Read project name from metadata
- Check keyword match (manual comparison)
- If task contains project keywords → Reuse session
- If task unrelated → Create new session (use Step 2a)
    - Step 2c: Multiple Active Sessions → Use First
- Get first active session
- Output warning and session ID
- WARNING: Multiple active sessions detected
- SESSION_ID: WFS-first-session
  - Mode 3: Force New Mode
    - Usage
    - Step 1: Generate Unique Session Slug
- Convert to slug
- Check if exists, add counter if needed
    - Step 2: Create Session Structure
    - Step 3: Create Metadata
- Include type field from --type parameter (default: "workflow")
  - Execution Guideline
  - Output Format Specification
    - Success
    - Error
    - Analysis (Auto Mode)
  - Session ID Format

## Hard Constraints (P0)

- Do not claim a pointer is `Existing` unless it is verifiable in the repo now.
- Evidence must be dual-source: docs (.claude/commands/**.md) + ts (ccw/src/**).
- If unsure, mark as `Planned` and add a concrete `Verify` step.
