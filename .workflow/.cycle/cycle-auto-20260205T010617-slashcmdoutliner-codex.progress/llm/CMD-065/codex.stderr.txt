Reading prompt from stdin...
OpenAI Codex v0.93.0 (research preview)
--------
workdir: C:\Project\Claude-Code-Workflow
model: gpt-5.2
provider: codex
approval: never
sandbox: danger-full-access
reasoning effort: high
reasoning summaries: auto
session id: 019c2d64-4f92-7291-b871-4b10e2fe9d27
--------
user
Use the repo skill: slash-command-outliner (path: .codex/skills/slash-command-outliner).

Cycle: cycle-auto-20260205T010617-slashcmdoutliner-codex
Command: CMD-065

Input requirement doc (non-leaky): `.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/requirements/CMD-065.requirements.md`

Write the following output files (create directories as needed) under `.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs`:
- `.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/spec.json`
- `.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/references.json`
- `.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-slash-outline.md`
- `.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-agent-outline.md`
- `.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/gap-report.md`
- `.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/fix-plan.md`

Hard rules (P0):
- Follow templates: .codex/skills/slash-command-outliner/templates/*
- Follow gates: .codex/skills/slash-command-outliner/specs/quality-gates.md
- Evidence tables MUST pass: node .codex/skills/slash-command-outliner/scripts/verify-evidence.js
- Never label a pointer as Existing unless it is verifiable in the repo now.
- For ANY pointer row, provide dual-source evidence:
  - docs: .claude/commands/**.md / <real heading text>
  - ts: ccw/src/** / <literal anchor string present in file>
- Avoid placeholders like TBD/N/A in evidence rows; if unsure, mark as Planned and add Verify steps.

Keep the written files concise; do not write extra files unless necessary.

deprecated: `[features].web_search_request` is deprecated. Use `web_search` instead.
  Set `web_search` to `"live"`, `"cached"`, or `"disabled"` in config.toml.
mcp: ace-tool starting
mcp: ccw-tools starting
mcp: exa starting
mcp: ccw-tools ready
mcp: ace-tool ready
mcp: exa ready
mcp startup: ready: ccw-tools, ace-tool, exa
exec
"C:\\Program Files\\PowerShell\\7\\pwsh.exe" -Command '[Console]::InputEncoding  = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
Get-Content -Raw .codex/skills/slash-command-outliner/SKILL.md' in C:\Project\Claude-Code-Workflow succeeded in 316ms:
---
name: slash-command-outliner
description: Codex version of slash-command-outliner. Generate CCW-aligned slash command development outlines from a requirement/spec doc, validated via corpus-wide iteration and non-regression. Triggers on "slash command outliner", "slash å‘½ä»¤å¤§çº²", "slash å‘½ä»¤ç”Ÿæˆå™¨", "å‘½ä»¤å¤§çº²".
allowed-tools: Read, Write, AskUserQuestion, Task, Bash, TodoWrite, mcp__ace-tool__search_context
---

# Slash Command Outliner (Codex)

Input a **slash command requirement/spec document**. Output a **CCW-aligned, end-to-end development outline** (Slash MD outline + Agent MD outline) plus a **gap-report** that compares against reference implementations and CCW server/tooling corpus. Improve quality by iterating across **all** existing commands with **non-regression snapshots**.

This skill is designed to be **precise** (no fluff) and **stable** (non-regression gate).

## Canonical Workflow (Phases)

1) `phases/01-collect-spec.md`  
2) `phases/02-retrieve-and-rank-references.md`  
3) `phases/03-generate-outlines.md`  
4) `phases/04-gap-report-and-iterate.md`  
5) `phases/05-regression-and-closure.md`

exec
"C:\\Program Files\\PowerShell\\7\\pwsh.exe" -Command '[Console]::InputEncoding  = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
Get-Content -Raw .codex/skills/slash-command-outliner/phases/01-collect-spec.md' in C:\Project\Claude-Code-Workflow succeeded in 304ms:
# Phase 01: Collect Spec (No Leakage)

## Goal

Turn a human requirement/rules document into a **minimal, structured spec** that is sufficient to generate:

- Slash command outline (CCW command MD skeleton)
- Agent outline (execution + tools + state)

Do **not** copy/paste existing implementation docs as input; treat them as oracle only during gap analysis.

## Required Inputs (ask if missing)

1. Command identity:
   - `group` (workflow|issue|learn|cli|other)
   - `name` (kebab-case)
   - `description` (one sentence)
   - `argument-hint` (optional)
2. Allowed tools:
   - exact list for frontmatter `allowed-tools`
exec
"C:\\Program Files\\PowerShell\\7\\pwsh.exe" -Command '[Console]::InputEncoding  = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
Get-Content -Raw .codex/skills/slash-command-outliner/phases/02-retrieve-and-rank-references.md' in C:\Project\Claude-Code-Workflow succeeded in 305ms:
# Phase 02: Retrieve + Rank References

## Goal

Find the closest existing commands and extract **reusable patterns** without copying full content.

## Steps

1) Use `mcp__ace-tool__search_context` to recall similar commands and relevant tooling code.
2) Produce Top N candidates (default N=5) with deterministic scoring:
   - same `group` / command family
   - similar interaction model (AskUserQuestion, multi-round loop, etc.)
   - similar artifacts (writes to `.workflow/*`, `.claude/*`, etc.)
   - similar allowed-tools surface
3) Require user confirmation for Top 1 (high-confidence can be preselected but must be overridable).

## Output

Write:
- `specs/outputs/references.json`
exec
"C:\\Program Files\\PowerShell\\7\\pwsh.exe" -Command '[Console]::InputEncoding  = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
Get-Content -Raw .codex/skills/slash-command-outliner/phases/03-generate-outlines.md' in C:\Project\Claude-Code-Workflow succeeded in 309ms:
# Phase 03: Generate Outlines (Slash MD + Agent MD)

## Goal

Generate:
- a **Slash command MD outline** that matches CCW conventions (frontmatter + required sections)
- an **Agent outline** that explains execution model, state, and validation strategy

Use templates; keep output concise and implementation-oriented.

## Inputs

- `specs/outputs/spec.json`
- `specs/outputs/references.json` (selected reference)
- Rules: `../specs/quality-gates.md`

## Output Files

- `specs/outputs/generated-slash-outline.md` (based on `../templates/slash-command-outline.md`)
- `specs/outputs/generated-agent-outline.md` (based on `../templates/agent-outline.md`)
exec
"C:\\Program Files\\PowerShell\\7\\pwsh.exe" -Command '[Console]::InputEncoding  = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
Get-Content -Raw .codex/skills/slash-command-outliner/phases/04-gap-report-and-iterate.md' in C:\Project\Claude-Code-Workflow succeeded in 322ms:
# Phase 04: Gap Report + Iterate

## Goal

Compare the generated outlines against:
1) The selected reference command implementation (oracle)
2) The CCW server/tooling corpus (routes, mcp tools, cli internals)

Then propose the smallest set of changes to close gaps.

## Inputs

- `specs/outputs/generated-slash-outline.md`
- `specs/outputs/generated-agent-outline.md`
- `specs/outputs/references.json`
- Tooling scope: `../specs/corpus-scope.md`

## Output

Write:
exec
"C:\\Program Files\\PowerShell\\7\\pwsh.exe" -Command '[Console]::InputEncoding  = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
Get-Content -Raw .codex/skills/slash-command-outliner/phases/05-regression-and-closure.md' in C:\Project\Claude-Code-Workflow succeeded in 303ms:
# Phase 05: Regression + Closure

## Goal

Make sure improvements do not regress previously-validated commands (non-regression).

## What to Update (Cycle Mode)

When iterating against the full corpus:
- Update per-command status in `corpus-manifest.json`
- Check off `TODO_LIST.md` items
- Save snapshots in `regression/expected/` for commands marked completed
- Write snapshot diffs into `regression/diff/` and block on unexpected changes

## Non-regression Policy

See `../specs/quality-gates.md`.

## Completion Criteria

exec
"C:\\Program Files\\PowerShell\\7\\pwsh.exe" -Command '[Console]::InputEncoding  = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
Get-Content -Raw .codex/skills/slash-command-outliner/templates/slash-command-outline.md' in C:\Project\Claude-Code-Workflow succeeded in 300ms:
---
name: {{command.name}}
description: {{command.description}}
argument-hint: "{{command.argument_hint}}"
allowed-tools: {{command.allowed_tools_csv}}
group: {{command.group}}
---

# {{command.title}}

## Overview

- Goal: {{intent.primary_user_value}}
- Command: `/{{command.group}}:{{command.name}}`

## Usage

```bash
/{{command.group}}:{{command.name}} {{command.usage_args}}
```
exec
"C:\\Program Files\\PowerShell\\7\\pwsh.exe" -Command '[Console]::InputEncoding  = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
Get-Content -Raw .codex/skills/slash-command-outliner/templates/agent-outline.md' in C:\Project\Claude-Code-Workflow succeeded in 318ms:
# Agent Outline: {{command.group}}:{{command.name}}

## Purpose

Implement and/or evolve the slash command according to CCW conventions with minimal regressions.

## Execution Model

- Default: incremental, testable changes
- Use ACE-tool to find existing patterns before adding new abstractions

## State & Artifacts

- Session folder (if used): `.workflow/...`
- Required outputs:
  - Slash MD (command doc)
  - Any scripts/modules referenced by the command
  - Validation notes / regression snapshots

## Tooling
exec
"C:\\Program Files\\PowerShell\\7\\pwsh.exe" -Command '[Console]::InputEncoding  = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
Get-Content -Raw .codex/skills/slash-command-outliner/templates/gap-report.md' in C:\Project\Claude-Code-Workflow succeeded in 309ms:
# Gap Report: {{command.group}}:{{command.name}}

## Reference

- Selected reference: {{reference.slash}} (`{{reference.file_path}}`)

## P0 Gaps (Must Fix)

{{gaps.p0}}

## P1 Gaps (Should Fix)

{{gaps.p1}}

## P2 Gaps (Optional)

{{gaps.p2}}

## Implementation Pointers (Evidence)

exec
"C:\\Program Files\\PowerShell\\7\\pwsh.exe" -Command '[Console]::InputEncoding  = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
Get-Content -Raw .codex/skills/slash-command-outliner/specs/quality-gates.md' in C:\Project\Claude-Code-Workflow succeeded in 320ms:
# Quality Gates (Non-regression First)

## P0 Gates (Must Pass)

P0 failure means â€œnot CCW-alignedâ€ and blocks completion.

1) **Frontmatter completeness**
   - `name`, `description`, `allowed-tools` must exist
   - `argument-hint` optional but recommended for non-trivial commands
2) **Allowed-tools correctness**
   - no tools outside the supported CCW set for the intended workflow
   - no missing tools required by the described behavior
3) **Core sections present**
   - at least: `Overview`, `Usage`, `Execution Process`, `Output/Artifacts`, `Error Handling`
4) **No broken artifact references**
   - referenced paths must be either created by the command or explicitly documented as pre-existing

5) **Implementation pointers must be evidence-based (Existing vs Planned)**
   - Every implementation pointer (file/module/CLI subcommand/tool entry) MUST be labeled:
     - `Existing`: verifiable in repo now
exec
"C:\\Program Files\\PowerShell\\7\\pwsh.exe" -Command '[Console]::InputEncoding  = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
Get-Content -Raw .workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/requirements/CMD-065.requirements.md' in C:\Project\Claude-Code-Workflow succeeded in 338ms:
# Requirement (non-leaky): /workflow:test-context-gather

## Source

- Command doc (oracle, do not paste full contents into spec): `.claude/commands/workflow/tools/test-context-gather.md`

## Command Identity

- group: workflow
- name: test-context-gather
- description: Collect test coverage context using test-context-search-agent and package into standardized test-context JSON
- argument-hint: --session WFS-test-session-id
- allowed-tools: Task(*), Read(*), Glob(*)

## Structure Hints (Headings Only)

- Test Context Gather Command (/workflow:tools:test-context-gather)
  - Overview
  - Core Philosophy
  - Execution Process
exec
"C:\\Program Files\\PowerShell\\7\\pwsh.exe" -Command '[Console]::InputEncoding  = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
Get-ChildItem -Recurse -File .claude/commands/workflow | Select-Object FullName' in C:\Project\Claude-Code-Workflow succeeded in 341ms:

[32;1mFullName[0m
[32;1m--------[0m
C:\Project\Claude-Code-Workflow\.claude\commands\workflow\analyze-with-file.md
C:\Project\Claude-Code-Workflow\.claude\commands\workflow\brainstorm-with-file.md
C:\Project\Claude-Code-Workflow\.claude\commands\workflow\clean.md
C:\Project\Claude-Code-Workflow\.claude\commands\workflow\collaborative-plan-with-file.md
C:\Project\Claude-Code-Workflow\.claude\commands\workflow\debug-with-file.md
C:\Project\Claude-Code-Workflow\.claude\commands\workflow\execute.md
C:\Project\Claude-Code-Workflow\.claude\commands\workflow\init-guidelines.md
C:\Project\Claude-Code-Workflow\.claude\commands\workflow\init.md
C:\Project\Claude-Code-Workflow\.claude\commands\workflow\lite-execute.md
C:\Project\Claude-Code-Workflow\.claude\commands\workflow\lite-fix.md
C:\Project\Claude-Code-Workflow\.claude\commands\workflow\lite-plan.md
C:\Project\Claude-Code-Workflow\.claude\commands\workflow\multi-cli-plan.md
C:\Project\Claude-Code-Workflow\.claude\commands\workflow\plan-verify.md
C:\Project\Claude-Code-Workflow\.claude\commands\workflow\plan.md
C:\Project\Claude-Code-Workflow\.claude\commands\workflow\replan.md
C:\Project\Claude-Code-Workflow\.claude\commands\workflow\review-cycle-fix.md
C:\Project\Claude-Code-Workflow\.claude\commands\workflow\review-module-cycle.md
exec
"C:\\Program Files\\PowerShell\\7\\pwsh.exe" -Command '[Console]::InputEncoding  = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
Get-Content -TotalCount 40 .claude/commands/workflow/tools/context-gather.md' in C:\Project\Claude-Code-Workflow succeeded in 311ms:
---
name: gather
description: Intelligently collect project context using context-search-agent based on task description, packages into standardized JSON
argument-hint: "--session WFS-session-id \"task description\""
examples:
  - /workflow:tools:context-gather --session WFS-user-auth "Implement user authentication system"
  - /workflow:tools:context-gather --session WFS-payment "Refactor payment module API"
  - /workflow:tools:context-gather --session WFS-bugfix "Fix login validation error"
allowed-tools: Task(*), Read(*), Glob(*)
---

# Context Gather Command (/workflow:tools:context-gather)

## Overview

Orchestrator command that invokes `context-search-agent` to gather comprehensive project context for implementation planning. Generates standardized `context-package.json` with codebase analysis, dependencies, and conflict detection.


## Core Philosophy

exec
"C:\\Program Files\\PowerShell\\7\\pwsh.exe" -Command '[Console]::InputEncoding  = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
Get-Content -TotalCount 60 .claude/commands/workflow/tools/test-context-gather.md' in C:\Project\Claude-Code-Workflow succeeded in 328ms:
---
name: test-context-gather
description: Collect test coverage context using test-context-search-agent and package into standardized test-context JSON
argument-hint: "--session WFS-test-session-id"
examples:
  - /workflow:tools:test-context-gather --session WFS-test-auth
  - /workflow:tools:test-context-gather --session WFS-test-payment
allowed-tools: Task(*), Read(*), Glob(*)
---

# Test Context Gather Command (/workflow:tools:test-context-gather)

## Overview

Orchestrator command that invokes `test-context-search-agent` to gather comprehensive test coverage context for test generation workflows. Generates standardized `test-context-package.json` with coverage analysis, framework detection, and source implementation context.



## Core Philosophy

exec
"C:\\Program Files\\PowerShell\\7\\pwsh.exe" -Command '[Console]::InputEncoding  = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
Get-Content -TotalCount 20 .claude/commands/workflow/session/start.md' in C:\Project\Claude-Code-Workflow succeeded in 318ms:
---
name: start
description: Discover existing sessions or start new workflow session with intelligent session management and conflict detection
argument-hint: [--type <workflow|review|tdd|test|docs>] [--auto|--new] [optional: task description for new session]
examples:
  - /workflow:session:start
  - /workflow:session:start --auto "implement OAuth2 authentication"
  - /workflow:session:start --type review "Code review for auth module"
  - /workflow:session:start --type tdd --auto "implement user authentication"
  - /workflow:session:start --type test --new "test payment flow"
---

# Start Workflow Session (/workflow:session:start)

## Overview
Manages workflow sessions with three operation modes: discovery (manual), auto (intelligent), and force-new.

**Dual Responsibility**:
1. **Project-level initialization** (first-time only): Creates `.workflow/project-tech.json` for feature registry
2. **Session-level initialization** (always): Creates session directory structure
tool ace-tool.search_context({"project_root_path":"C:/Project/Claude-Code-Workflow","query":"Find the implementation of the /workflow:tools:test-context-gather slash command and the test-context-search-agent it invokes. Keywords: test-context-gather, test-context-search-agent, test-context-package.json, workflow tools command handler."})
ace-tool.search_context({"project_root_path":"C:/Project/Claude-Code-Workflow","query":"Find the implementation of the /workflow:tools:test-context-gather slash command and the test-context-search-agent it invokes. Keywords: test-context-gather, test-context-search-agent, test-context-package.json, workflow tools command handler."}) success in 5.43s:
{
  "content": [
    {
      "text": "The following code sections were retrieved:\nPath: .claude\\commands\\workflow\\tools\\context-gather.md\n     1\t---\r\n     2\tname: gather\r\n     3\tdescription: Intelligently collect project context using context-search-agent based on task description, packages into standardized JSON\r\n     4\targument-hint: \"--session WFS-session-id \\\"task description\\\"\"\r\n     5\texamples:\r\n     6\t  - /workflow:tools:context-gather --session WFS-user-auth \"Implement user authentication system\"\r\n     7\t  - /workflow:tools:context-gather --session WFS-payment \"Refactor payment module API\"\r\n     8\t  - /workflow:tools:context-gather --session WFS-bugfix \"Fix login validation error\"\r\n     9\tallowed-tools: Task(*), Read(*), Glob(*)\r\n    10\t---\r\n    11\t\r\n    12\t# Context Gather Command (/workflow:tools:context-gather)\r\n    13\t\r\n    14\t## Overview\r\n    15\t\r\n    16\tOrchestrator command that invokes `context-search-agent` to gather comprehensive project context for implementation planning. Generates standardized `context-package.json` with codebase analysis, dependencies, and conflict detection.\r\n    17\t\r\n    18\t\r\n    19\t## Core Philosophy\r\n    20\t\r\n    21\t- **Agent Delegation**: Delegate all discovery to `context-search-agent` for autonomous execution\r\n    22\t- **Detection-First**: Check for existing context-package before executing\r\n    23\t- **Plan Mode**: Full comprehensive analysis (vs lightweight brainstorm mode)\r\n    24\t- **Standardized Output**: Generate `.workflow/active/{session}/.process/context-package.json`\r\n    25\t\r\n    26\t## Execution Process\r\n    27\t\r\n    28\t```\r\n    29\tInput Parsing:\r\n    30\t   â”œâ”€ Parse flags: --session\r\n    31\t   â””â”€ Parse: task_description (required)\r\n...\n    44\t\r\n    45\tStep 3: Invoke Context-Search Agent (with exploration input)\r\n    46\t   â”œâ”€ Phase 1: Initialization & Pre-Analysis\r\n    47\t   â”œâ”€ Phase 2: Multi-Source Discovery\r\n    48\t   â”‚  â”œâ”€ Track 0: Exploration Synthesis (prioritize & deduplicate)\r\n    49\t   â”‚  â”œâ”€ Track 1-4: Existing tracks\r\n    50\t   â””â”€ Phase 3: Synthesis & Packaging\r\n    51\t      â””â”€ Generate context-package.json with exploration_results\r\n    52\t\r\n    53\tStep 4: Output Verification\r\n    54\t   â””â”€ Verify context-package.json contains exploration_results\r\n    55\t```\r\n...\n   114\t\r\n   115\tconst complexity = analyzeTaskComplexity(task_description);\r\n   116\tconst selectedAngles = selectAngles(task_description, complexity);\r\n   117\tconst sessionFolder = `.workflow/active/${session_id}/.process`;\r\n   118\t\r\n   119\t// 2.2 Launch Parallel Explore Agents\r\n   120\tconst explorationTasks = selectedAngles.map((angle, index) =>\r\n   121\t  Task(\r\n   122\t    subagent_type=\"cli-explore-agent\",\r\n   123\t    run_in_background=false,\r\n   124\t    description=`Explore: ${angle}`,\r\n   125\t    prompt=`\r\n   126\t## Task Objective\r\n   127\tExecute **${angle}** exploration for task planning context. Analyze codebase from this specific angle to discover relevant structure, patterns, and constraints.\r\n...\n   193\t\r\n   194\t// 2.3 Generate Manifest after all complete\r\n   195\tconst explorationFiles = bash(`find ${sessionFolder} -name \"exploration-*.json\" -type f`).split('\\n').filter(f => f.trim());\r\n   196\tconst explorationManifest = {\r\n   197\t  session_id,\r\n   198\t  task_description,\r\n   199\t  timestamp: new Date().toISOString(),\r\n   200\t  complexity,\r\n   201\t  exploration_count: selectedAngles.length,\r\n   202\t  angles_explored: selectedAngles,\r\n   203\t  explorations: explorationFiles.map(file => {\r\n   204\t    const data = JSON.parse(Read(file));\r\n   205\t    return { angle: data._metadata.exploration_angle, file: file.split('/').pop(), path: file, index: data._metadata.exploration_index };\r\n   206\t  })\r\n   207\t};\r\n   208\tWrite(`${sessionFolder}/explorations-manifest.json`, JSON.stringify(explorationManifest, null, 2));\r\n   209\t```\r\n   210\t\r\n   211\t### Step 3: Invoke Context-Search Agent\r\n   212\t\r\n   213\t**Only execute after Step 2 completes**\r\n   214\t\r\n   215\t```javascript\r\n   216\t// Load user intent from planning-notes.md (from Phase 1)\r\n   217\tconst planningNotesPath = `.workflow/active/${session_id}/planning-notes.md`;\r\n   218\tlet userIntent = { goal: task_description, key_constraints: \"None specified\" };\r\n...\n   227\t\r\n   228\tTask(\r\n   229\t  subagent_type=\"context-search-agent\",\r\n   230\t  run_in_background=false,\r\n   231\t  description=\"Gather comprehensive context for plan\",\r\n   232\t  prompt=`\r\n   233\t## Execution Mode\r\n   234\t**PLAN MODE** (Comprehensive) - Full Phase 1-3 execution with priority sorting\r\n   235\t\r\n   236\t## Session Information\r\n   237\t- **Session ID**: ${session_id}\r\n   238\t- **Task Description**: ${task_description}\r\n   239\t- **Output Path**: .workflow/${session_id}/.process/context-package.json\r\n   240\t\r\n   241\t## User Intent (from Phase 1 - Planning Notes)\r\n   242\t**GOAL**: ${userIntent.goal}\r\n   243\t**KEY_CONSTRAINTS**: ${userIntent.key_constraints}\r\n   244\t\r\n   245\tThis is the PRIMARY context source - all subsequent analysis must align with user intent.\r\n...\n   272\t\r\n   273\t- **Track 0**: Exploration Synthesis (load ${sessionFolder}/explorations-manifest.json, prioritize critical_files, deduplicate patterns/integration_points)\r\n   274\t- **Track 1**: Historical archive analysis (query manifest.json for lessons learned)\r\n   275\t- **Track 2**: Reference documentation (CLAUDE.md, architecture docs)\r\n   276\t- **Track 3**: Web examples (use Exa MCP for unfamiliar tech/APIs)\r\n   277\t- **Track 4**: Codebase analysis (5-layer discovery: files, content, patterns, deps, config/tests)\r\n...\n   369\t\r\n   370\t// Verify exploration_results included\r\n   371\tconst pkg = JSON.parse(Read(outputPath));\r\n   372\tif (pkg.exploration_results?.exploration_count > 0) {\r\n   373\t  console.log(`âœ… Exploration results aggregated: ${pkg.exploration_results.exploration_count} angles`);\r\n   374\t}\r\n   375\t```\r\n   376\t\r\n   377\t## Parameter Reference\r\n   378\t\r\n   379\t| Parameter | Type | Required | Description |\r\n   380\t|-----------|------|----------|-------------|\r\n   381\t| `--session` | string | âœ… | Workflow session ID (e.g., WFS-user-auth) |\r\n   382\t| `task_description` | string | âœ… | Detailed task description for context extraction |\r\n   383\t\r\n   384\t## Output Schema\r\n   385\t\r\n   386\tRefer to `context-search-agent.md` Phase 3.7 for complete `context-package.json` schema.\r\n...\n   397\t- **prioritized_context**: Pre-sorted context with user intent and priority tiers (critical/high/medium/low)\r\n   398\t\r\n   399\t## Notes\r\n   400\t\r\n   401\t- **Detection-first**: Always check for existing package before invoking agent\r\n   402\t- **User intent integration**: Load user intent from planning-notes.md (Phase 1 output)\r\n   403\t- **Output**: Generates `context-package.json` with `prioritized_context` field\r\n   404\t- **Plan-specific**: Use this for implementation planning; brainstorm mode uses direct agent call\r\n...\n\nPath: .claude\\commands\\workflow\\test-fix-gen.md\n...\n   137\t\r\n   138\t### Phase 2: Gather Test Context\r\n   139\t\r\n   140\t**Step 2.1: Execute** - Gather context based on mode\r\n   141\t\r\n   142\t```\r\n   143\t// Session Mode - gather from source session\r\n   144\tSkill(skill=\"workflow:tools:test-context-gather\", args=\"--session [testSessionId]\")\r\n   145\t\r\n   146\t// Prompt Mode - gather from codebase\r\n   147\tSkill(skill=\"workflow:tools:context-gather\", args=\"--session [testSessionId] \\\"[task_description]\\\"\")\r\n   148\t```\r\n   149\t\r\n   150\t**Input**: `testSessionId` from Phase 1\r\n   151\t\r\n   152\t**Parse Output**:\r\n   153\t- Extract: context package path (store as `contextPath`)\r\n   154\t- Pattern: `.workflow/active/[testSessionId]/.process/[test-]context-package.json`\r\n   155\t\r\n   156\t**Validation**:\r\n   157\t- Context package file exists and is valid JSON\r\n   158\t- Contains coverage analysis (session mode) or codebase analysis (prompt mode)\r\n   159\t- Test framework detected\r\n...\n\nPath: .claude\\commands\\workflow\\tools\\test-task-generate.md\n...\n    62\t\r\n    63\t---\r\n    64\t\r\n    65\t## Phase 1: Context Preparation\r\n    66\t\r\n    67\t**Purpose**: Assemble test session paths, load test analysis context, and create test-planning-notes.md.\r\n    68\t\r\n    69\t**Execution Steps**:\r\n    70\t1. Parse `--session` flag to get test session ID\r\n    71\t2. Load `workflow-session.json` for session metadata\r\n    72\t3. Verify `TEST_ANALYSIS_RESULTS.md` exists (from test-concept-enhanced)\r\n    73\t4. Load `test-context-package.json` for coverage data\r\n    74\t5. Create `test-planning-notes.md` with initial context\r\n    75\t\r\n    76\t**After Phase 1**: Initialize test-planning-notes.md\r\n    77\t\r\n    78\t```javascript\r\n    79\t// Create test-planning-notes.md with N+1 context support\r\n    80\tconst testPlanningNotesPath = `.workflow/active/${testSessionId}/test-planning-notes.md`\r\n    81\tconst sessionMetadata = JSON.parse(Read(`.workflow/active/${testSessionId}/workflow-session.json`))\r\n    82\tconst testAnalysis = Read(`.workflow/active/${testSessionId}/.process/TEST_ANALYSIS_RESULTS.md`)\r\n    83\tconst sourceSessionId = sessionMetadata.source_session_id || 'N/A'\r\n    84\t\r\n    85\t// Extract key info from TEST_ANALYSIS_RESULTS.md\r\n    86\tconst projectType = testAnalysis.match(/Project Type:\\s*(.+)/)?.[1] || 'Unknown'\r\n    87\tconst testFramework = testAnalysis.match(/Test Framework:\\s*(.+)/)?.[1] || 'Unknown'\r\n    88\tconst coverageTarget = testAnalysis.match(/Coverage Target:\\s*(.+)/)?.[1] || '80%'\r\n...\n   233\t\r\n   234\tconst currentNotes = Read(testPlanningNotesPath)\r\n   235\tconst constraintCount = (currentNotes.match(/^\\d+\\./gm) || []).length\r\n   236\t\r\n   237\tEdit(testPlanningNotesPath, {\r\n   238\t  old: '## Consolidated Test Requirements (Phase 2 Input)',\r\n   239\t  new: `## Consolidated Test Requirements (Phase 2 Input)\r\n   240\t1. [Context] ${testFramework} framework conventions\r\n   241\t2. [Context] ${coverageTarget} coverage target\r\n   242\t${geminiConstraints.map((c, i) => `${i + 3}. ${c}`).join('\\n')}`\r\n   243\t})\r\n   244\t```\r\n   245\t\r\n   246\t---\r\n   247\t\r\n   248\t## Agent Invocation\r\n   249\t\r\n   250\t```javascript\r\n   251\tTask(\r\n   252\t  subagent_type=\"test-action-planning-agent\",\r\n   253\t  run_in_background=false,\r\n   254\t  description=\"Generate test planning documents\",\r\n   255\t  prompt=`\r\n   256\t## TASK OBJECTIVE\r\n   257\tGenerate test planning documents (IMPL_PLAN.md, task JSONs, TODO_LIST.md) for test workflow session\r\n...\n\nPath: .claude\\commands\\workflow\\tools\\test-concept-enhanced.md\n...\n    20\t\r\n    21\t## Core Responsibilities\r\n    22\t- Coordinate test analysis workflow using cli-execution-agent\r\n    23\t- Validate test-context-package.json prerequisites\r\n    24\t- Execute Gemini analysis via agent for test strategy generation\r\n    25\t- Validate agent outputs (gemini-test-analysis.md, TEST_ANALYSIS_RESULTS.md)\r\n    26\t\r\n    27\t## Execution Process\r\n    28\t\r\n    29\t```\r\n    30\tInput Parsing:\r\n    31\t   â”œâ”€ Parse flags: --session, --context\r\n    32\t   â””â”€ Validation: Both REQUIRED\r\n    33\t\r\n    34\tPhase 1: Context Preparation (Command)\r\n    35\t   â”œâ”€ Load workflow-session.json\r\n    36\t   â”œâ”€ Verify test session type is \"test-gen\"\r\n    37\t   â”œâ”€ Validate test-context-package.json\r\n    38\t   â””â”€ Determine strategy (Simple: 1-3 files | Medium: 4-6 | Complex: >6)\r\n    39\t\r\n    40\tPhase 2: Test Analysis Execution (Agent)\r\n    41\t   â”œâ”€ Execute Gemini analysis via cli-execution-agent\r\n    42\t   â””â”€ Generate TEST_ANALYSIS_RESULTS.md\r\n...\n\nPath: .claude\\agents\\test-context-search-agent.md\n     1\t---\r\n     2\tname: test-context-search-agent\r\n     3\tdescription: |\r\n     4\t  Specialized context collector for test generation workflows. Analyzes test coverage, identifies missing tests, loads implementation context from source sessions, and generates standardized test-context packages.\r\n     5\t\r\n     6\t  Examples:\r\n     7\t  - Context: Test session with source session reference\r\n     8\t    user: \"Gather test context for WFS-test-auth session\"\r\n     9\t    assistant: \"I'll load source implementation, analyze test coverage, and generate test-context package\"\r\n    10\t    commentary: Execute autonomous coverage analysis with source context loading\r\n    11\t\r\n    12\t  - Context: Multi-framework detection needed\r\n    13\t    user: \"Collect test context for full-stack project\"\r\n    14\t    assistant: \"I'll detect Jest frontend and pytest backend frameworks, analyze coverage gaps\"\r\n    15\t    commentary: Identify framework patterns and conventions for each stack\r\n    16\tcolor: blue\r\n    17\t---\r\n    18\t\r\n    19\tYou are a test context discovery specialist focused on gathering test coverage information and implementation context for test generation workflows. Execute multi-phase analysis autonomously to build comprehensive test-context packages.\r\n    20\t\r\n    21\t## Core Execution Philosophy\r\n    22\t\r\n    23\t- **Coverage-First Analysis** - Identify existing tests before planning new ones\r\n    24\t- **Source Context Loading** - Import implementation summaries from source sessions\r\n    25\t- **Framework Detection** - Auto-detect test frameworks and conventions\r\n    26\t- **Gap Identification** - Locate implementation files without corresponding tests\r\n    27\t- **Standardized Output** - Generate test-context-package.json\r\n    28\t\r\n    29\t## Tool Arsenal\r\n    30\t\r\n    31\t**Search Tool Priority**: ACE (`mcp__ace-tool__search_context`) â†’ CCW (`mcp__ccw-tools__smart_search`) / Built-in (`Grep`, `Glob`, `Read`)\r\n    32\t\r\n    33\t### 1. Session & Implementation Context\r\n    34\t**Tools**:\r\n    35\t- `Read()` - Load session metadata and implementation summaries\r\n    36\t- `Glob()` - Find session files and summaries\r\n    37\t\r\n    38\t**Use**: Phase 1 source context loading\r\n    39\t\r\n    40\t### 2. Test Coverage Discovery\r\n    41\t**Primary (CCW CodexLens MCP)**:\r\n    42\t- `mcp__ccw-tools__codex_lens(action=\"search_files\", query=\"*.test.*\")` - Find test files\r\n    43\t- `mcp__ccw-tools__codex_lens(action=\"search\", query=\"pattern\")` - Search test patterns\r\n    44\t- `mcp__ccw-tools__codex_lens(action=\"symbol\", file=\"path\")` - Analyze test structure\r\n    45\t\r\n    46\t**Fallback (CLI)**:\r\n    47\t- `rg` (ripgrep) - Fast test pattern search\r\n    48\t- `find` - Test file discovery\r\n    49\t- `Grep` - Framework detection\r\n    50\t\r\n    51\t**Priority**: Code-Index MCP > ripgrep > find > grep\r\n    52\t\r\n    53\t### 3. Framework & Convention Analysis\r\n    54\t**Tools**:\r\n    55\t- `Read()` - Load package.json, requirements.txt, etc.\r\n    56\t- `rg` - Search for framework patterns\r\n    57\t- `Grep` - Fallback pattern matching\r\n    58\t\r\n    59\t## Simplified Execution Process (3 Phases)\r\n...\n   108\t\r\n   109\tfor (const summary_path of summaries) {\r\n   110\t  const content = Read(summary_path);\r\n   111\t  // Parse summary for: task_id, changed_files, implementation_type\r\n   112\t  implementation_context.summaries.push({\r\n   113\t    task_id: extract_task_id(summary_path),\r\n   114\t    summary_path: summary_path,\r\n   115\t    changed_files: extract_changed_files(content),\r\n   116\t    implementation_type: extract_type(content)\r\n   117\t  });\r\n   118\t}\r\n   119\t```\r\n   120\t\r\n   121\t### Phase 2: Test Coverage Analysis\r\n   122\t\r\n   123\t**2.1 Existing Test Discovery**:\r\n   124\t```javascript\r\n   125\t// Method 1: CodexLens MCP (preferred)\r\n   126\tconst test_files = mcp__ccw-tools__codex_lens({\r\n   127\t  action: \"search_files\",\r\n   128\t  query: \"*.test.* OR *.spec.* OR test_*.py OR *_test.go\"\r\n   129\t});\r\n...\n   189\t\r\n   190\t// 3. Build framework metadata\r\n   191\tconst test_framework = {\r\n   192\t  framework: framework_config.name,        // jest, mocha, pytest, etc.\r\n   193\t  version: framework_config.version,\r\n   194\t  test_pattern: determine_test_pattern(),  // **/*.test.ts\r\n   195\t  test_directory: determine_test_dir(),    // tests/, __tests__\r\n   196\t  assertion_library: detect_assertion(),   // expect, assert, should\r\n   197\t  mocking_framework: detect_mocking(),     // jest, sinon, unittest.mock\r\n   198\t  conventions: {\r\n   199\t    file_naming: conventions.file_naming,\r\n   200\t    test_structure: conventions.structure,\r\n   201\t    setup_teardown: conventions.lifecycle\r\n   202\t  }\r\n   203\t};\r\n   204\t```\r\n...\n   370\t```\r\n   371\t\r\n   372\t## Error Handling\r\n   373\t\r\n   374\t| Error | Cause | Resolution |\r\n   375\t|-------|-------|------------|\r\n   376\t| Source session not found | Invalid source_session reference | Verify test session metadata |\r\n   377\t| No implementation summaries | Source session incomplete | Complete source session first |\r\n   378\t| No test framework detected | Missing test dependencies | Request user to specify framework |\r\n   379\t| Coverage analysis failed | File access issues | Check file permissions |\r\n   380\t\r\n   381\t## Execution Modes\r\n   382\t\r\n   383\t### Plan Mode (Default)\r\n   384\t- Full Phase 1-3 execution\r\n   385\t- Comprehensive coverage analysis\r\n   386\t- Complete framework detection\r\n   387\t- Generate full test-context-package.json\r\n   388\t\r\n   389\t### Quick Mode (Future)\r\n   390\t- Skip framework detection if already known\r\n   391\t- Analyze only new implementation files\r\n   392\t- Partial context package update\r\n...\n\nPath: .codex\\agents\\test-context-search-agent.md\n     1\t---\r\n     2\tname: test-context-search-agent\r\n     3\tdescription: |\r\n     4\t  Specialized context collector for test generation workflows. Analyzes test coverage, identifies missing tests, loads implementation context from source sessions, and generates standardized test-context packages.\r\n     5\t\r\n     6\t  Examples:\r\n     7\t  - Context: Test session with source session reference\r\n     8\t    user: \"Gather test context for WFS-test-auth session\"\r\n     9\t    assistant: \"I'll load source implementation, analyze test coverage, and generate test-context package\"\r\n    10\t    commentary: Execute autonomous coverage analysis with source context loading\r\n    11\t\r\n    12\t  - Context: Multi-framework detection needed\r\n    13\t    user: \"Collect test context for full-stack project\"\r\n    14\t    assistant: \"I'll detect Jest frontend and pytest backend frameworks, analyze coverage gaps\"\r\n    15\t    commentary: Identify framework patterns and conventions for each stack\r\n    16\tcolor: blue\r\n    17\t---\r\n    18\t\r\n    19\tYou are a test context discovery specialist focused on gathering test coverage information and implementation context for test generation workflows. Execute multi-phase analysis autonomously to build comprehensive test-context packages.\r\n    20\t\r\n    21\t## Core Execution Philosophy\r\n    22\t\r\n    23\t- **Coverage-First Analysis** - Identify existing tests before planning new ones\r\n    24\t- **Source Context Loading** - Import implementation summaries from source sessions\r\n    25\t- **Framework Detection** - Auto-detect test frameworks and conventions\r\n    26\t- **Gap Identification** - Locate implementation files without corresponding tests\r\n    27\t- **Standardized Output** - Generate test-context-package.json\r\n    28\t\r\n    29\t## Tool Arsenal\r\n    30\t\r\n    31\t**Search Tool Priority**: ACE (`mcp__ace-tool__search_context`) â†’ CCW (`mcp__ccw-tools__smart_search`) / Built-in (`Grep`, `Glob`, `Read`)\r\n    32\t\r\n    33\t### 1. Session & Implementation Context\r\n    34\t**Tools**:\r\n    35\t- `Read()` - Load session metadata and implementation summaries\r\n    36\t- `Glob()` - Find session files and summaries\r\n    37\t\r\n    38\t**Use**: Phase 1 source context loading\r\n...\n   108\t\r\n   109\tfor (const summary_path of summaries) {\r\n   110\t  const content = Read(summary_path);\r\n   111\t  // Parse summary for: task_id, changed_files, implementation_type\r\n   112\t  implementation_context.summaries.push({\r\n   113\t    task_id: extract_task_id(summary_path),\r\n   114\t    summary_path: summary_path,\r\n   115\t    changed_files: extract_changed_files(content),\r\n   116\t    implementation_type: extract_type(content)\r\n   117\t  });\r\n   118\t}\r\n   119\t```\r\n   120\t\r\n   121\t### Phase 2: Test Coverage Analysis\r\n   122\t\r\n   123\t**2.1 Existing Test Discovery**:\r\n   124\t```javascript\r\n   125\t// Method 1: CodexLens MCP (preferred)\r\n   126\tconst test_files = mcp__ccw-tools__codex_lens({\r\n   127\t  action: \"search_files\",\r\n   128\t  query: \"*.test.* OR *.spec.* OR test_*.py OR *_test.go\"\r\n   129\t});\r\n...\n\n",
      "type": "text"
    }
  ]
}
tool ccw-tools.smart_search({"action":"search","mode":"fuzzy","path":"C:/Project/Claude-Code-Workflow","query":"test-context-gather","maxResults":20,"enrich":false})
2026-02-05T10:43:26.452778Z ERROR rmcp::transport::async_rw: Error reading from stream: serde error expected value at line 1 column 2
ccw-tools.smart_search({"action":"search","mode":"fuzzy","path":"C:/Project/Claude-Code-Workflow","query":"test-context-gather","maxResults":20,"enrich":false}) failed in 3.02s:

thinking
**Troubleshooting tool error**

It seems I'm encountering a "Transport closed" error with the MCP tool, which could mean the server is unavailable. The guidelines suggest using MCP tools, but since itâ€™s not working, Iâ€™ll switch to using the shell ripgrep instead. I plan to run `rg` across the repository using a direct binary call. Iâ€™ll need to check if ripgrep is installed and then execute the command `rg "test-context-gather" -n` in PowerShell.
exec
"C:\\Program Files\\PowerShell\\7\\pwsh.exe" -Command '[Console]::InputEncoding  = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
rg -n "test-context-gather" .' in C:\Project\Claude-Code-Workflow succeeded in 349ms:
.\WORKFLOW_GUIDE_CN.md:343:   â””â”€ /workflow:tools:test-context-gather
.\WORKFLOW_GUIDE_CN.md:383:   â”œâ”€ Session Mode: /workflow:tools:test-context-gather
.\WORKFLOW_GUIDE.md:345:   â””â”€ /workflow:tools:test-context-gather
.\WORKFLOW_GUIDE.md:385:   â”œâ”€ Session Mode: /workflow:tools:test-context-gather
.\COMMAND_REFERENCE.md:116:| `/workflow:tools:test-context-gather` | Collect test coverage context and identify files requiring test generation. |
.\ccw\docs-site\i18n\zh\docusaurus-plugin-content-docs\current\workflows\level-3-standard.mdx:266:/workflow:tools:test-context-gather
.\ccw\docs-site\i18n\zh\docusaurus-plugin-content-docs\current\workflows\level-3-standard.mdx:421:/workflow:tools:test-context-gather
.\ccw\docs-site\docs\workflows\level-3-standard.mdx:266:/workflow:tools:test-context-gather
.\ccw\docs-site\docs\workflows\level-3-standard.mdx:421:/workflow:tools:test-context-gather
.\ccw\docs-site\docs\commands\general\ccw-test.mdx:110:    â””â”€ /workflow:tools:test-context-gather
.\ccw\docs-site\build\assets\js\bdb2b105.836bfb71.js:1:"use strict";(globalThis.webpackChunkccw_docs=globalThis.webpackChunkccw_docs||[]).push([[511],{929(e,s,n){n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>c,default:()=>x,frontMatter:()=>o,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"workflows/level-3-standard","title":"Level 3 - Standard Workflows","description":"Complete planning with persistent session management for multi-module changes","source":"@site/docs/workflows/level-3-standard.mdx","sourceDirName":"workflows","slug":"/workflows/level-3-standard","permalink":"/docs/docs/workflows/level-3-standard","draft":false,"unlisted":false,"editUrl":"https://github.com/ccw/docs/tree/main/docs/workflows/level-3-standard.mdx","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"title":"Level 3 - Standard Workflows","description":"Complete planning with persistent session management for multi-module changes","sidebar_position":4},"sidebar":"docs","previous":{"title":"Level 2: Rapid","permalink":"/docs/docs/workflows/level-2-rapid"},"next":{"title":"Level 4: Brainstorm","permalink":"/docs/docs/workflows/level-4-brainstorm"}}');var r=n(2540),l=n(1184),i=n(1540);const o={title:"Level 3 - Standard Workflows",description:"Complete planning with persistent session management for multi-module changes",sidebar_position:4},c="Level 3: Standard Workflows",d={},a=[{value:"Overview",id:"overview",level:2},{value:"Included Workflows",id:"included-workflows",level:2},{value:"Common Characteristics",id:"common-characteristics",level:3},{value:"Workflow 1: plan -&gt; verify -&gt; execute",id:"workflow-1-plan---verify---execute",level:2},{value:"Command",id:"command",level:3},{value:"Flow Diagram",id:"flow-diagram",level:3},{value:"Process Phases",id:"process-phases",level:3},{value:"Artifacts",id:"artifacts",level:3},{value:"Use Cases",id:"use-cases",level:3},{value:"Workflow 2: tdd-plan -&gt; execute -&gt; tdd-verify",id:"workflow-2-tdd-plan---execute---tdd-verify",level:2},{value:"Command",id:"command-1",level:3},{value:"Flow Diagram",id:"flow-diagram-1",level:3},{value:"Process Phases",id:"process-phases-1",level:3},{value:"TDD Task Structure",id:"tdd-task-structure",level:3},{value:"The Iron Law",id:"the-iron-law",level:3},{value:"Use Cases",id:"use-cases-1",level:3},{value:"Workflow 3: test-fix-gen -&gt; test-cycle-execute",id:"workflow-3-test-fix-gen---test-cycle-execute",level:2},{value:"Command",id:"command-2",level:3},{value:"Flow Diagram",id:"flow-diagram-2",level:3},{value:"Process Phases",id:"process-phases-2",level:3},{value:"Dual-Mode Support",id:"dual-mode-support",level:3},{value:"Artifacts",id:"artifacts-1",level:3},{value:"Use Cases",id:"use-cases-2",level:3},{value:"Level 3 Comparison Table",id:"level-3-comparison-table",level:2},{value:"Execution: execute",id:"execution-execute",level:2},{value:"Key Features",id:"key-features",level:3},{value:"Related Workflows",id:"related-workflows",level:2}];function h(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"level-3-standard-workflows",children:"Level 3: Standard Workflows"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Complexity"}),": Medium-High | ",(0,r.jsx)(s.strong,{children:"Artifacts"}),": Persistent session files | ",(0,r.jsx)(s.strong,{children:"State"}),": Full session management"]}),"\n",(0,r.jsx)(s.p,{children:"Level 3 workflows provide complete planning with persistent session management. They're designed for multi-module changes that require traceability, verification, and structured execution."}),"\n",(0,r.jsx)(s.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(i.A,{chart:"\n  flowchart TD\n      Start([User Input]) --\x3e Select{Select Workflow}\n\n      Select --\x3e|Standard<br/>development| Plan[plan]\n      Select --\x3e|Test-driven| TDD[tdd-plan]\n      Select --\x3e|Test fix| TestFix[test-fix-gen]\n\n      Plan --\x3e Verify[plan-verify<br/>Optional]\n      TDD --\x3e Verify\n      Verify --\x3e Execute[execute]\n\n      TestFix --\x3e TestCycle[test-cycle-execute]\n\n      Execute --\x3e Review{Review?}\n      TestCycle --\x3e Review\n\n      Review --\x3e|Yes| RevCycle[review-session-cycle]\n      Review --\x3e|No| TestQ{Tests?}\n      RevCycle --\x3e RevFix[review-cycle-fix]\n      RevFix --\x3e TestQ\n\n      TestQ --\x3e|Yes| TFG[test-fix-gen]\n      TestQ --\x3e|No| Complete([session:complete])\n\n      TFG --\x3e TCE[test-cycle-execute]\n      TCE --\x3e Complete\n\n      classDef startend fill:#c8e6c9,stroke:#388e3c\n      classDef workflow fill:#e3f2fd,stroke:#1976d2\n      classDef decision fill:#fff9c4,stroke:#f57c00\n      classDef execute fill:#c5e1a5,stroke:#388e3c\n\n      class Start,Complete startend,Select,Review,TestQ decision,Plan,TDD,TestFix workflow,Verify,Execute,TestCycle,RevCycle,RevFix,TFG,TCE execute\n"}),"\n",(0,r.jsx)(s.h2,{id:"included-workflows",children:"Included Workflows"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Workflow"}),(0,r.jsx)(s.th,{children:"Purpose"}),(0,r.jsx)(s.th,{children:"Phases"}),(0,r.jsx)(s.th,{children:"Artifact Location"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"plan"})}),(0,r.jsx)(s.td,{children:"Complex feature development"}),(0,r.jsx)(s.td,{children:"5 phases"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:".workflow/active/{session}/"})})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"tdd-plan"})}),(0,r.jsx)(s.td,{children:"Test-driven development"}),(0,r.jsx)(s.td,{children:"6 phases"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:".workflow/active/{session}/"})})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"test-fix-gen"})}),(0,r.jsx)(s.td,{children:"Test fix generation"}),(0,r.jsx)(s.td,{children:"5 phases"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:".workflow/active/WFS-test-{session}/"})})]})]})]}),"\n",(0,r.jsx)(s.h3,{id:"common-characteristics",children:"Common Characteristics"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Property"}),(0,r.jsx)(s.th,{children:"Value"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Complexity"})}),(0,r.jsx)(s.td,{children:"Medium-High"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Artifacts"})}),(0,r.jsxs)(s.td,{children:["Persistent files (",(0,r.jsx)(s.code,{children:".workflow/active/{session}/"}),")"]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"State"})}),(0,r.jsx)(s.td,{children:"Full session management"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Verification"})}),(0,r.jsx)(s.td,{children:"Built-in verification steps"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Execution"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"/workflow:execute"})})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Use Case"})}),(0,r.jsx)(s.td,{children:"Multi-module, traceable tasks"})]})]})]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"workflow-1-plan---verify---execute",children:"Workflow 1: plan -> verify -> execute"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"5-phase complete planning workflow"})}),"\n",(0,r.jsx)(s.h3,{id:"command",children:"Command"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:'/workflow:plan "Implement OAuth2 authentication system"\n/workflow:plan-verify  # Verify plan (recommended)\n/workflow:execute\n/workflow:review  # (optional) Review\n'})}),"\n",(0,r.jsx)(s.h3,{id:"flow-diagram",children:"Flow Diagram"}),"\n",(0,r.jsx)(i.A,{chart:"\n  flowchart TD\n      A([Start]) --\x3e B[Phase 1: Session Discovery]\n      B --\x3e C[/workflow:session:start<br/>--auto/]\n      C --\x3e D[Return: sessionId]\n\n      D --\x3e E[Phase 2: Context Gathering]\n      E --\x3e F[/workflow:tools:context-gather/]\n      F --\x3e G[Return: context-package.json<br/>+ conflict_risk]\n\n      G --\x3e H{conflict_risk<br/>>= medium?}\n      H --\x3e|Yes| I[Phase 3: Conflict Resolution]\n      H --\x3e|No| J[Phase 4: Task Generation]\n      I --\x3e K[/workflow:tools:conflict<br/>-resolution/]\n      K --\x3e J\n\n      J --\x3e L[/workflow:tools:task-generate<br/>-agent/]\n      L --\x3e M[Return: IMPL_PLAN.md<br/>+ IMPL-*.json<br/>+ TODO_LIST.md]\n\n      M --\x3e N[Return Summary<br/>+ Next Steps]\n      N --\x3e O([Plan Complete])\n\n      classDef startend fill:#c8e6c9,stroke:#388e3c\n      classDef action fill:#e3f2fd,stroke:#1976d2\n      classDef decision fill:#fff9c4,stroke:#f57c00\n      classDef tool fill:#ffecb3,stroke:#ffa000\n\n      class A,O startend,H decision,B,E,G,J,M,N action,C,F,K,L tool\n"}),"\n",(0,r.jsx)(s.h3,{id:"process-phases",children:"Process Phases"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Phase 1: Session Discovery"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:'/workflow:session:start --auto "Implement OAuth2 authentication system"\n'})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Creates or discovers workflow session"}),"\n",(0,r.jsxs)(s.li,{children:["Returns: ",(0,r.jsx)(s.code,{children:"sessionId"})]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Phase 2: Context Gathering"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"/workflow:tools:context-gather\n"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Analyzes codebase structure"}),"\n",(0,r.jsx)(s.li,{children:"Identifies tech stack and patterns"}),"\n",(0,r.jsxs)(s.li,{children:["Returns: ",(0,r.jsx)(s.code,{children:"context-package.json"})," + ",(0,r.jsx)(s.code,{children:"conflict_risk"})]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Phase 3: Conflict Resolution"})," (Conditional)"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"# Only if conflict_risk >= medium\n/workflow:tools:conflict-resolution\n"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Detects potential conflicts"}),"\n",(0,r.jsx)(s.li,{children:"Resolves dependency issues"}),"\n",(0,r.jsx)(s.li,{children:"Ensures clean execution path"}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Phase 4: Task Generation"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"/workflow:tools:task-generate-agent\n"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Generates structured tasks"}),"\n",(0,r.jsx)(s.li,{children:"Creates dependency graph"}),"\n",(0,r.jsxs)(s.li,{children:["Returns: ",(0,r.jsx)(s.code,{children:"IMPL_PLAN.md"})," + ",(0,r.jsx)(s.code,{children:"IMPL-*.json"})," + ",(0,r.jsx)(s.code,{children:"TODO_LIST.md"})]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"artifacts",children:"Artifacts"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Location"}),": ",(0,r.jsx)(s.code,{children:".workflow/active/{WFS-session}/"})]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:".workflow/active/WFS-oauth2-auth-2025-02-03/\n\u251c\u2500\u2500 workflow-session.json          # Session metadata\n\u251c\u2500\u2500 IMPL_PLAN.md                   # Implementation plan\n\u251c\u2500\u2500 TODO_LIST.md                   # Progress tracking\n\u251c\u2500\u2500 .task/\n\u2502   \u251c\u2500\u2500 IMPL-001.json              # Main task\n\u2502   \u251c\u2500\u2500 IMPL-002.json\n\u2502   \u2514\u2500\u2500 ...\n\u2514\u2500\u2500 .process/\n    \u251c\u2500\u2500 context-package.json       # Project context\n    \u251c\u2500\u2500 conflict-resolution.json   # Conflict analysis\n    \u2514\u2500\u2500 planning-notes.md\n"})}),"\n",(0,r.jsx)(s.h3,{id:"use-cases",children:"Use Cases"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Multi-module changes"}),"\n",(0,r.jsx)(s.li,{children:"Refactoring"}),"\n",(0,r.jsx)(s.li,{children:"Dependency analysis needed"}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"workflow-2-tdd-plan---execute---tdd-verify",children:"Workflow 2: tdd-plan -> execute -> tdd-verify"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"6-phase test-driven development workflow"})}),"\n",(0,r.jsx)(s.h3,{id:"command-1",children:"Command"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:'/workflow:tdd-plan "Implement user registration with TDD"\n/workflow:execute  # Follow Red-Green-Refactor\n/workflow:tdd-verify  # Verify TDD compliance\n'})}),"\n",(0,r.jsx)(s.h3,{id:"flow-diagram-1",children:"Flow Diagram"}),"\n",(0,r.jsx)(i.A,{chart:"\n  flowchart TD\n      A([Start]) --\x3e B[Phase 1: Session Discovery]\n      B --\x3e C[/workflow:session:start<br/>--type tdd --auto/]\n      C --\x3e D[Parse: sessionId]\n\n      D --\x3e E[Phase 2: Context Gathering]\n      E --\x3e F[/workflow:tools:context-gather/]\n      F --\x3e G[Return: context-package.json]\n\n      G --\x3e H[Phase 3: Test Coverage Analysis]\n      H --\x3e I[/workflow:tools:test-context<br/>-gather/]\n      I --\x3e J[Detect test framework<br/>Analyze coverage]\n\n      J --\x3e K{conflict_risk<br/>>= medium?}\n      K --\x3e|Yes| L[Phase 4: Conflict Resolution]\n      K --\x3e|No| M[Phase 5: TDD Task Generation]\n      L --\x3e N[/workflow:tools:conflict<br/>-resolution/]\n      N --\x3e M\n\n      M --\x3e O[/workflow:tools:task-generate<br/>-tdd/]\n      O --\x3e P[Generate IMPL tasks with<br/>Red-Green-Refactor cycles]\n\n      P --\x3e Q[Phase 6: TDD Structure Validation]\n      Q --\x3e R[Verify TDD compliance]\n\n      R --\x3e S([TDD Plan Complete])\n\n      T[Execute] --\x3e U[/workflow:execute/]\n      U --\x3e V[Follow Red-Green-Refactor<br/>cycles in each task]\n\n      V --\x3e W[Verify]\n      W --\x3e X[/workflow:tdd-verify/]\n      X --\x3e Y([Complete])\n\n      classDef startend fill:#c8e6c9,stroke:#388e3c\n      classDef action fill:#e3f2fd,stroke:#1976d2\n      classDef decision fill:#fff9c4,stroke:#f57c00\n      classDef tool fill:#ffecb3,stroke:#ffa000\n\n      class A,S,Y startend,K decision,B,E,G,H,J,M,P,Q,R,T,U,V,X action,C,F,I,N,O,W tool\n"}),"\n",(0,r.jsx)(s.h3,{id:"process-phases-1",children:"Process Phases"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Phase 1: Session Discovery"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:'/workflow:session:start --type tdd --auto "TDD: User Registration"\n'})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"TDD Structured Format"}),":"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"TDD: [Feature Name]\nGOAL: [Objective]\nSCOPE: [Included/excluded]\nCONTEXT: [Background]\nTEST_FOCUS: [Test scenarios]\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Phase 2: Context Gathering"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"/workflow:tools:context-gather\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Phase 3: Test Coverage Analysis"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"/workflow:tools:test-context-gather\n"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Detect test framework"}),"\n",(0,r.jsx)(s.li,{children:"Analyze existing test coverage"}),"\n",(0,r.jsx)(s.li,{children:"Identify coverage gaps"}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Phase 4: Conflict Resolution"})," (Conditional)"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"# Only if conflict_risk >= medium\n/workflow:tools:conflict-resolution\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Phase 5: TDD Task Generation"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"/workflow:tools:task-generate-tdd\n"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Generate IMPL tasks with built-in Red-Green-Refactor cycles"}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"meta.tdd_workflow: true"})}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"flow_control.implementation_approach"})," contains 3 steps (red/green/refactor)"]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Phase 6: TDD Structure Validation"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Verify TDD structure compliance"}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"tdd-task-structure",children:"TDD Task Structure"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-json",children:'{\n  "id": "IMPL-001",\n  "title": "Implement user registration",\n  "meta": {\n    "tdd_workflow": true\n  },\n  "flow_control": {\n    "implementation_approach": [\n      {\n        "step": 1,\n        "title": "Red: Write failing test",\n        "description": "Write test that fails"\n      },\n      {\n        "step": 2,\n        "title": "Green: Make test pass",\n        "description": "Implement minimal code to pass",\n        "test_fix_cycle": {\n          "max_iterations": 3,\n          "pass_threshold": 0.95\n        }\n      },\n      {\n        "step": 3,\n        "title": "Refactor: Improve code",\n        "description": "Refactor while keeping tests green"\n      }\n    ]\n  }\n}\n'})}),"\n",(0,r.jsx)(s.h3,{id:"the-iron-law",children:"The Iron Law"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"NO PRODUCTION CODE WITHOUT A FAILING TEST FIRST\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Enforcement Method"}),":"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Phase 5: ",(0,r.jsx)(s.code,{children:"implementation_approach"})," includes test-first steps (Red -> Green -> Refactor)"]}),"\n",(0,r.jsx)(s.li,{children:"Green phase: Includes test-fix-cycle configuration (max 3 iterations)"}),"\n",(0,r.jsx)(s.li,{children:"Auto-revert: Triggered when max iterations reached without passing tests"}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Why Order Matters"}),":"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Tests written after code pass immediately -> proves nothing"}),"\n",(0,r.jsx)(s.li,{children:"Test-first forces edge case discovery before implementation"}),"\n",(0,r.jsx)(s.li,{children:"Tests-after verify what was built, not what's required"}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"use-cases-1",children:"Use Cases"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Test-driven development"}),"\n",(0,r.jsx)(s.li,{children:"High-quality feature requirements"}),"\n",(0,r.jsx)(s.li,{children:"Critical system components"}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"workflow-3-test-fix-gen---test-cycle-execute",children:"Workflow 3: test-fix-gen -> test-cycle-execute"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"5-phase test fix generation workflow"})}),"\n",(0,r.jsx)(s.h3,{id:"command-2",children:"Command"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:'# Session Mode\n/workflow:test-fix-gen WFS-user-auth-v2\n/workflow:test-cycle-execute\n\n# Prompt Mode\n/workflow:test-fix-gen "Test the auth API"\n/workflow:test-cycle-execute\n'})}),"\n",(0,r.jsx)(s.h3,{id:"flow-diagram-2",children:"Flow Diagram"}),"\n",(0,r.jsx)(i.A,{chart:"\n  flowchart TD\n      A([Start]) --\x3e B{Input Mode?}\n\n      B --\x3e|Session<br/>Mode| C[Phase 1: Use Source<br/>Session]\n      B --\x3e|Prompt<br/>Mode| D[Phase 1: Create<br/>Test Session]\n\n      C --\x3e E[/workflow:session:start<br/>--type test --resume/]\n      D --\x3e F[/workflow:session:start<br/>--type test --new/]\n\n      E --\x3e G[Phase 2: Gather Test Context]\n      F --\x3e H[Phase 2: Gather Test Context]\n\n      G --\x3e I[/workflow:tools:test-context<br/>-gather/]\n      H --\x3e I\n\n      I --\x3e J[Phase 3: Test Generation Analysis]\n      J --\x3e K[/workflow:tools:test-concept<br/>-enhanced/]\n      K --\x3e L[Multi-layer test requirements<br/>L0: Static, L1: Unit<br/>L2: Integration, L3: E2E]\n\n      L --\x3e M[Phase 4: Generate Test Tasks]\n      M --\x3e N[/workflow:tools:test-task-generate/]\n      N --\x3e O[IMPL-001: generate<br/>+ IMPL-001.5: quality gate<br/>+ IMPL-002: execute fix]\n\n      O --\x3e P[Phase 5: Return Summary]\n      P --\x3e Q[-> test-cycle-execute]\n\n      Q --\x3e R([Test Fix Complete])\n\n      classDef startend fill:#c8e6c9,stroke:#388e3c\n      classDef action fill:#e3f2fd,stroke:#1976d2\n      classDef decision fill:#fff9c4,stroke:#f57c00\n      classDef tool fill:#ffecb3,stroke:#ffa000\n\n      class A,R startend,B decision,C,D,E,F,G,H,J,M,P,Q action,I,K,N tool\n"}),"\n",(0,r.jsx)(s.h3,{id:"process-phases-2",children:"Process Phases"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Phase 1: Create/Use Test Session"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Session Mode"})," (uses existing session):"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"/workflow:session:start --type test --resume WFS-user-auth-v2\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Prompt Mode"})," (creates new session):"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"/workflow:session:start --type test --new\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Phase 2: Gather Test Context"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"/workflow:tools:test-context-gather\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Phase 3: Test Generation Analysis"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"/workflow:tools:test-concept-enhanced\n"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Multi-layer test requirements:","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"L0: Static"})," - Type checking, linting"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"L1: Unit"})," - Function-level tests"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"L2: Integration"})," - Component interaction"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"L3: E2E"})," - Full system tests"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Phase 4: Generate Test Tasks"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"/workflow:tools:test-task-generate\n"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"IMPL-001.json"}),": Test understanding & generation"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"IMPL-001.5-review.json"}),": Quality gate"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"IMPL-002.json"}),": Test execution & fix cycle"]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Phase 5: Return Summary"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["-> ",(0,r.jsx)(s.code,{children:"/workflow:test-cycle-execute"})]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"dual-mode-support",children:"Dual-Mode Support"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Mode"}),(0,r.jsx)(s.th,{children:"Input Pattern"}),(0,r.jsx)(s.th,{children:"Context Source"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Session Mode"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"WFS-xxx"})}),(0,r.jsx)(s.td,{children:"Source session summaries"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Prompt Mode"})}),(0,r.jsx)(s.td,{children:"Text/file path"}),(0,r.jsx)(s.td,{children:"Direct codebase analysis"})]})]})]}),"\n",(0,r.jsx)(s.h3,{id:"artifacts-1",children:"Artifacts"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Location"}),": ",(0,r.jsx)(s.code,{children:".workflow/active/WFS-test-{session}/"})]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:".workflow/active/WFS-test-user-auth-2025-02-03/\n\u251c\u2500\u2500 workflow-session.json\n\u251c\u2500\u2500 .task/\n\u2502   \u251c\u2500\u2500 IMPL-001.json              # Test understanding & generation\n\u2502   \u251c\u2500\u2500 IMPL-001.5-review.json     # Quality gate\n\u2502   \u2514\u2500\u2500 IMPL-002.json              # Test execution & fix cycle\n\u2514\u2500\u2500 .process/\n    \u251c\u2500\u2500 TEST_ANALYSIS_RESULTS.md\n    \u2514\u2500\u2500 test-context-package.json\n"})}),"\n",(0,r.jsx)(s.h3,{id:"use-cases-2",children:"Use Cases"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Test failure fixes"}),"\n",(0,r.jsx)(s.li,{children:"Coverage improvement"}),"\n",(0,r.jsx)(s.li,{children:"Test suite generation"}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"level-3-comparison-table",children:"Level 3 Comparison Table"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Aspect"}),(0,r.jsx)(s.th,{children:"plan"}),(0,r.jsx)(s.th,{children:"tdd-plan"}),(0,r.jsx)(s.th,{children:"test-fix-gen"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Purpose"})}),(0,r.jsx)(s.td,{children:"Complex features"}),(0,r.jsx)(s.td,{children:"Test-driven dev"}),(0,r.jsx)(s.td,{children:"Test fixes"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Phases"})}),(0,r.jsx)(s.td,{children:"5"}),(0,r.jsx)(s.td,{children:"6"}),(0,r.jsx)(s.td,{children:"5"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"TDD"})}),(0,r.jsx)(s.td,{children:"No"}),(0,r.jsx)(s.td,{children:"Yes (Red-Green-Refactor)"}),(0,r.jsx)(s.td,{children:"Optional"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Artifacts"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:".workflow/active/"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:".workflow/active/"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:".workflow/active/WFS-test-*/"})})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Verification"})}),(0,r.jsx)(s.td,{children:"plan-verify"}),(0,r.jsx)(s.td,{children:"tdd-verify"}),(0,r.jsx)(s.td,{children:"Built-in quality gate"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Best For"})}),(0,r.jsx)(s.td,{children:"Multi-module changes"}),(0,r.jsx)(s.td,{children:"High-quality features"}),(0,r.jsx)(s.td,{children:"Test improvements"})]})]})]}),"\n",(0,r.jsx)(s.h2,{id:"execution-execute",children:"Execution: execute"}),"\n",(0,r.jsxs)(s.p,{children:["All Level 3 workflows execute via ",(0,r.jsx)(s.code,{children:"execute"}),":"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"/workflow:execute --session WFS-{session-id}\n"})}),"\n",(0,r.jsx)(s.h3,{id:"key-features",children:"Key Features"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Dependency analysis"})," - Automatic task dependency resolution"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Parallel execution"})," - Independent tasks run in parallel"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Progress tracking"})," - Session-based TODO updates"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Summaries"})," - Task completion summaries for dependent tasks"]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"related-workflows",children:"Related Workflows"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.a,{href:"/docs/docs/workflows/level-2-rapid",children:"Level 2: Rapid"})," - Simpler workflow"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.a,{href:"/docs/docs/workflows/level-4-brainstorm",children:"Level 4: Brainstorm"})," - Multi-role exploration"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.a,{href:"/docs/docs/workflows/level-5-intelligent",children:"Level 5: Intelligent"})," - Automated orchestration"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.a,{href:"/docs/docs/workflows/faq",children:"FAQ"})," - Common questions"]}),"\n"]})]})}function x(e={}){const{wrapper:s}={...(0,l.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},1184(e,s,n){n.d(s,{R:()=>i,x:()=>o});var t=n(3696);const r={},l=t.createContext(r);function i(e){const s=t.useContext(l);return t.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),t.createElement(l.Provider,{value:s},e.children)}}}]);
.\ccw\docs-site\build\assets\js\ccef5d0f.265182f6.js:1:"use strict";(globalThis.webpackChunkccw_docs=globalThis.webpackChunkccw_docs||[]).push([[17],{1184(e,s,t){t.d(s,{R:()=>d,x:()=>l});var n=t(3696);const i={},r=n.createContext(i);function d(e){const s=n.useContext(r);return n.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),n.createElement(r.Provider,{value:s},e.children)}},5269(e,s,t){t.r(s),t.d(s,{assets:()=>c,contentTitle:()=>l,default:()=>a,frontMatter:()=>d,metadata:()=>n,toc:()=>o});const n=JSON.parse('{"id":"commands/general/ccw-test","title":"/ccw-test","description":"Test workflow coordinator for testing strategies","source":"@site/docs/commands/general/ccw-test.mdx","sourceDirName":"commands/general","slug":"/commands/general/ccw-test","permalink":"/docs/docs/commands/general/ccw-test","draft":false,"unlisted":false,"editUrl":"https://github.com/ccw/docs/tree/main/docs/commands/general/ccw-test.mdx","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"/ccw-test","sidebar_label":"/ccw-test","sidebar_position":3,"description":"Test workflow coordinator for testing strategies"},"sidebar":"docs","previous":{"title":"/ccw-plan","permalink":"/docs/docs/commands/general/ccw-plan"},"next":{"title":"/ccw-coordinator","permalink":"/docs/docs/commands/general/ccw-coordinator"}}');var i=t(2540),r=t(1184);const d={title:"/ccw-test",sidebar_label:"/ccw-test",sidebar_position:3,description:"Test workflow coordinator for testing strategies"},l="/ccw-test",c={},o=[{value:"Overview",id:"overview",level:2},{value:"Features",id:"features",level:2},{value:"Usage",id:"usage",level:2},{value:"Test Modes",id:"test-modes",level:2},{value:"Test Generation",id:"test-generation",level:3},{value:"Test Fix Generation",id:"test-fix-generation",level:3},{value:"Test Cycle Execution",id:"test-cycle-execution",level:3},{value:"TDD Verification",id:"tdd-verification",level:3},{value:"Test Units",id:"test-units",level:2},{value:"Progressive Test Layers",id:"progressive-test-layers",level:2},{value:"Execution Flow",id:"execution-flow",level:2},{value:"Session Mode",id:"session-mode",level:3},{value:"Prompt Mode",id:"prompt-mode",level:3},{value:"Minimum Task Structure (test-fix-gen)",id:"minimum-task-structure-test-fix-gen",level:2},{value:"Examples",id:"examples",level:2},{value:"Session Mode",id:"session-mode-1",level:3},{value:"Prompt Mode",id:"prompt-mode-1",level:3},{value:"Test Fix for Failures",id:"test-fix-for-failures",level:3},{value:"AI Code Issue Detection (L0)",id:"ai-code-issue-detection-l0",level:2},{value:"Quality Gates",id:"quality-gates",level:2},{value:"IMPL-001.3 - Code Validation",id:"impl-0013---code-validation",level:3},{value:"IMPL-001.5 - Test Quality",id:"impl-0015---test-quality",level:3},{value:"Related Commands",id:"related-commands",level:2},{value:"Notes",id:"notes",level:2}];function h(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"ccw-test",children:"/ccw-test"})}),"\n",(0,i.jsx)(s.p,{children:"Test workflow coordinator - analyzes testing requirements, selects test strategy, and executes test workflow."}),"\n",(0,i.jsx)(s.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsxs)(s.p,{children:["The ",(0,i.jsx)(s.code,{children:"/ccw-test"})," command serves as the testing orchestrator, automatically analyzing testing requirements and selecting the appropriate test workflow based on the testing context."]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Parameters"}),":"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--mode &lt;mode&gt;"}),": Test mode (test-gen, test-fix-gen, test-cycle-execute, tdd-verify)"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"--session &lt;id&gt;"}),": Resume from existing session"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:'"test description or session ID"'}),": Test target"]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"features",children:"Features"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Auto Test Mode Detection"})," - Analyzes context to select appropriate test workflow"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Test Units"})," - Commands grouped for complete testing milestones"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Progressive Layers"})," - L0-L3 test requirements"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"AI Code Validation"})," - Detects common AI-generated code issues"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Quality Gates"})," - Multiple validation checkpoints"]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"usage",children:"Usage"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:'# Session mode - test validation for completed implementation\r\n/ccw-test WFS-user-auth-v2\r\n\r\n# Prompt mode - text description\r\n/ccw-test "Test the user authentication API endpoints"\r\n\r\n# Prompt mode - file reference\r\n/ccw-test ./docs/api-requirements.md\r\n\r\n# Explicit mode selection\r\n/ccw-test --mode test-gen "Generate comprehensive tests for auth module"\r\n/ccw-test --mode test-fix-gen "Test failures in login flow"\r\n/ccw-test --mode test-cycle-execute WFS-test-auth\n'})}),"\n",(0,i.jsx)(s.h2,{id:"test-modes",children:"Test Modes"}),"\n",(0,i.jsx)(s.h3,{id:"test-generation",children:"Test Generation"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Mode"}),(0,i.jsx)(s.th,{children:"Description"}),(0,i.jsx)(s.th,{children:"Output"}),(0,i.jsx)(s.th,{children:"Follow-up"})]})}),(0,i.jsx)(s.tbody,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"test-gen"})}),(0,i.jsx)(s.td,{children:"Extensive test generation"}),(0,i.jsx)(s.td,{children:"test-tasks"}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"/workflow:execute"})})]})})]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Purpose"}),": Generate comprehensive test examples and execute tests"]}),"\n",(0,i.jsx)(s.h3,{id:"test-fix-generation",children:"Test Fix Generation"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Mode"}),(0,i.jsx)(s.th,{children:"Description"}),(0,i.jsx)(s.th,{children:"Output"}),(0,i.jsx)(s.th,{children:"Follow-up"})]})}),(0,i.jsx)(s.tbody,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"test-fix-gen"})}),(0,i.jsx)(s.td,{children:"Test and fix specific issues"}),(0,i.jsx)(s.td,{children:"test-tasks"}),(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"/workflow:test-cycle-execute"})})]})})]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Purpose"}),": Generate tests for specific problems and fix in testing"]}),"\n",(0,i.jsx)(s.h3,{id:"test-cycle-execution",children:"Test Cycle Execution"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Mode"}),(0,i.jsx)(s.th,{children:"Description"}),(0,i.jsx)(s.th,{children:"Output"}),(0,i.jsx)(s.th,{children:"Follow-up"})]})}),(0,i.jsx)(s.tbody,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"test-cycle-execute"})}),(0,i.jsx)(s.td,{children:"Iterative test and fix"}),(0,i.jsx)(s.td,{children:"test-passed"}),(0,i.jsx)(s.td,{children:"N/A"})]})})]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Purpose"}),": Execute test-fix cycle until 95% pass rate"]}),"\n",(0,i.jsx)(s.h3,{id:"tdd-verification",children:"TDD Verification"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Mode"}),(0,i.jsx)(s.th,{children:"Description"}),(0,i.jsx)(s.th,{children:"Output"})]})}),(0,i.jsx)(s.tbody,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.code,{children:"tdd-verify"})}),(0,i.jsx)(s.td,{children:"Verify TDD compliance"}),(0,i.jsx)(s.td,{children:"Quality report"})]})})]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Purpose"}),": Verify Red-Green-Refactor cycle compliance"]}),"\n",(0,i.jsx)(s.h2,{id:"test-units",children:"Test Units"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Unit Name"}),(0,i.jsx)(s.th,{children:"Commands"}),(0,i.jsx)(s.th,{children:"Purpose"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"Test Generation"})}),(0,i.jsx)(s.td,{children:"test-gen \u2192 execute"}),(0,i.jsx)(s.td,{children:"Generate and run comprehensive tests"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"Test Fix"})}),(0,i.jsx)(s.td,{children:"test-fix-gen \u2192 test-cycle-execute"}),(0,i.jsx)(s.td,{children:"Generate tests and fix iteratively"})]})]})]}),"\n",(0,i.jsx)(s.h2,{id:"progressive-test-layers",children:"Progressive Test Layers"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Layer"}),(0,i.jsx)(s.th,{children:"Description"}),(0,i.jsx)(s.th,{children:"Components"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"L0"})}),(0,i.jsx)(s.td,{children:"AI code issues"}),(0,i.jsx)(s.td,{children:"Hallucinated imports, placeholder code, mock leakage"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"L0.5"})}),(0,i.jsx)(s.td,{children:"Common issues"}),(0,i.jsx)(s.td,{children:"Edge cases, error handling"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"L1"})}),(0,i.jsx)(s.td,{children:"Unit tests"}),(0,i.jsx)(s.td,{children:"Component-level testing"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"L2"})}),(0,i.jsx)(s.td,{children:"Integration tests"}),(0,i.jsx)(s.td,{children:"API/database integration"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"L3"})}),(0,i.jsx)(s.td,{children:"E2E tests"}),(0,i.jsx)(s.td,{children:"Full workflow testing"})]})]})]}),"\n",(0,i.jsx)(s.h2,{id:"execution-flow",children:"Execution Flow"}),"\n",(0,i.jsx)(s.h3,{id:"session-mode",children:"Session Mode"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"Session ID Input\r\n    \u2193\r\nPhase 1: Create Test Session\r\n    \u2514\u2500 /workflow:session:start --type test\r\n    \u2514\u2500 Output: testSessionId\r\n    \u2193\r\nPhase 2: Test Context Gathering\r\n    \u2514\u2500 /workflow:tools:test-context-gather\r\n    \u2514\u2500 Output: test-context-package.json\r\n    \u2193\r\nPhase 3: Test Concept Enhancement\r\n    \u2514\u2500 /workflow:tools:test-concept-enhanced\r\n    \u2514\u2500 Output: TEST_ANALYSIS_RESULTS.md (L0-L3 requirements)\r\n    \u2193\r\nPhase 4: Test Task Generation\r\n    \u2514\u2500 /workflow:tools:test-task-generate\r\n    \u2514\u2500 Output: IMPL_PLAN.md, IMPL-*.json (4+ tasks)\r\n    \u2193\r\nReturn summary \u2192 Next: /workflow:test-cycle-execute\n"})}),"\n",(0,i.jsx)(s.h3,{id:"prompt-mode",children:"Prompt Mode"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:'Description/File Input\r\n    \u2193\r\nPhase 1: Create Test Session\r\n    \u2514\u2500 /workflow:session:start --type test "description"\r\n    \u2193\r\nPhase 2: Context Gathering\r\n    \u2514\u2500 /workflow:tools:context-gather\r\n    \u2193\r\nPhase 3-4: Same as Session Mode\n'})}),"\n",(0,i.jsx)(s.h2,{id:"minimum-task-structure-test-fix-gen",children:"Minimum Task Structure (test-fix-gen)"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Task"}),(0,i.jsx)(s.th,{children:"Type"}),(0,i.jsx)(s.th,{children:"Agent"}),(0,i.jsx)(s.th,{children:"Purpose"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"IMPL-001"})}),(0,i.jsx)(s.td,{children:"test-gen"}),(0,i.jsx)(s.td,{children:"@code-developer"}),(0,i.jsx)(s.td,{children:"Test understanding & generation (L1-L3)"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"IMPL-001.3"})}),(0,i.jsx)(s.td,{children:"code-validation"}),(0,i.jsx)(s.td,{children:"@test-fix-agent"}),(0,i.jsx)(s.td,{children:"Code validation gate (L0 + AI issues)"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"IMPL-001.5"})}),(0,i.jsx)(s.td,{children:"test-quality-review"}),(0,i.jsx)(s.td,{children:"@test-fix-agent"}),(0,i.jsx)(s.td,{children:"Test quality gate"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"IMPL-002"})}),(0,i.jsx)(s.td,{children:"test-fix"}),(0,i.jsx)(s.td,{children:"@test-fix-agent"}),(0,i.jsx)(s.td,{children:"Test execution & fix cycle"})]})]})]}),"\n",(0,i.jsx)(s.h2,{id:"examples",children:"Examples"}),"\n",(0,i.jsx)(s.h3,{id:"session-mode-1",children:"Session Mode"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"# Test validation for completed implementation\r\n/ccw-test WFS-user-auth-v2\r\n\r\n# Output:\r\n# Creating test session...\r\n# Gathering test context...\r\n# Analyzing test coverage...\r\n# Generating test tasks...\r\n# Created 4 test tasks\r\n# Next: /workflow:test-cycle-execute\n"})}),"\n",(0,i.jsx)(s.h3,{id:"prompt-mode-1",children:"Prompt Mode"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:'# Test specific functionality\r\n/ccw-test "Test the user authentication API endpoints in src/auth/api.ts"\r\n\r\n# Generates tests for specific module\n'})}),"\n",(0,i.jsx)(s.h3,{id:"test-fix-for-failures",children:"Test Fix for Failures"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:'# Fix failing tests\r\n/ccw-test --mode test-fix-gen "Login tests failing with timeout error"\r\n\r\n# Generates tasks to diagnose and fix test failures\n'})}),"\n",(0,i.jsx)(s.h2,{id:"ai-code-issue-detection-l0",children:"AI Code Issue Detection (L0)"}),"\n",(0,i.jsx)(s.p,{children:"The test workflow automatically detects common AI-generated code problems:"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Issue Type"}),(0,i.jsx)(s.th,{children:"Description"}),(0,i.jsx)(s.th,{children:"Detection"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"Hallucinated Imports"})}),(0,i.jsx)(s.td,{children:"Imports that don't exist"}),(0,i.jsx)(s.td,{children:"Static analysis"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"Placeholder Code"})}),(0,i.jsx)(s.td,{children:"TODO/FIXME in production"}),(0,i.jsx)(s.td,{children:"Pattern matching"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"Mock Leakage"})}),(0,i.jsx)(s.td,{children:"Test mocks in production code"}),(0,i.jsx)(s.td,{children:"Code analysis"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"Incomplete Implementation"})}),(0,i.jsx)(s.td,{children:"Empty functions/stubs"}),(0,i.jsx)(s.td,{children:"AST analysis"})]})]})]}),"\n",(0,i.jsx)(s.h2,{id:"quality-gates",children:"Quality Gates"}),"\n",(0,i.jsx)(s.h3,{id:"impl-0013---code-validation",children:"IMPL-001.3 - Code Validation"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Validates L0 requirements (AI code issues)"}),"\n",(0,i.jsx)(s.li,{children:"Checks for hallucinated imports"}),"\n",(0,i.jsx)(s.li,{children:"Detects placeholder code"}),"\n",(0,i.jsx)(s.li,{children:"Ensures no mock leakage"}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"impl-0015---test-quality",children:"IMPL-001.5 - Test Quality"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Reviews test coverage"}),"\n",(0,i.jsx)(s.li,{children:"Validates test patterns"}),"\n",(0,i.jsx)(s.li,{children:"Checks assertion quality"}),"\n",(0,i.jsx)(s.li,{children:"Ensures proper error handling"}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"related-commands",children:"Related Commands"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsxs)(s.strong,{children:["/workflow",":test-fix-gen"]})," - Test fix generation workflow"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsxs)(s.strong,{children:["/workflow",":test-cycle-execute"]})," - Test cycle execution"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsxs)(s.strong,{children:["/workflow",":tdd-plan"]})," - TDD planning workflow"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsxs)(s.strong,{children:["/workflow",":tdd-verify"]})," - TDD verification"]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"notes",children:"Notes"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Progressive layers"})," ensure comprehensive testing (L0-L3)"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"AI code validation"})," detects common AI-generated issues"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Quality gates"})," ensure high test standards"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Iterative fixing"})," until 95% pass rate"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Project type detection"})," applies appropriate test templates"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"CLI tool preference"})," supports semantic detection"]}),"\n"]})]})}function a(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}}}]);
.\ccw\docs-site\build\docs\commands\general\ccw-test.html:53:<div class="language-text codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-text codeBlock_TAPP thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Session ID Input</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    â†“</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Phase 1: Create Test Session</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    â””â”€ /workflow:session:start --type test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    â””â”€ Output: testSessionId</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    â†“</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Phase 2: Test Context Gathering</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    â””â”€ /workflow:tools:test-context-gather</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    â””â”€ Output: test-context-package.json</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    â†“</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Phase 3: Test Concept Enhancement</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    â””â”€ /workflow:tools:test-concept-enhanced</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    â””â”€ Output: TEST_ANALYSIS_RESULTS.md (L0-L3 requirements)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    â†“</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Phase 4: Test Task Generation</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    â””â”€ /workflow:tools:test-task-generate</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    â””â”€ Output: IMPL_PLAN.md, IMPL-*.json (4+ tasks)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    â†“</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Return summary â†’ Next: /workflow:test-cycle-execute</span><br></span></code></pre></div></div>

thinking
**Searching for TS file**

I found that ripgrep didnâ€™t locate a TypeScript (TS) file, which suggests that the command might not be defined in TS. However, it seems I need the TS from ccw/src. Perhaps thereâ€™s generic command routing code in ccw/src that loads the `.claude/commands` docs and runs them? But it seems probable that the TS portion is a CLI related to ccw. Iâ€™ll search for `workflow:tools` in ccw/src and use ripgrep to assist with that.
exec
"C:\\Program Files\\PowerShell\\7\\pwsh.exe" -Command '[Console]::InputEncoding  = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
rg -n "workflow:tools" ccw/src' in C:\Project\Claude-Code-Workflow exited 1 in 331ms:

exec
"C:\\Program Files\\PowerShell\\7\\pwsh.exe" -Command '[Console]::InputEncoding  = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
rg -n "test-context-package" ccw/src' in C:\Project\Claude-Code-Workflow exited 1 in 343ms:

exec
"C:\\Program Files\\PowerShell\\7\\pwsh.exe" -Command '[Console]::InputEncoding  = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
rg -n "'"\\.workflow/active\" ccw/src" in C:\Project\Claude-Code-Workflow succeeded in 328ms:
ccw/src\tools\session-manager.ts:23:const ACTIVE_BASE = '.workflow/active';

thinking
**Exploring function names**

Alright, so my next step is to open the session-manager.ts file. I want to see which function names are relevant to what I'm working on. This is an important step in identifying how everything connects. Iâ€™ll look for functions that might be helpful or important for my tasks. Letâ€™s get to it!
exec
"C:\\Program Files\\PowerShell\\7\\pwsh.exe" -Command '[Console]::InputEncoding  = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
Get-Content -Raw ccw/src/tools/session-manager.ts' in C:\Project\Claude-Code-Workflow succeeded in 305ms:
/**
 * Session Manager Tool - Workflow session lifecycle management
 * Operations: init, list, read, write, update, archive, mkdir, delete, stats
 * Content routing via content_type + path_params
 */

import { z } from 'zod';
import type { ToolSchema, ToolResult } from '../types/tool.js';
import {
  readFileSync,
  writeFileSync,
  existsSync,
  readdirSync,
  mkdirSync,
  renameSync,
  rmSync,
  statSync,
} from 'fs';
import { resolve, join, dirname } from 'path';

exec
"C:\\Program Files\\PowerShell\\7\\pwsh.exe" -Command '[Console]::InputEncoding  = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
rg -n "codex_lens" ccw/src' in C:\Project\Claude-Code-Workflow succeeded in 326ms:
ccw/src\cli.ts:149:    .option('--action <action>', 'Action to perform (for codex_lens)')
ccw/src\cli.ts:150:    .option('--query <query>', 'Search query (for codex_lens)')
ccw/src\cli.ts:151:    .option('--limit <n>', 'Max results (for codex_lens)', '20')
ccw/src\cli.ts:152:    .option('--file <file>', 'File path for symbol extraction (for codex_lens)')
ccw/src\cli.ts:153:    .option('--files <files>', 'Comma-separated file paths (for codex_lens update)')
ccw/src\cli.ts:154:    .option('--languages <langs>', 'Comma-separated languages (for codex_lens init)')
ccw/src\commands\tool.ts:102:    console.error(chalk.gray('       ccw tool exec codex_lens --action search --query "pattern"'));
ccw/src\commands\tool.ts:136:  } else if (toolName === 'codex_lens') {
ccw/src\commands\tool.ts:137:    // Parameter mode for codex_lens
ccw/src\commands\tool.ts:139:      console.error(chalk.red('codex_lens requires --action parameter'));
ccw/src\commands\tool.ts:140:      console.error(chalk.gray('Usage: ccw tool exec codex_lens --action search --query "pattern" --path .'));
ccw/src\commands\tool.ts:214:      console.log(chalk.gray('  ccw tool exec codex_lens --action search --query "def main" --path .'));
ccw/src\tools\codex-lens-lsp.ts:332:  name: 'codex_lens_lsp',
ccw/src\tools\codex-lens-lsp.ts:344:  codex_lens_lsp(action="symbol_search", symbol_name="MyClass")
ccw/src\tools\codex-lens-lsp.ts:345:  codex_lens_lsp(action="symbol_search", symbol_name="auth", kind_filter=["function", "method"])
ccw/src\tools\codex-lens-lsp.ts:346:  codex_lens_lsp(action="symbol_search", symbol_name="User", file_pattern="*.py")
ccw/src\tools\codex-lens-lsp.ts:349:  codex_lens_lsp(action="find_definition", symbol_name="authenticate")
ccw/src\tools\codex-lens-lsp.ts:350:  codex_lens_lsp(action="find_definition", symbol_name="User", symbol_kind="class")
ccw/src\tools\codex-lens-lsp.ts:353:  codex_lens_lsp(action="find_references", symbol_name="login")
ccw/src\tools\codex-lens-lsp.ts:356:  codex_lens_lsp(action="get_hover", symbol_name="processPayment")
exec
"C:\\Program Files\\PowerShell\\7\\pwsh.exe" -Command '[Console]::InputEncoding  = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
Get-Content -Raw .codex/skills/slash-command-outliner/scripts/verify-evidence.js' in C:\Project\Claude-Code-Workflow succeeded in 310ms:
import fs from 'node:fs';
import path from 'node:path';
import { fileURLToPath } from 'node:url';

export function usage() {
  console.log(
    [
      'Usage:',
      '  node .codex/skills/slash-command-outliner/scripts/verify-evidence.js --file=<path.md> [--file=<path2.md> ...]',
      '',
      'Behavior:',
      '  - Extracts evidence tables from markdown (gap-report and/or outline)',
      '  - Enforces evidence-based gates:',
      '    - Each row must label Status as Existing or Planned',
      '    - Evidence must include BOTH docs and ts anchors:',
      '      - docs: .claude/commands/**.md / <section heading>',
      '      - ts: ccw/src/** / <function|case|pattern>',
      '    - Existing rows must point to verifiable pointers (paths must exist when pointer looks like a path)',
      '',
      'Notes:',





thinking
**Verifying evidence table format**

I'm checking that the evidence tables in markdown include both `docs:` and `ts:` parts, formatted correctly with `<file> / <anchor>`. The anchor for `docs:` must respect heading existence, and for `ts:`, it should be a literal substring in the file. The evidence cell should be in a single line, avoiding line breaks and semicolons â€” the delimiter is ` / `, making sure to surround the slash with spaces. I need to ensure it follows the correct syntax.
thinking
**Verifying pointer cell requirements**

I need to check that the script properly verifies pointer cell placeholders, making sure they don't include `TBD` or `{{}}`. Itâ€™s crucial that existing pointers with path-like structures have valid paths. When evaluating a doc pointer, it should reference an existing file like `.claude/commands/workflow/tools/test-context-gather.md`. For TS files, it should be `ccw/src/tools/session-manager.ts`. If pointers donâ€™t meet directory requirements, they still need to fulfill their format specifications for evidence documentation. It's all essential for compliance!
thinking
**Generating evidence tables**

For the pointer row `.codex/agents/test-context-search-agent.md`, I should provide documentation evidence from `.claude/commands/workflow/tools/test-context-gather.md`, possibly citing a heading like `Execution Process`. For the TypeScript evidence, I need an appropriate anchor string from `ccw/src/...` related to tasks. Itâ€™s fine for documentation evidence to be the same across rows, while TypeScript evidence can be similar yet relevant. Itâ€™s crucial to ensure no placeholders like TBD or N/A are present, so Iâ€™ll include actual paths and anchors. Each row needs both documentation and TypeScript evidence, even for planned rows.
thinking
**Creating evidence tables with pointers**

I need to make sure both evidence tables include pointer rows and that the verification of evidence passes. It's important not to label a pointer as Existing unless it can be verified in the repository. I can label pointers for command docs, agent docs, and session-manager TS, plus possibly others like `ccw/src/commands/tool.ts`. If the command pointer doesn't currently exist, I can mark it as Planned. My role is to generate an outline rather than implement, but the pointer rows should still reference likely code locations, especially since the actual slash command might be document-driven.
thinking
**Ensuring evidence and schema references**

Pointer rows need both documentation and TypeScript evidence. Iâ€™ll use the existing TypeScript file `ccw/src/tools/session-manager.ts`, and possibly `ccw/src/commands/tool.ts`, for the TypeScript evidence. Each row will require a stable anchor string, and I also need to update `references.json`, including candidates with their respective slash, file path, score, and rationale. I'll confirm the slash names for command candidates, like `/workflow:tools:context-gather`. Additionally, Iâ€™ll check the `spec.json` file for conciseness and verify schema guidance from `../specs/spec-input.md` in skill Phase 01.
exec
"C:\\Program Files\\PowerShell\\7\\pwsh.exe" -Command '[Console]::InputEncoding  = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
Get-Content -Raw .codex/skills/slash-command-outliner/specs/spec-input.md' in C:\Project\Claude-Code-Workflow succeeded in 307ms:
# Spec Input (Schema + Rules)

The spec is the only â€œsource inputâ€ for outline generation. It must be **minimal** and **non-leaky**.

## Minimal JSON Schema (informal)

```json
{
  "command": {
    "group": "workflow|issue|learn|cli|other",
    "name": "kebab-case",
    "description": "one sentence",
    "argument_hint": "[--flag] \"args\"",
    "allowed_tools": ["Read(*)", "Write(*)"]
  },
  "intent": {
    "type": "analyze|plan|execute|brainstorm|manage|utility",
    "interaction": "single-shot|iterative|loop",
    "primary_user_value": "what this command accomplishes"
  },
exec
"C:\\Program Files\\PowerShell\\7\\pwsh.exe" -Command '[Console]::InputEncoding  = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
Get-Content -Raw .codex/skills/slash-command-outliner/specs/corpus-scope.md' in C:\Project\Claude-Code-Workflow succeeded in 303ms:
# Corpus Scope (All Commands + Tooling)

## Slash Command Corpus (Must Cover 100%)

- `.claude/commands/**/*.md`
  - exclude: `node_modules/`
  - exclude: `_disabled/`

## Server/Tooling Capability Corpus (Must Be Referenced in Gap Analysis)

These are not â€œslash command targetsâ€, but are required to detect hidden dependencies:

- `ccw/src/server/routes/**/*`
- `ccw/src/mcp-server/**/*`
- `ccw/src/tools/**/*`
- `ccw/src/commands/**/*`



thinking
**Organizing output creation**

I'm ready to reference the relevant code in the gap report and implementation hints. Next, I need to create output files in a specific folder. They should be concise and ensure evidence tables are included in both the gap report and generated outline. We might not need them in the agent outline, but we'll stick to the templates for consistency, replacing placeholders as necessary. I should also run a verification script once everything is generated. Itâ€™s straightforward, but I might consider using the planning tool to organize my steps effectively.
Plan update
Generate CMD-065 slash/agent outlines and evidence-based gap report per slash-command-outliner templates, then pass deterministic evidence gate.
  â†’ Load requirement doc + oracle command headings; identify concrete artifacts/constraints for spec.json.
  â€¢ Discover 3+ similar reference commands + relevant ccw/src anchors; write references.json with ranked candidates and selection.
  â€¢ Generate `generated-slash-outline.md` and `generated-agent-outline.md` from templates with filled sections and evidence table (no placeholders).
  â€¢ Generate `gap-report.md` and `fix-plan.md` with evidence table (dual-source) and minimal fixes.
  â€¢ Run `node .../verify-evidence.js` on outline + gap report; iterate until pass; write final files.

thinking
**Gathering document headings**

I'm starting by loading the oracle command headings and artifacts. Iâ€™ve seen the first part of the test-context-gather document, but I need to gather more headings for reference. The easiest way seems to be to parse lines that start with a "#". I plan to use a regex to identify these headings, applying the command `^#{1,6} ` via shell to extract the needed information efficiently.
exec
"C:\\Program Files\\PowerShell\\7\\pwsh.exe" -Command '[Console]::InputEncoding  = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
rg -n "''^#{1,6} " .claude/commands/workflow/tools/test-context-gather.md' in C:\Project\Claude-Code-Workflow succeeded in 319ms:
11:# Test Context Gather Command (/workflow:tools:test-context-gather)
13:## Overview
19:## Core Philosophy
27:## Execution Process
57:## Execution Flow
59:### Step 1: Test-Context-Package Detection
82:### Step 2: Invoke Test-Context-Search Agent
93:## Execution Mode
96:## Session Information
100:## Mission
103:### Phase 1: Session Validation & Source Context Loading
108:### Phase 2: Test Coverage Analysis
114:### Phase 3: Framework Detection & Packaging
119:## Output Requirements
128:## Quality Validation
144:### Step 3: Output Verification
162:## Parameter Reference
168:## Output Schema
180:## Usage Examples
182:### Basic Usage

thinking
**Extracting session details**

Iâ€™m focusing on gathering session information and output requirements to capture important artifact details. I want to be careful not to copy full content. Instead, I'll skim through to find the key artifact names and only read the relevant portions. I think using a search tool like rg for `.workflow` and file names will make it more efficient to find exactly what I need without getting overwhelmed by unnecessary details.
exec
"C:\\Program Files\\PowerShell\\7\\pwsh.exe" -Command '[Console]::InputEncoding  = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
rg -n "'"\\.workflow/|test-context-package|source_session|summar\" .claude/commands/workflow/tools/test-context-gather.md" in C:\Project\Claude-Code-Workflow succeeded in 335ms:
15:Orchestrator command that invokes `test-context-search-agent` to gather comprehensive test coverage context for test generation workflows. Generates standardized `test-context-package.json` with coverage analysis, framework detection, and source implementation context.
22:- **Detection-First**: Check for existing test-context-package before executing
24:- **Source Context Loading**: Import implementation summaries from source session
25:- **Standardized Output**: Generate `.workflow/active/{test_session_id}/.process/test-context-package.json`
41:   â”‚  â”œâ”€ Detection: Check for existing test-context-package
43:   â”‚  â””â”€ Source context loading (summaries, changed files)
51:      â””â”€ Generate test-context-package.json
54:   â””â”€ Verify test-context-package.json created
64:const testContextPath = `.workflow/${test_session_id}/.process/test-context-package.json`;
71:    console.log("âœ… Valid test-context-package found for session:", test_session_id);
98:- **Output Path**: .workflow/${test_session_id}/.process/test-context-package.json
104:1. **Detection**: Check for existing test-context-package (early exit if valid)
105:2. **Test Session Validation**: Load test session metadata, extract source_session reference
106:3. **Source Context Loading**: Load source session implementation summaries, changed files, tech stack
117:3. Generate and validate test-context-package.json
120:Complete test-context-package.json with:
121:- **metadata**: test_session_id, source_session_id, task_type, complexity
122:- **source_context**: implementation_summaries, tech_stack, project_patterns
125:- **assets**: implementation_summary[], existing_test[], source_code[] with priorities
150:const outputPath = `.workflow/${test_session_id}/.process/test-context-package.json`;




thinking
**Preparing gap report**

Iâ€™m working on creating the gap report using the appropriate template, which includes sections for P0, P1, and P2 gaps, and an Implementation Pointers table with evidence. Iâ€™ll compare generated outlines against references and tooling, noting that since the reference is in `.claude`, our generated outline should match it closely. Iâ€™m considering if there are mismatches in paths or tool references that could be gaps. The outliner will need to propose a minimal fix plan, such as updating tool names or unifying output paths.
thinking
**Finalizing the fix plan**

I need to ensure the evidence requirements are met to avoid any false claims. The fix plan should be concise and clearly labeled, describing any necessary actions. While thereâ€™s already a command document, I think verifying TypeScript support is important. Even if thereâ€™s no TypeScript present, weâ€™ll still need to reference anchors and ensure no broken artifact references exist. I'll include the artifacts path and list our writes appropriately. We also need to collect test coverage context for the standardized test-context JSON and ensure output files are written to the right directory.
thinking
**Creating files safely**

Iâ€™m planning to use the tool mcp__ccw-tools__write_file to create each file, but I noticed earlier that the smart_search tool crashed, which might indicate an MCP server issue. Thereâ€™s a chance that write_file could fail too, so I should consider using apply_patch or shell redirection instead. Since the guidelines prefer apply_patch, Iâ€™ll proceed with that for creating new files. It can handle multiple files in one patch, but I need to craft the patch carefully and verify the TypeScript anchors before writing.
thinking
**Choosing anchors**

I need to choose some anchors for my file. One option is in the session-manager.ts file where I see `const ACTIVE_BASE = '.workflow/active';`. Another anchor can be found in the PATH_ROUTES with `process: '{base}/.process/{filename}',` which I need to ensure is quoted correctly in the file. Iâ€™ll search for this exact snippet using rg to extract the specific line. This way, Iâ€™ll have accurate references to work with!
exec
"C:\\Program Files\\PowerShell\\7\\pwsh.exe" -Command '[Console]::InputEncoding  = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
rg -n "process: '"'\\{base\\}/\\.process/\\{filename\\}'\" ccw/src/tools/session-manager.ts" in C:\Project\Claude-Code-Workflow succeeded in 331ms:
154:  process: '{base}/.process/{filename}',
exec
"C:\\Program Files\\PowerShell\\7\\pwsh.exe" -Command '[Console]::InputEncoding  = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
rg -n "codex_lens" .codex/agents/test-context-search-agent.md' in C:\Project\Claude-Code-Workflow succeeded in 321ms:
42:- `mcp__ccw-tools__codex_lens(action="search_files", query="*.test.*")` - Find test files
43:- `mcp__ccw-tools__codex_lens(action="search", query="pattern")` - Search test patterns
44:- `mcp__ccw-tools__codex_lens(action="symbol", file="path")` - Analyze test structure
126:const test_files = mcp__ccw-tools__codex_lens({
exec
"C:\\Program Files\\PowerShell\\7\\pwsh.exe" -Command '[Console]::InputEncoding  = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
rg -n "codex_lens removed" ccw/src/tools/index.ts' in C:\Project\Claude-Code-Workflow succeeded in 321ms:
22:// codex_lens removed - functionality integrated into smart_search
363:// codex_lens removed - functionality integrated into smart_search
exec
"C:\\Program Files\\PowerShell\\7\\pwsh.exe" -Command '[Console]::InputEncoding  = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
Get-Content -TotalCount 60 ccw/src/tools/index.ts' in C:\Project\Claude-Code-Workflow succeeded in 318ms:
/**
 * Tool Registry - MCP-like tool system for CCW
 * Provides tool discovery, validation, and execution
 */

import http from 'http';
import type { ToolSchema, ToolResult } from '../types/tool.js';

// Import TypeScript migrated tools (schema + handler)
import * as editFileMod from './edit-file.js';
import * as writeFileMod from './write-file.js';
import * as getModulesByDepthMod from './get-modules-by-depth.js';
import * as classifyFoldersMod from './classify-folders.js';
import * as detectChangedModulesMod from './detect-changed-modules.js';
import * as discoverDesignFilesMod from './discover-design-files.js';
import * as generateModuleDocsMod from './generate-module-docs.js';
import * as convertTokensToCssMod from './convert-tokens-to-css.js';
import * as sessionManagerMod from './session-manager.js';
import * as cliExecutorMod from './cli-executor.js';
import * as smartSearchMod from './smart-search.js';

thinking
**Inspecting script functionality**

I'm delving into the template that uses specific column headers for organizing data. It looks like the slash outline uses `Evidence (docs + TS)` while the gap report has `Evidence`. My first thought is that the script's `findEvidenceTables` function probably needs to align with these headings, but it might ignore that detail about the parentheses. I need to carefully check the function and inspect segments in `verify-evidence.js` related to column identification. I'll gather more info by searching for `findEvidenceTables`.
exec
"C:\\Program Files\\PowerShell\\7\\pwsh.exe" -Command '[Console]::InputEncoding  = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
rg -n "function findEvidenceTables" -n .codex/skills/slash-command-outliner/scripts/verify-evidence.js' in C:\Project\Claude-Code-Workflow succeeded in 323ms:
166:export function findEvidenceTables(lines) {
exec
"C:\\Program Files\\PowerShell\\7\\pwsh.exe" -Command '[Console]::InputEncoding  = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
Get-Content -TotalCount 80 -Path .codex/skills/slash-command-outliner/scripts/verify-evidence.js | Select-Object -Skip 150' in C:\Project\Claude-Code-Workflow succeeded in 331ms:


thinking
Iâ€™m noticing that the command using `Get-Content -TotalCount 80` followed by `Select-Object -Skip 150` isnâ€™t yielding any results, which is puzzling. I think the target lines are around 166. It seems the easiest approach is to just modify the command to get the desired output. I plan to use `Get-Content` with `-TotalCount` in combination with `-Skip`. So, Iâ€™ll try running `Get-Content -Path file | Select-Object -Skip 160 -First 80`.
exec
"C:\\Program Files\\PowerShell\\7\\pwsh.exe" -Command '[Console]::InputEncoding  = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
Get-Content -Path .codex/skills/slash-command-outliner/scripts/verify-evidence.js | Select-Object -Skip 160 -First 120' in C:\Project\Claude-Code-Workflow succeeded in 340ms:

export function isSeparatorRow(cells) {
  return cells.every((c) => /^:?-{3,}:?$/.test(c));
}

export function findEvidenceTables(lines) {
  const tables = [];
  for (let i = 0; i < lines.length; i++) {
    const cells = splitTableRow(lines[i]);
    if (!cells) continue;
    const normalized = cells.map((c) => c.toLowerCase());
    const pointerIdx = normalized.findIndex((c) => c.includes('pointer'));
    const statusIdx = normalized.findIndex((c) => c.includes('status'));
    const evidenceIdx = normalized.findIndex((c) => c.includes('evidence'));
    const verifyIdx = normalized.findIndex((c) => c.includes('verify'));
    if (pointerIdx === -1 || statusIdx === -1 || evidenceIdx === -1 || verifyIdx === -1) continue;

    // next line should be separator
    const sepCells = splitTableRow(lines[i + 1] || '');
    if (!sepCells || !isSeparatorRow(sepCells)) continue;
exec
"C:\\Program Files\\PowerShell\\7\\pwsh.exe" -Command '[Console]::InputEncoding  = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
$dir = ".workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs"; New-Item -ItemType Directory -Force -Path $dir | Out-Null; Write-Output $dir' in C:\Project\Claude-Code-Workflow succeeded in 335ms:
.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs
exec
"C:\\Program Files\\PowerShell\\7\\pwsh.exe" -Command '[Console]::InputEncoding  = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
$paths = @(
  '"'.claude/commands/workflow/tools/test-context-gather.md',
  '.claude/commands/workflow/tools/context-gather.md',
  '.claude/commands/workflow/tools/test-task-generate.md',
  '.claude/commands/workflow/tools/test-concept-enhanced.md',
  '.claude/commands/workflow/tools/tdd-coverage-analysis.md'
);
"'$paths | ForEach-Object { "$_ => $(Test-Path $_)" }' in C:\Project\Claude-Code-Workflow succeeded in 328ms:
.claude/commands/workflow/tools/test-context-gather.md => True
.claude/commands/workflow/tools/context-gather.md => True
.claude/commands/workflow/tools/test-task-generate.md => True
.claude/commands/workflow/tools/test-concept-enhanced.md => True
.claude/commands/workflow/tools/tdd-coverage-analysis.md => True

thinking
**Creating output files**

I need to reference the necessary files like references.json and spec.json in my outputs. It's essential to follow the quality gate to ensure all critical sections are included: overview, usage, execution, output artifacts, and error handling. I'll create those files using the apply_patch tool. Now, I'll work on crafting a patch to add all six files and ensure everything is organized correctly in the right format.
file update
A C:\Project\Claude-Code-Workflow\.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-slash-outline.md
---
name: test-context-gather
description: Collect test coverage context using test-context-search-agent and package into standardized test-context JSON
argument-hint: "--session WFS-test-session-id"
allowed-tools: Task(*), Read(*), Glob(*)
group: workflow:tools
---

# Test Context Gather

## Overview

- Goal: Gather reusable test coverage + framework context for a test session; return an existing valid package when present, otherwise invoke `test-context-search-agent` and write a standardized `test-context-package.json`.
- Command: `/workflow:tools:test-context-gather`

## Usage

```bash
/workflow:tools:test-context-gather --session WFS-test-session-id
```

## Inputs

- Required inputs:
  - `--session <test_session_id>` (e.g. `WFS-test-auth`)
- Optional inputs:
  - none

## Outputs / Artifacts

- Writes:
  - `.workflow/active/{test_session_id}/.process/test-context-package.json`
- Reads:
  - `.workflow/active/{test_session_id}/workflow-session.json` (session metadata)
  - `.workflow/active/{test_session_id}/.process/test-context-package.json` (detection-first early exit)

## Implementation Pointers

- Command doc: `.claude/commands/workflow/tools/test-context-gather.md`
- Likely code locations:
  - `.codex/agents/test-context-search-agent.md` (subagent behavior + output schema details)
  - `ccw/src/tools/session-manager.ts` (canonical `.workflow/active/{session}` + `.process/{filename}` routing)
  - `ccw/src/tools/index.ts` (tool registry: smart_search replaces codex_lens; impacts agent tool calls)

### Evidence (Existing vs Planned)

You MUST label each pointer as `Existing` (verifiable in repo now) or `Planned` (will be created/modified).

Rules:
- `Existing` MUST include evidence from BOTH:
  - a command doc source: `.claude/commands/**.md` (section heading is sufficient)
  - a TypeScript source: `ccw/src/**` (function name / subcommand case / a ripgrep-able string)
- If you cannot verify, downgrade to `Planned` and add a concrete `Verify` step (e.g. `Test-Path <path>`, `rg "<pattern>" <path>`).

| Pointer | Status | Evidence (docs + TS) | Verify | Why |
|---|---|---|---|---|
| `.claude/commands/workflow/tools/test-context-gather.md` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Overview` ; ts: `ccw/src/tools/session-manager.ts` / `process: '{base}/.process/{filename}',` | `Test-Path .claude/commands/workflow/tools/test-context-gather.md` | Oracle command doc (headings, flow, artifacts). |
| `.codex/agents/test-context-search-agent.md` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Mission` ; ts: `ccw/src/tools/index.ts` / `// codex_lens removed - functionality integrated into smart_search` | `Test-Path .codex/agents/test-context-search-agent.md; rg "mcp__ccw-tools__codex_lens" .codex/agents/test-context-search-agent.md` | Subagent definition invoked by the command; ensure tool calls match current CCW tool registry. |
| `ccw/src/tools/session-manager.ts` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Session Information` ; ts: `ccw/src/tools/session-manager.ts` / `const ACTIVE_BASE = '.workflow/active';` | `Test-Path ccw/src/tools/session-manager.ts; rg "const ACTIVE_BASE = '.workflow/active';" ccw/src/tools/session-manager.ts` | Canonical session + `.process` path conventions for `.workflow/active/{test_session_id}/...`. |
| `.workflow/active/{test_session_id}/.process/test-context-package.json` | Planned | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Output Requirements` ; ts: `ccw/src/tools/session-manager.ts` / `process: '{base}/.process/{filename}',` | `Test-Path .workflow/active/WFS-test-auth/.process/test-context-package.json` | Primary output artifact produced (or reused) by the command. |

Notes:
- For TS evidence, anchors are literal substrings that must exist in the file now.

## Execution Process

1. Parse inputs: require `--session <test_session_id>`.
2. Detection-first:
   - If `.workflow/active/{test_session_id}/.process/test-context-package.json` exists and is valid, return it (no agent invocation).
3. Invoke subagent:
   - `Task(subagent_type="test-context-search-agent", ...)` to run the three mission phases:
     - Phase 1: Session validation + source context loading
     - Phase 2: Test coverage analysis
     - Phase 3: Framework detection + packaging
4. Output verification:
   - Confirm `test-context-package.json` exists and has required top-level fields (metadata/source_context/assets).

## Error Handling

- Missing `--session`: fail fast with usage hint.
- Session metadata missing/invalid: report that the test session cannot be validated.
- Source session not found / no summaries: instruct to complete the source session first (or fix source reference in test session metadata).
- Package generation failure: surface subagent failure and point to expected output path for manual inspection.

## Examples

- Collect test context for an existing test session:
  - `/workflow:tools:test-context-gather --session WFS-test-auth`

A C:\Project\Claude-Code-Workflow\.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/gap-report.md
# Gap Report: workflow:tools:test-context-gather

## Reference

- Selected reference: /workflow:tools:test-context-gather (`.claude/commands/workflow/tools/test-context-gather.md`)

## P0 Gaps (Must Fix)

- `test-context-search-agent` doc uses `mcp__ccw-tools__codex_lens(...)` calls, but CCW tool registry indicates `codex_lens` has been removed/integrated into `smart_search`. Align the agent doc tool calls to currently-registered tooling to avoid dead instructions.

## P1 Gaps (Should Fix)

- Output path inconsistency in command doc examples (`.workflow/${test_session_id}/...` vs `.workflow/active/{test_session_id}/...`) risks confusing callers and breaking â€œbroken artifact referenceâ€ checks in downstream tooling/docs.
- â€œValid packageâ€ criteria is described conceptually; consider adding a small explicit checklist (required top-level keys) in the command docâ€™s Quality Validation section to make the detection-first decision deterministic.

## P2 Gaps (Optional)

- Clarify whether the command should prefer `session_manager` tool routing (`content_type="process"`) when writing/reading the package, or keep direct path reads/writes in the doc examples for simplicity.

## Implementation Pointers (Evidence)

You MUST provide an evidence table for all key implementation pointers mentioned in the outlines.

Rules (P0):
- Every pointer MUST be labeled `Existing` or `Planned`.
- `Existing` MUST be verifiable (path exists). Include a concrete `Verify` command for each existing pointer.
- Do NOT describe `Planned` pointers as â€œvalidated/existsâ€.
- Evidence MUST reference BOTH sources somewhere in this section:
  - command docs: `.claude/commands/**.md` (section heading is enough)
  - TypeScript implementation: `ccw/src/**` (function name / subcommand case / ripgrep-able string)

| Pointer | Status | Evidence | Verify | Notes |
|---|---|---|---|---|
| `.claude/commands/workflow/tools/test-context-gather.md` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Execution Flow` ; ts: `ccw/src/tools/session-manager.ts` / `process: '{base}/.process/{filename}',` | `Test-Path .claude/commands/workflow/tools/test-context-gather.md` | Oracle behavior/flow; keep outline aligned to headings and artifacts. |
| `.codex/agents/test-context-search-agent.md` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Mission` ; ts: `ccw/src/tools/index.ts` / `// codex_lens removed - functionality integrated into smart_search` | `Test-Path .codex/agents/test-context-search-agent.md; rg "mcp__ccw-tools__codex_lens" .codex/agents/test-context-search-agent.md` | Needs tooling call alignment (codex_lens -> smart_search or codex_lens_lsp). |
| `ccw/src/tools/index.ts` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Integration` ; ts: `ccw/src/tools/index.ts` / `// codex_lens removed - functionality integrated into smart_search` | `Test-Path ccw/src/tools/index.ts; rg \"codex_lens removed\" ccw/src/tools/index.ts` | Tool registry ground-truth for what MCP tools exist. |
| `ccw/src/tools/session-manager.ts` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Session Information` ; ts: `ccw/src/tools/session-manager.ts` / `const ACTIVE_BASE = '.workflow/active';` | `Test-Path ccw/src/tools/session-manager.ts; rg \"const ACTIVE_BASE = '.workflow/active';\" ccw/src/tools/session-manager.ts` | Session + `.process` routing for `.workflow/active/{session}` artifacts. |
| `.workflow/active/{test_session_id}/.process/test-context-package.json` | Planned | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Output Requirements` ; ts: `ccw/src/tools/session-manager.ts` / `process: '{base}/.process/{filename}',` | `Test-Path .workflow/active/WFS-test-auth/.process/test-context-package.json` | Output artifact produced/reused by the command. |

## Implementation Hints (Tooling/Server)

- If updating the agent doc away from `codex_lens`, prefer `mcp__ccw-tools__smart_search` for file discovery and symbol search (and/or `codex_lens_lsp` for LSP-backed symbol operations).
- When documenting filesystem artifacts under `.workflow/active/{session}`, align examples to `session_manager` routing conventions (`content_type="process"`, `path_params.filename="test-context-package.json"`) when possible.

## Proposed Fix Plan (Minimal)

See `fix-plan.md`.

A C:\Project\Claude-Code-Workflow\.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/spec.json
{
  "command": {
    "group": "workflow:tools",
    "name": "test-context-gather",
    "description": "Collect test coverage context using test-context-search-agent and package into standardized test-context JSON",
    "argument_hint": "--session WFS-test-session-id",
    "allowed_tools": ["Task(*)", "Read(*)", "Glob(*)"]
  },
  "intent": {
    "type": "utility",
    "interaction": "single-shot",
    "primary_user_value": "Gather reusable test coverage + framework context for a test session; return an existing valid package when present, otherwise invoke test-context-search-agent and write a standardized test-context-package.json."
  },
  "artifacts": {
    "reads": [
      ".workflow/active/{test_session_id}/workflow-session.json",
      ".workflow/active/{test_session_id}/.process/test-context-package.json"
    ],
    "writes": [".workflow/active/{test_session_id}/.process/test-context-package.json"]
  },
  "constraints": {
    "max_rounds": 1,
    "time_budget_seconds": 0,
    "must_not": [
      "Do not claim implementation pointers are Existing unless verifiable in the repo now.",
      "Evidence must be dual-source: docs (.claude/commands/**.md) + ts (ccw/src/**).",
      "If unsure, mark pointers Planned and include concrete Verify steps."
    ]
  },
  "acceptance": {
    "p0": [
      "Frontmatter valid: name/description/allowed-tools present; argument-hint included.",
      "Allowed-tools matches behavior surface (Task, Read, Glob only).",
      "Core sections present: Overview, Usage, Inputs, Outputs/Artifacts, Execution Process, Error Handling.",
      "Writes standardized test-context package at .workflow/active/{test_session_id}/.process/test-context-package.json (or returns existing valid package)."
    ]
  }
}

A C:\Project\Claude-Code-Workflow\.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-agent-outline.md
# Agent Outline: workflow:tools:test-context-gather

## Purpose

Implement and/or evolve the slash command according to CCW conventions with minimal regressions.

## Execution Model

- Default: incremental, testable changes
- Use ACE-tool to find existing patterns before adding new abstractions

## State & Artifacts

- Session folder (existing CCW convention): `.workflow/active/{test_session_id}/...`
- Required outputs:
  - Slash MD (command doc): `.claude/commands/workflow/tools/test-context-gather.md`
  - Subagent doc (invoked by Task): `.codex/agents/test-context-search-agent.md`
  - Output artifact: `.workflow/active/{test_session_id}/.process/test-context-package.json`

## Tooling

- Allowed tools: Task(*), Read(*), Glob(*)
- Non-negotiables:
  - no unrelated changes
  - verify non-regression against completed corpus

## Validation Strategy

- P0 gates: frontmatter + allowed-tools + core sections + artifact references
- Deterministic evidence gate: ensure evidence tables in outline/gap-report cite both `.claude/commands/**.md` headings and `ccw/src/**` anchors
- Regression: compare against snapshots for already-completed commands (if enabled in this cycle)

A C:\Project\Claude-Code-Workflow\.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/references.json
{
  "candidates": [
    {
      "slash": "/workflow:tools:test-context-gather",
      "file_path": ".claude/commands/workflow/tools/test-context-gather.md",
      "score": 1.0,
      "why": "Exact oracle command doc for the requested behavior, headings, artifacts, and agent invocation flow."
    },
    {
      "slash": "/workflow:tools:context-gather",
      "file_path": ".claude/commands/workflow/tools/context-gather.md",
      "score": 0.9,
      "why": "Closest orchestrator pattern (detection-first + Task subagent + standardized package write under .workflow/active/{session}/.process)."
    },
    {
      "slash": "/workflow:tools:tdd-coverage-analysis",
      "file_path": ".claude/commands/workflow/tools/tdd-coverage-analysis.md",
      "score": 0.8,
      "why": "Coverage-oriented analysis patterns and validation steps that align with 'coverage-first' philosophy."
    },
    {
      "slash": "/workflow:tools:test-concept-enhanced",
      "file_path": ".claude/commands/workflow/tools/test-concept-enhanced.md",
      "score": 0.75,
      "why": "Test workflow tool with structured outputs and integration points in the test pipeline."
    },
    {
      "slash": "/workflow:tools:test-task-generate",
      "file_path": ".claude/commands/workflow/tools/test-task-generate.md",
      "score": 0.7,
      "why": "Downstream consumer of test-context packages; useful to keep output schema/artifacts compatible."
    }
  ],
  "selected": {
    "slash": "/workflow:tools:test-context-gather",
    "file_path": ".claude/commands/workflow/tools/test-context-gather.md",
    "why": "Use the dedicated command doc as the primary oracle, then gap-check against tooling (ccw/src/tools registry + session_manager routing)."
  }
}

A C:\Project\Claude-Code-Workflow\.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/fix-plan.md
# Fix Plan: workflow:tools:test-context-gather (Minimal)

1) P0 (docs/agent): Update `.codex/agents/test-context-search-agent.md` to replace `mcp__ccw-tools__codex_lens(...)` usage with currently-supported tooling (`mcp__ccw-tools__smart_search` and/or `codex_lens_lsp`). Add a brief note on the chosen replacement in the agentâ€™s Tool Arsenal section.

2) P1 (docs/command): Normalize output path examples in `.claude/commands/workflow/tools/test-context-gather.md` to consistently use `.workflow/active/{test_session_id}/.process/test-context-package.json` (and keep the curly-brace placeholders consistent across sections).

3) P1 (docs/command): Make the detection-first â€œvalid packageâ€ decision deterministic by listing a small required-key checklist (e.g. `metadata`, `source_context`, `assets`) under the command docâ€™s `Quality Validation` section.

apply_patch(auto_approved=true) exited 0 in 115ms:
Success. Updated the following files:
A .workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/spec.json
A .workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/references.json
A .workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-slash-outline.md
A .workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-agent-outline.md
A .workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/gap-report.md
A .workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/fix-plan.md
file update:
diff --git a/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/fix-plan.md b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/fix-plan.md
new file mode 100644
index 0000000000000000000000000000000000000000..9fa369cb80b2b8d6d6c698d572c459f639ba503f
--- /dev/null
+++ b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/fix-plan.md
@@ -0,0 +1,8 @@
+# Fix Plan: workflow:tools:test-context-gather (Minimal)
+
+1) P0 (docs/agent): Update `.codex/agents/test-context-search-agent.md` to replace `mcp__ccw-tools__codex_lens(...)` usage with currently-supported tooling (`mcp__ccw-tools__smart_search` and/or `codex_lens_lsp`). Add a brief note on the chosen replacement in the agentâ€™s Tool Arsenal section.
+
+2) P1 (docs/command): Normalize output path examples in `.claude/commands/workflow/tools/test-context-gather.md` to consistently use `.workflow/active/{test_session_id}/.process/test-context-package.json` (and keep the curly-brace placeholders consistent across sections).
+
+3) P1 (docs/command): Make the detection-first â€œvalid packageâ€ decision deterministic by listing a small required-key checklist (e.g. `metadata`, `source_context`, `assets`) under the command docâ€™s `Quality Validation` section.
+
diff --git a/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/gap-report.md b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/gap-report.md
new file mode 100644
index 0000000000000000000000000000000000000000..2d79a969cd90931108efe2be2f83788abb7472d5
--- /dev/null
+++ b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/gap-report.md
@@ -0,0 +1,48 @@
+# Gap Report: workflow:tools:test-context-gather
+
+## Reference
+
+- Selected reference: /workflow:tools:test-context-gather (`.claude/commands/workflow/tools/test-context-gather.md`)
+
+## P0 Gaps (Must Fix)
+
+- `test-context-search-agent` doc uses `mcp__ccw-tools__codex_lens(...)` calls, but CCW tool registry indicates `codex_lens` has been removed/integrated into `smart_search`. Align the agent doc tool calls to currently-registered tooling to avoid dead instructions.
+
+## P1 Gaps (Should Fix)
+
+- Output path inconsistency in command doc examples (`.workflow/${test_session_id}/...` vs `.workflow/active/{test_session_id}/...`) risks confusing callers and breaking â€œbroken artifact referenceâ€ checks in downstream tooling/docs.
+- â€œValid packageâ€ criteria is described conceptually; consider adding a small explicit checklist (required top-level keys) in the command docâ€™s Quality Validation section to make the detection-first decision deterministic.
+
+## P2 Gaps (Optional)
+
+- Clarify whether the command should prefer `session_manager` tool routing (`content_type="process"`) when writing/reading the package, or keep direct path reads/writes in the doc examples for simplicity.
+
+## Implementation Pointers (Evidence)
+
+You MUST provide an evidence table for all key implementation pointers mentioned in the outlines.
+
+Rules (P0):
+- Every pointer MUST be labeled `Existing` or `Planned`.
+- `Existing` MUST be verifiable (path exists). Include a concrete `Verify` command for each existing pointer.
+- Do NOT describe `Planned` pointers as â€œvalidated/existsâ€.
+- Evidence MUST reference BOTH sources somewhere in this section:
+  - command docs: `.claude/commands/**.md` (section heading is enough)
+  - TypeScript implementation: `ccw/src/**` (function name / subcommand case / ripgrep-able string)
+
+| Pointer | Status | Evidence | Verify | Notes |
+|---|---|---|---|---|
+| `.claude/commands/workflow/tools/test-context-gather.md` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Execution Flow` ; ts: `ccw/src/tools/session-manager.ts` / `process: '{base}/.process/{filename}',` | `Test-Path .claude/commands/workflow/tools/test-context-gather.md` | Oracle behavior/flow; keep outline aligned to headings and artifacts. |
+| `.codex/agents/test-context-search-agent.md` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Mission` ; ts: `ccw/src/tools/index.ts` / `// codex_lens removed - functionality integrated into smart_search` | `Test-Path .codex/agents/test-context-search-agent.md; rg "mcp__ccw-tools__codex_lens" .codex/agents/test-context-search-agent.md` | Needs tooling call alignment (codex_lens -> smart_search or codex_lens_lsp). |
+| `ccw/src/tools/index.ts` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Integration` ; ts: `ccw/src/tools/index.ts` / `// codex_lens removed - functionality integrated into smart_search` | `Test-Path ccw/src/tools/index.ts; rg \"codex_lens removed\" ccw/src/tools/index.ts` | Tool registry ground-truth for what MCP tools exist. |
+| `ccw/src/tools/session-manager.ts` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Session Information` ; ts: `ccw/src/tools/session-manager.ts` / `const ACTIVE_BASE = '.workflow/active';` | `Test-Path ccw/src/tools/session-manager.ts; rg \"const ACTIVE_BASE = '.workflow/active';\" ccw/src/tools/session-manager.ts` | Session + `.process` routing for `.workflow/active/{session}` artifacts. |
+| `.workflow/active/{test_session_id}/.process/test-context-package.json` | Planned | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Output Requirements` ; ts: `ccw/src/tools/session-manager.ts` / `process: '{base}/.process/{filename}',` | `Test-Path .workflow/active/WFS-test-auth/.process/test-context-package.json` | Output artifact produced/reused by the command. |
+
+## Implementation Hints (Tooling/Server)
+
+- If updating the agent doc away from `codex_lens`, prefer `mcp__ccw-tools__smart_search` for file discovery and symbol search (and/or `codex_lens_lsp` for LSP-backed symbol operations).
+- When documenting filesystem artifacts under `.workflow/active/{session}`, align examples to `session_manager` routing conventions (`content_type="process"`, `path_params.filename="test-context-package.json"`) when possible.
+
+## Proposed Fix Plan (Minimal)
+
+See `fix-plan.md`.
+
diff --git a/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-agent-outline.md b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-agent-outline.md
new file mode 100644
index 0000000000000000000000000000000000000000..1c7ded5ffec1679358626e171fcc740a8c54dfb8
--- /dev/null
+++ b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-agent-outline.md
@@ -0,0 +1,32 @@
+# Agent Outline: workflow:tools:test-context-gather
+
+## Purpose
+
+Implement and/or evolve the slash command according to CCW conventions with minimal regressions.
+
+## Execution Model
+
+- Default: incremental, testable changes
+- Use ACE-tool to find existing patterns before adding new abstractions
+
+## State & Artifacts
+
+- Session folder (existing CCW convention): `.workflow/active/{test_session_id}/...`
+- Required outputs:
+  - Slash MD (command doc): `.claude/commands/workflow/tools/test-context-gather.md`
+  - Subagent doc (invoked by Task): `.codex/agents/test-context-search-agent.md`
+  - Output artifact: `.workflow/active/{test_session_id}/.process/test-context-package.json`
+
+## Tooling
+
+- Allowed tools: Task(*), Read(*), Glob(*)
+- Non-negotiables:
+  - no unrelated changes
+  - verify non-regression against completed corpus
+
+## Validation Strategy
+
+- P0 gates: frontmatter + allowed-tools + core sections + artifact references
+- Deterministic evidence gate: ensure evidence tables in outline/gap-report cite both `.claude/commands/**.md` headings and `ccw/src/**` anchors
+- Regression: compare against snapshots for already-completed commands (if enabled in this cycle)
+
diff --git a/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-slash-outline.md b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-slash-outline.md
new file mode 100644
index 0000000000000000000000000000000000000000..738073d504c173686626740b2b4af4c5c9b2ed9b
--- /dev/null
+++ b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-slash-outline.md
@@ -0,0 +1,89 @@
+---
+name: test-context-gather
+description: Collect test coverage context using test-context-search-agent and package into standardized test-context JSON
+argument-hint: "--session WFS-test-session-id"
+allowed-tools: Task(*), Read(*), Glob(*)
+group: workflow:tools
+---
+
+# Test Context Gather
+
+## Overview
+
+- Goal: Gather reusable test coverage + framework context for a test session; return an existing valid package when present, otherwise invoke `test-context-search-agent` and write a standardized `test-context-package.json`.
+- Command: `/workflow:tools:test-context-gather`
+
+## Usage
+
+```bash
+/workflow:tools:test-context-gather --session WFS-test-session-id
+```
+
+## Inputs
+
+- Required inputs:
+  - `--session <test_session_id>` (e.g. `WFS-test-auth`)
+- Optional inputs:
+  - none
+
+## Outputs / Artifacts
+
+- Writes:
+  - `.workflow/active/{test_session_id}/.process/test-context-package.json`
+- Reads:
+  - `.workflow/active/{test_session_id}/workflow-session.json` (session metadata)
+  - `.workflow/active/{test_session_id}/.process/test-context-package.json` (detection-first early exit)
+
+## Implementation Pointers
+
+- Command doc: `.claude/commands/workflow/tools/test-context-gather.md`
+- Likely code locations:
+  - `.codex/agents/test-context-search-agent.md` (subagent behavior + output schema details)
+  - `ccw/src/tools/session-manager.ts` (canonical `.workflow/active/{session}` + `.process/{filename}` routing)
+  - `ccw/src/tools/index.ts` (tool registry: smart_search replaces codex_lens; impacts agent tool calls)
+
+### Evidence (Existing vs Planned)
+
+You MUST label each pointer as `Existing` (verifiable in repo now) or `Planned` (will be created/modified).
+
+Rules:
+- `Existing` MUST include evidence from BOTH:
+  - a command doc source: `.claude/commands/**.md` (section heading is sufficient)
+  - a TypeScript source: `ccw/src/**` (function name / subcommand case / a ripgrep-able string)
+- If you cannot verify, downgrade to `Planned` and add a concrete `Verify` step (e.g. `Test-Path <path>`, `rg "<pattern>" <path>`).
+
+| Pointer | Status | Evidence (docs + TS) | Verify | Why |
+|---|---|---|---|---|
+| `.claude/commands/workflow/tools/test-context-gather.md` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Overview` ; ts: `ccw/src/tools/session-manager.ts` / `process: '{base}/.process/{filename}',` | `Test-Path .claude/commands/workflow/tools/test-context-gather.md` | Oracle command doc (headings, flow, artifacts). |
+| `.codex/agents/test-context-search-agent.md` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Mission` ; ts: `ccw/src/tools/index.ts` / `// codex_lens removed - functionality integrated into smart_search` | `Test-Path .codex/agents/test-context-search-agent.md; rg "mcp__ccw-tools__codex_lens" .codex/agents/test-context-search-agent.md` | Subagent definition invoked by the command; ensure tool calls match current CCW tool registry. |
+| `ccw/src/tools/session-manager.ts` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Session Information` ; ts: `ccw/src/tools/session-manager.ts` / `const ACTIVE_BASE = '.workflow/active';` | `Test-Path ccw/src/tools/session-manager.ts; rg "const ACTIVE_BASE = '.workflow/active';" ccw/src/tools/session-manager.ts` | Canonical session + `.process` path conventions for `.workflow/active/{test_session_id}/...`. |
+| `.workflow/active/{test_session_id}/.process/test-context-package.json` | Planned | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Output Requirements` ; ts: `ccw/src/tools/session-manager.ts` / `process: '{base}/.process/{filename}',` | `Test-Path .workflow/active/WFS-test-auth/.process/test-context-package.json` | Primary output artifact produced (or reused) by the command. |
+
+Notes:
+- For TS evidence, anchors are literal substrings that must exist in the file now.
+
+## Execution Process
+
+1. Parse inputs: require `--session <test_session_id>`.
+2. Detection-first:
+   - If `.workflow/active/{test_session_id}/.process/test-context-package.json` exists and is valid, return it (no agent invocation).
+3. Invoke subagent:
+   - `Task(subagent_type="test-context-search-agent", ...)` to run the three mission phases:
+     - Phase 1: Session validation + source context loading
+     - Phase 2: Test coverage analysis
+     - Phase 3: Framework detection + packaging
+4. Output verification:
+   - Confirm `test-context-package.json` exists and has required top-level fields (metadata/source_context/assets).
+
+## Error Handling
+
+- Missing `--session`: fail fast with usage hint.
+- Session metadata missing/invalid: report that the test session cannot be validated.
+- Source session not found / no summaries: instruct to complete the source session first (or fix source reference in test session metadata).
+- Package generation failure: surface subagent failure and point to expected output path for manual inspection.
+
+## Examples
+
+- Collect test context for an existing test session:
+  - `/workflow:tools:test-context-gather --session WFS-test-auth`
+
diff --git a/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/references.json b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/references.json
new file mode 100644
index 0000000000000000000000000000000000000000..9dc60541084e1858d5a87af3e6792f02bc9657da
--- /dev/null
+++ b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/references.json
@@ -0,0 +1,40 @@
+{
+  "candidates": [
+    {
+      "slash": "/workflow:tools:test-context-gather",
+      "file_path": ".claude/commands/workflow/tools/test-context-gather.md",
+      "score": 1.0,
+      "why": "Exact oracle command doc for the requested behavior, headings, artifacts, and agent invocation flow."
+    },
+    {
+      "slash": "/workflow:tools:context-gather",
+      "file_path": ".claude/commands/workflow/tools/context-gather.md",
+      "score": 0.9,
+      "why": "Closest orchestrator pattern (detection-first + Task subagent + standardized package write under .workflow/active/{session}/.process)."
+    },
+    {
+      "slash": "/workflow:tools:tdd-coverage-analysis",
+      "file_path": ".claude/commands/workflow/tools/tdd-coverage-analysis.md",
+      "score": 0.8,
+      "why": "Coverage-oriented analysis patterns and validation steps that align with 'coverage-first' philosophy."
+    },
+    {
+      "slash": "/workflow:tools:test-concept-enhanced",
+      "file_path": ".claude/commands/workflow/tools/test-concept-enhanced.md",
+      "score": 0.75,
+      "why": "Test workflow tool with structured outputs and integration points in the test pipeline."
+    },
+    {
+      "slash": "/workflow:tools:test-task-generate",
+      "file_path": ".claude/commands/workflow/tools/test-task-generate.md",
+      "score": 0.7,
+      "why": "Downstream consumer of test-context packages; useful to keep output schema/artifacts compatible."
+    }
+  ],
+  "selected": {
+    "slash": "/workflow:tools:test-context-gather",
+    "file_path": ".claude/commands/workflow/tools/test-context-gather.md",
+    "why": "Use the dedicated command doc as the primary oracle, then gap-check against tooling (ccw/src/tools registry + session_manager routing)."
+  }
+}
+
diff --git a/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/spec.json b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/spec.json
new file mode 100644
index 0000000000000000000000000000000000000000..a982b1ac509c227d322f218580fa26275cc75679
--- /dev/null
+++ b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/spec.json
@@ -0,0 +1,39 @@
+{
+  "command": {
+    "group": "workflow:tools",
+    "name": "test-context-gather",
+    "description": "Collect test coverage context using test-context-search-agent and package into standardized test-context JSON",
+    "argument_hint": "--session WFS-test-session-id",
+    "allowed_tools": ["Task(*)", "Read(*)", "Glob(*)"]
+  },
+  "intent": {
+    "type": "utility",
+    "interaction": "single-shot",
+    "primary_user_value": "Gather reusable test coverage + framework context for a test session; return an existing valid package when present, otherwise invoke test-context-search-agent and write a standardized test-context-package.json."
+  },
+  "artifacts": {
+    "reads": [
+      ".workflow/active/{test_session_id}/workflow-session.json",
+      ".workflow/active/{test_session_id}/.process/test-context-package.json"
+    ],
+    "writes": [".workflow/active/{test_session_id}/.process/test-context-package.json"]
+  },
+  "constraints": {
+    "max_rounds": 1,
+    "time_budget_seconds": 0,
+    "must_not": [
+      "Do not claim implementation pointers are Existing unless verifiable in the repo now.",
+      "Evidence must be dual-source: docs (.claude/commands/**.md) + ts (ccw/src/**).",
+      "If unsure, mark pointers Planned and include concrete Verify steps."
+    ]
+  },
+  "acceptance": {
+    "p0": [
+      "Frontmatter valid: name/description/allowed-tools present; argument-hint included.",
+      "Allowed-tools matches behavior surface (Task, Read, Glob only).",
+      "Core sections present: Overview, Usage, Inputs, Outputs/Artifacts, Execution Process, Error Handling.",
+      "Writes standardized test-context package at .workflow/active/{test_session_id}/.process/test-context-package.json (or returns existing valid package)."
+    ]
+  }
+}
+

file update:
diff --git a/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/fix-plan.md b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/fix-plan.md
new file mode 100644
index 0000000000000000000000000000000000000000..9fa369cb80b2b8d6d6c698d572c459f639ba503f
--- /dev/null
+++ b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/fix-plan.md
@@ -0,0 +1,8 @@
+# Fix Plan: workflow:tools:test-context-gather (Minimal)
+
+1) P0 (docs/agent): Update `.codex/agents/test-context-search-agent.md` to replace `mcp__ccw-tools__codex_lens(...)` usage with currently-supported tooling (`mcp__ccw-tools__smart_search` and/or `codex_lens_lsp`). Add a brief note on the chosen replacement in the agentâ€™s Tool Arsenal section.
+
+2) P1 (docs/command): Normalize output path examples in `.claude/commands/workflow/tools/test-context-gather.md` to consistently use `.workflow/active/{test_session_id}/.process/test-context-package.json` (and keep the curly-brace placeholders consistent across sections).
+
+3) P1 (docs/command): Make the detection-first â€œvalid packageâ€ decision deterministic by listing a small required-key checklist (e.g. `metadata`, `source_context`, `assets`) under the command docâ€™s `Quality Validation` section.
+
diff --git a/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/gap-report.md b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/gap-report.md
new file mode 100644
index 0000000000000000000000000000000000000000..2d79a969cd90931108efe2be2f83788abb7472d5
--- /dev/null
+++ b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/gap-report.md
@@ -0,0 +1,48 @@
+# Gap Report: workflow:tools:test-context-gather
+
+## Reference
+
+- Selected reference: /workflow:tools:test-context-gather (`.claude/commands/workflow/tools/test-context-gather.md`)
+
+## P0 Gaps (Must Fix)
+
+- `test-context-search-agent` doc uses `mcp__ccw-tools__codex_lens(...)` calls, but CCW tool registry indicates `codex_lens` has been removed/integrated into `smart_search`. Align the agent doc tool calls to currently-registered tooling to avoid dead instructions.
+
+## P1 Gaps (Should Fix)
+
+- Output path inconsistency in command doc examples (`.workflow/${test_session_id}/...` vs `.workflow/active/{test_session_id}/...`) risks confusing callers and breaking â€œbroken artifact referenceâ€ checks in downstream tooling/docs.
+- â€œValid packageâ€ criteria is described conceptually; consider adding a small explicit checklist (required top-level keys) in the command docâ€™s Quality Validation section to make the detection-first decision deterministic.
+
+## P2 Gaps (Optional)
+
+- Clarify whether the command should prefer `session_manager` tool routing (`content_type="process"`) when writing/reading the package, or keep direct path reads/writes in the doc examples for simplicity.
+
+## Implementation Pointers (Evidence)
+
+You MUST provide an evidence table for all key implementation pointers mentioned in the outlines.
+
+Rules (P0):
+- Every pointer MUST be labeled `Existing` or `Planned`.
+- `Existing` MUST be verifiable (path exists). Include a concrete `Verify` command for each existing pointer.
+- Do NOT describe `Planned` pointers as â€œvalidated/existsâ€.
+- Evidence MUST reference BOTH sources somewhere in this section:
+  - command docs: `.claude/commands/**.md` (section heading is enough)
+  - TypeScript implementation: `ccw/src/**` (function name / subcommand case / ripgrep-able string)
+
+| Pointer | Status | Evidence | Verify | Notes |
+|---|---|---|---|---|
+| `.claude/commands/workflow/tools/test-context-gather.md` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Execution Flow` ; ts: `ccw/src/tools/session-manager.ts` / `process: '{base}/.process/{filename}',` | `Test-Path .claude/commands/workflow/tools/test-context-gather.md` | Oracle behavior/flow; keep outline aligned to headings and artifacts. |
+| `.codex/agents/test-context-search-agent.md` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Mission` ; ts: `ccw/src/tools/index.ts` / `// codex_lens removed - functionality integrated into smart_search` | `Test-Path .codex/agents/test-context-search-agent.md; rg "mcp__ccw-tools__codex_lens" .codex/agents/test-context-search-agent.md` | Needs tooling call alignment (codex_lens -> smart_search or codex_lens_lsp). |
+| `ccw/src/tools/index.ts` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Integration` ; ts: `ccw/src/tools/index.ts` / `// codex_lens removed - functionality integrated into smart_search` | `Test-Path ccw/src/tools/index.ts; rg \"codex_lens removed\" ccw/src/tools/index.ts` | Tool registry ground-truth for what MCP tools exist. |
+| `ccw/src/tools/session-manager.ts` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Session Information` ; ts: `ccw/src/tools/session-manager.ts` / `const ACTIVE_BASE = '.workflow/active';` | `Test-Path ccw/src/tools/session-manager.ts; rg \"const ACTIVE_BASE = '.workflow/active';\" ccw/src/tools/session-manager.ts` | Session + `.process` routing for `.workflow/active/{session}` artifacts. |
+| `.workflow/active/{test_session_id}/.process/test-context-package.json` | Planned | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Output Requirements` ; ts: `ccw/src/tools/session-manager.ts` / `process: '{base}/.process/{filename}',` | `Test-Path .workflow/active/WFS-test-auth/.process/test-context-package.json` | Output artifact produced/reused by the command. |
+
+## Implementation Hints (Tooling/Server)
+
+- If updating the agent doc away from `codex_lens`, prefer `mcp__ccw-tools__smart_search` for file discovery and symbol search (and/or `codex_lens_lsp` for LSP-backed symbol operations).
+- When documenting filesystem artifacts under `.workflow/active/{session}`, align examples to `session_manager` routing conventions (`content_type="process"`, `path_params.filename="test-context-package.json"`) when possible.
+
+## Proposed Fix Plan (Minimal)
+
+See `fix-plan.md`.
+
diff --git a/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-agent-outline.md b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-agent-outline.md
new file mode 100644
index 0000000000000000000000000000000000000000..1c7ded5ffec1679358626e171fcc740a8c54dfb8
--- /dev/null
+++ b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-agent-outline.md
@@ -0,0 +1,32 @@
+# Agent Outline: workflow:tools:test-context-gather
+
+## Purpose
+
+Implement and/or evolve the slash command according to CCW conventions with minimal regressions.
+
+## Execution Model
+
+- Default: incremental, testable changes
+- Use ACE-tool to find existing patterns before adding new abstractions
+
+## State & Artifacts
+
+- Session folder (existing CCW convention): `.workflow/active/{test_session_id}/...`
+- Required outputs:
+  - Slash MD (command doc): `.claude/commands/workflow/tools/test-context-gather.md`
+  - Subagent doc (invoked by Task): `.codex/agents/test-context-search-agent.md`
+  - Output artifact: `.workflow/active/{test_session_id}/.process/test-context-package.json`
+
+## Tooling
+
+- Allowed tools: Task(*), Read(*), Glob(*)
+- Non-negotiables:
+  - no unrelated changes
+  - verify non-regression against completed corpus
+
+## Validation Strategy
+
+- P0 gates: frontmatter + allowed-tools + core sections + artifact references
+- Deterministic evidence gate: ensure evidence tables in outline/gap-report cite both `.claude/commands/**.md` headings and `ccw/src/**` anchors
+- Regression: compare against snapshots for already-completed commands (if enabled in this cycle)
+
diff --git a/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-slash-outline.md b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-slash-outline.md
new file mode 100644
index 0000000000000000000000000000000000000000..738073d504c173686626740b2b4af4c5c9b2ed9b
--- /dev/null
+++ b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-slash-outline.md
@@ -0,0 +1,89 @@
+---
+name: test-context-gather
+description: Collect test coverage context using test-context-search-agent and package into standardized test-context JSON
+argument-hint: "--session WFS-test-session-id"
+allowed-tools: Task(*), Read(*), Glob(*)
+group: workflow:tools
+---
+
+# Test Context Gather
+
+## Overview
+
+- Goal: Gather reusable test coverage + framework context for a test session; return an existing valid package when present, otherwise invoke `test-context-search-agent` and write a standardized `test-context-package.json`.
+- Command: `/workflow:tools:test-context-gather`
+
+## Usage
+
+```bash
+/workflow:tools:test-context-gather --session WFS-test-session-id
+```
+
+## Inputs
+
+- Required inputs:
+  - `--session <test_session_id>` (e.g. `WFS-test-auth`)
+- Optional inputs:
+  - none
+
+## Outputs / Artifacts
+
+- Writes:
+  - `.workflow/active/{test_session_id}/.process/test-context-package.json`
+- Reads:
+  - `.workflow/active/{test_session_id}/workflow-session.json` (session metadata)
+  - `.workflow/active/{test_session_id}/.process/test-context-package.json` (detection-first early exit)
+
+## Implementation Pointers
+
+- Command doc: `.claude/commands/workflow/tools/test-context-gather.md`
+- Likely code locations:
+  - `.codex/agents/test-context-search-agent.md` (subagent behavior + output schema details)
+  - `ccw/src/tools/session-manager.ts` (canonical `.workflow/active/{session}` + `.process/{filename}` routing)
+  - `ccw/src/tools/index.ts` (tool registry: smart_search replaces codex_lens; impacts agent tool calls)
+
+### Evidence (Existing vs Planned)
+
+You MUST label each pointer as `Existing` (verifiable in repo now) or `Planned` (will be created/modified).
+
+Rules:
+- `Existing` MUST include evidence from BOTH:
+  - a command doc source: `.claude/commands/**.md` (section heading is sufficient)
+  - a TypeScript source: `ccw/src/**` (function name / subcommand case / a ripgrep-able string)
+- If you cannot verify, downgrade to `Planned` and add a concrete `Verify` step (e.g. `Test-Path <path>`, `rg "<pattern>" <path>`).
+
+| Pointer | Status | Evidence (docs + TS) | Verify | Why |
+|---|---|---|---|---|
+| `.claude/commands/workflow/tools/test-context-gather.md` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Overview` ; ts: `ccw/src/tools/session-manager.ts` / `process: '{base}/.process/{filename}',` | `Test-Path .claude/commands/workflow/tools/test-context-gather.md` | Oracle command doc (headings, flow, artifacts). |
+| `.codex/agents/test-context-search-agent.md` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Mission` ; ts: `ccw/src/tools/index.ts` / `// codex_lens removed - functionality integrated into smart_search` | `Test-Path .codex/agents/test-context-search-agent.md; rg "mcp__ccw-tools__codex_lens" .codex/agents/test-context-search-agent.md` | Subagent definition invoked by the command; ensure tool calls match current CCW tool registry. |
+| `ccw/src/tools/session-manager.ts` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Session Information` ; ts: `ccw/src/tools/session-manager.ts` / `const ACTIVE_BASE = '.workflow/active';` | `Test-Path ccw/src/tools/session-manager.ts; rg "const ACTIVE_BASE = '.workflow/active';" ccw/src/tools/session-manager.ts` | Canonical session + `.process` path conventions for `.workflow/active/{test_session_id}/...`. |
+| `.workflow/active/{test_session_id}/.process/test-context-package.json` | Planned | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Output Requirements` ; ts: `ccw/src/tools/session-manager.ts` / `process: '{base}/.process/{filename}',` | `Test-Path .workflow/active/WFS-test-auth/.process/test-context-package.json` | Primary output artifact produced (or reused) by the command. |
+
+Notes:
+- For TS evidence, anchors are literal substrings that must exist in the file now.
+
+## Execution Process
+
+1. Parse inputs: require `--session <test_session_id>`.
+2. Detection-first:
+   - If `.workflow/active/{test_session_id}/.process/test-context-package.json` exists and is valid, return it (no agent invocation).
+3. Invoke subagent:
+   - `Task(subagent_type="test-context-search-agent", ...)` to run the three mission phases:
+     - Phase 1: Session validation + source context loading
+     - Phase 2: Test coverage analysis
+     - Phase 3: Framework detection + packaging
+4. Output verification:
+   - Confirm `test-context-package.json` exists and has required top-level fields (metadata/source_context/assets).
+
+## Error Handling
+
+- Missing `--session`: fail fast with usage hint.
+- Session metadata missing/invalid: report that the test session cannot be validated.
+- Source session not found / no summaries: instruct to complete the source session first (or fix source reference in test session metadata).
+- Package generation failure: surface subagent failure and point to expected output path for manual inspection.
+
+## Examples
+
+- Collect test context for an existing test session:
+  - `/workflow:tools:test-context-gather --session WFS-test-auth`
+
diff --git a/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/references.json b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/references.json
new file mode 100644
index 0000000000000000000000000000000000000000..9dc60541084e1858d5a87af3e6792f02bc9657da
--- /dev/null
+++ b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/references.json
@@ -0,0 +1,40 @@
+{
+  "candidates": [
+    {
+      "slash": "/workflow:tools:test-context-gather",
+      "file_path": ".claude/commands/workflow/tools/test-context-gather.md",
+      "score": 1.0,
+      "why": "Exact oracle command doc for the requested behavior, headings, artifacts, and agent invocation flow."
+    },
+    {
+      "slash": "/workflow:tools:context-gather",
+      "file_path": ".claude/commands/workflow/tools/context-gather.md",
+      "score": 0.9,
+      "why": "Closest orchestrator pattern (detection-first + Task subagent + standardized package write under .workflow/active/{session}/.process)."
+    },
+    {
+      "slash": "/workflow:tools:tdd-coverage-analysis",
+      "file_path": ".claude/commands/workflow/tools/tdd-coverage-analysis.md",
+      "score": 0.8,
+      "why": "Coverage-oriented analysis patterns and validation steps that align with 'coverage-first' philosophy."
+    },
+    {
+      "slash": "/workflow:tools:test-concept-enhanced",
+      "file_path": ".claude/commands/workflow/tools/test-concept-enhanced.md",
+      "score": 0.75,
+      "why": "Test workflow tool with structured outputs and integration points in the test pipeline."
+    },
+    {
+      "slash": "/workflow:tools:test-task-generate",
+      "file_path": ".claude/commands/workflow/tools/test-task-generate.md",
+      "score": 0.7,
+      "why": "Downstream consumer of test-context packages; useful to keep output schema/artifacts compatible."
+    }
+  ],
+  "selected": {
+    "slash": "/workflow:tools:test-context-gather",
+    "file_path": ".claude/commands/workflow/tools/test-context-gather.md",
+    "why": "Use the dedicated command doc as the primary oracle, then gap-check against tooling (ccw/src/tools registry + session_manager routing)."
+  }
+}
+
diff --git a/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/spec.json b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/spec.json
new file mode 100644
index 0000000000000000000000000000000000000000..a982b1ac509c227d322f218580fa26275cc75679
--- /dev/null
+++ b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/spec.json
@@ -0,0 +1,39 @@
+{
+  "command": {
+    "group": "workflow:tools",
+    "name": "test-context-gather",
+    "description": "Collect test coverage context using test-context-search-agent and package into standardized test-context JSON",
+    "argument_hint": "--session WFS-test-session-id",
+    "allowed_tools": ["Task(*)", "Read(*)", "Glob(*)"]
+  },
+  "intent": {
+    "type": "utility",
+    "interaction": "single-shot",
+    "primary_user_value": "Gather reusable test coverage + framework context for a test session; return an existing valid package when present, otherwise invoke test-context-search-agent and write a standardized test-context-package.json."
+  },
+  "artifacts": {
+    "reads": [
+      ".workflow/active/{test_session_id}/workflow-session.json",
+      ".workflow/active/{test_session_id}/.process/test-context-package.json"
+    ],
+    "writes": [".workflow/active/{test_session_id}/.process/test-context-package.json"]
+  },
+  "constraints": {
+    "max_rounds": 1,
+    "time_budget_seconds": 0,
+    "must_not": [
+      "Do not claim implementation pointers are Existing unless verifiable in the repo now.",
+      "Evidence must be dual-source: docs (.claude/commands/**.md) + ts (ccw/src/**).",
+      "If unsure, mark pointers Planned and include concrete Verify steps."
+    ]
+  },
+  "acceptance": {
+    "p0": [
+      "Frontmatter valid: name/description/allowed-tools present; argument-hint included.",
+      "Allowed-tools matches behavior surface (Task, Read, Glob only).",
+      "Core sections present: Overview, Usage, Inputs, Outputs/Artifacts, Execution Process, Error Handling.",
+      "Writes standardized test-context package at .workflow/active/{test_session_id}/.process/test-context-package.json (or returns existing valid package)."
+    ]
+  }
+}
+

exec
"C:\\Program Files\\PowerShell\\7\\pwsh.exe" -Command '[Console]::InputEncoding  = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
node .codex/skills/slash-command-outliner/scripts/verify-evidence.js --file=.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/gap-report.md --file=.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-slash-outline.md' in C:\Project\Claude-Code-Workflow succeeded in 340ms:
OK: evidence verification passed
file update:
diff --git a/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/fix-plan.md b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/fix-plan.md
new file mode 100644
index 0000000000000000000000000000000000000000..9fa369cb80b2b8d6d6c698d572c459f639ba503f
--- /dev/null
+++ b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/fix-plan.md
@@ -0,0 +1,8 @@
+# Fix Plan: workflow:tools:test-context-gather (Minimal)
+
+1) P0 (docs/agent): Update `.codex/agents/test-context-search-agent.md` to replace `mcp__ccw-tools__codex_lens(...)` usage with currently-supported tooling (`mcp__ccw-tools__smart_search` and/or `codex_lens_lsp`). Add a brief note on the chosen replacement in the agentâ€™s Tool Arsenal section.
+
+2) P1 (docs/command): Normalize output path examples in `.claude/commands/workflow/tools/test-context-gather.md` to consistently use `.workflow/active/{test_session_id}/.process/test-context-package.json` (and keep the curly-brace placeholders consistent across sections).
+
+3) P1 (docs/command): Make the detection-first â€œvalid packageâ€ decision deterministic by listing a small required-key checklist (e.g. `metadata`, `source_context`, `assets`) under the command docâ€™s `Quality Validation` section.
+
diff --git a/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/gap-report.md b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/gap-report.md
new file mode 100644
index 0000000000000000000000000000000000000000..2d79a969cd90931108efe2be2f83788abb7472d5
--- /dev/null
+++ b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/gap-report.md
@@ -0,0 +1,48 @@
+# Gap Report: workflow:tools:test-context-gather
+
+## Reference
+
+- Selected reference: /workflow:tools:test-context-gather (`.claude/commands/workflow/tools/test-context-gather.md`)
+
+## P0 Gaps (Must Fix)
+
+- `test-context-search-agent` doc uses `mcp__ccw-tools__codex_lens(...)` calls, but CCW tool registry indicates `codex_lens` has been removed/integrated into `smart_search`. Align the agent doc tool calls to currently-registered tooling to avoid dead instructions.
+
+## P1 Gaps (Should Fix)
+
+- Output path inconsistency in command doc examples (`.workflow/${test_session_id}/...` vs `.workflow/active/{test_session_id}/...`) risks confusing callers and breaking â€œbroken artifact referenceâ€ checks in downstream tooling/docs.
+- â€œValid packageâ€ criteria is described conceptually; consider adding a small explicit checklist (required top-level keys) in the command docâ€™s Quality Validation section to make the detection-first decision deterministic.
+
+## P2 Gaps (Optional)
+
+- Clarify whether the command should prefer `session_manager` tool routing (`content_type="process"`) when writing/reading the package, or keep direct path reads/writes in the doc examples for simplicity.
+
+## Implementation Pointers (Evidence)
+
+You MUST provide an evidence table for all key implementation pointers mentioned in the outlines.
+
+Rules (P0):
+- Every pointer MUST be labeled `Existing` or `Planned`.
+- `Existing` MUST be verifiable (path exists). Include a concrete `Verify` command for each existing pointer.
+- Do NOT describe `Planned` pointers as â€œvalidated/existsâ€.
+- Evidence MUST reference BOTH sources somewhere in this section:
+  - command docs: `.claude/commands/**.md` (section heading is enough)
+  - TypeScript implementation: `ccw/src/**` (function name / subcommand case / ripgrep-able string)
+
+| Pointer | Status | Evidence | Verify | Notes |
+|---|---|---|---|---|
+| `.claude/commands/workflow/tools/test-context-gather.md` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Execution Flow` ; ts: `ccw/src/tools/session-manager.ts` / `process: '{base}/.process/{filename}',` | `Test-Path .claude/commands/workflow/tools/test-context-gather.md` | Oracle behavior/flow; keep outline aligned to headings and artifacts. |
+| `.codex/agents/test-context-search-agent.md` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Mission` ; ts: `ccw/src/tools/index.ts` / `// codex_lens removed - functionality integrated into smart_search` | `Test-Path .codex/agents/test-context-search-agent.md; rg "mcp__ccw-tools__codex_lens" .codex/agents/test-context-search-agent.md` | Needs tooling call alignment (codex_lens -> smart_search or codex_lens_lsp). |
+| `ccw/src/tools/index.ts` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Integration` ; ts: `ccw/src/tools/index.ts` / `// codex_lens removed - functionality integrated into smart_search` | `Test-Path ccw/src/tools/index.ts; rg \"codex_lens removed\" ccw/src/tools/index.ts` | Tool registry ground-truth for what MCP tools exist. |
+| `ccw/src/tools/session-manager.ts` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Session Information` ; ts: `ccw/src/tools/session-manager.ts` / `const ACTIVE_BASE = '.workflow/active';` | `Test-Path ccw/src/tools/session-manager.ts; rg \"const ACTIVE_BASE = '.workflow/active';\" ccw/src/tools/session-manager.ts` | Session + `.process` routing for `.workflow/active/{session}` artifacts. |
+| `.workflow/active/{test_session_id}/.process/test-context-package.json` | Planned | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Output Requirements` ; ts: `ccw/src/tools/session-manager.ts` / `process: '{base}/.process/{filename}',` | `Test-Path .workflow/active/WFS-test-auth/.process/test-context-package.json` | Output artifact produced/reused by the command. |
+
+## Implementation Hints (Tooling/Server)
+
+- If updating the agent doc away from `codex_lens`, prefer `mcp__ccw-tools__smart_search` for file discovery and symbol search (and/or `codex_lens_lsp` for LSP-backed symbol operations).
+- When documenting filesystem artifacts under `.workflow/active/{session}`, align examples to `session_manager` routing conventions (`content_type="process"`, `path_params.filename="test-context-package.json"`) when possible.
+
+## Proposed Fix Plan (Minimal)
+
+See `fix-plan.md`.
+
diff --git a/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-agent-outline.md b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-agent-outline.md
new file mode 100644
index 0000000000000000000000000000000000000000..1c7ded5ffec1679358626e171fcc740a8c54dfb8
--- /dev/null
+++ b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-agent-outline.md
@@ -0,0 +1,32 @@
+# Agent Outline: workflow:tools:test-context-gather
+
+## Purpose
+
+Implement and/or evolve the slash command according to CCW conventions with minimal regressions.
+
+## Execution Model
+
+- Default: incremental, testable changes
+- Use ACE-tool to find existing patterns before adding new abstractions
+
+## State & Artifacts
+
+- Session folder (existing CCW convention): `.workflow/active/{test_session_id}/...`
+- Required outputs:
+  - Slash MD (command doc): `.claude/commands/workflow/tools/test-context-gather.md`
+  - Subagent doc (invoked by Task): `.codex/agents/test-context-search-agent.md`
+  - Output artifact: `.workflow/active/{test_session_id}/.process/test-context-package.json`
+
+## Tooling
+
+- Allowed tools: Task(*), Read(*), Glob(*)
+- Non-negotiables:
+  - no unrelated changes
+  - verify non-regression against completed corpus
+
+## Validation Strategy
+
+- P0 gates: frontmatter + allowed-tools + core sections + artifact references
+- Deterministic evidence gate: ensure evidence tables in outline/gap-report cite both `.claude/commands/**.md` headings and `ccw/src/**` anchors
+- Regression: compare against snapshots for already-completed commands (if enabled in this cycle)
+
diff --git a/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-slash-outline.md b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-slash-outline.md
new file mode 100644
index 0000000000000000000000000000000000000000..738073d504c173686626740b2b4af4c5c9b2ed9b
--- /dev/null
+++ b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-slash-outline.md
@@ -0,0 +1,89 @@
+---
+name: test-context-gather
+description: Collect test coverage context using test-context-search-agent and package into standardized test-context JSON
+argument-hint: "--session WFS-test-session-id"
+allowed-tools: Task(*), Read(*), Glob(*)
+group: workflow:tools
+---
+
+# Test Context Gather
+
+## Overview
+
+- Goal: Gather reusable test coverage + framework context for a test session; return an existing valid package when present, otherwise invoke `test-context-search-agent` and write a standardized `test-context-package.json`.
+- Command: `/workflow:tools:test-context-gather`
+
+## Usage
+
+```bash
+/workflow:tools:test-context-gather --session WFS-test-session-id
+```
+
+## Inputs
+
+- Required inputs:
+  - `--session <test_session_id>` (e.g. `WFS-test-auth`)
+- Optional inputs:
+  - none
+
+## Outputs / Artifacts
+
+- Writes:
+  - `.workflow/active/{test_session_id}/.process/test-context-package.json`
+- Reads:
+  - `.workflow/active/{test_session_id}/workflow-session.json` (session metadata)
+  - `.workflow/active/{test_session_id}/.process/test-context-package.json` (detection-first early exit)
+
+## Implementation Pointers
+
+- Command doc: `.claude/commands/workflow/tools/test-context-gather.md`
+- Likely code locations:
+  - `.codex/agents/test-context-search-agent.md` (subagent behavior + output schema details)
+  - `ccw/src/tools/session-manager.ts` (canonical `.workflow/active/{session}` + `.process/{filename}` routing)
+  - `ccw/src/tools/index.ts` (tool registry: smart_search replaces codex_lens; impacts agent tool calls)
+
+### Evidence (Existing vs Planned)
+
+You MUST label each pointer as `Existing` (verifiable in repo now) or `Planned` (will be created/modified).
+
+Rules:
+- `Existing` MUST include evidence from BOTH:
+  - a command doc source: `.claude/commands/**.md` (section heading is sufficient)
+  - a TypeScript source: `ccw/src/**` (function name / subcommand case / a ripgrep-able string)
+- If you cannot verify, downgrade to `Planned` and add a concrete `Verify` step (e.g. `Test-Path <path>`, `rg "<pattern>" <path>`).
+
+| Pointer | Status | Evidence (docs + TS) | Verify | Why |
+|---|---|---|---|---|
+| `.claude/commands/workflow/tools/test-context-gather.md` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Overview` ; ts: `ccw/src/tools/session-manager.ts` / `process: '{base}/.process/{filename}',` | `Test-Path .claude/commands/workflow/tools/test-context-gather.md` | Oracle command doc (headings, flow, artifacts). |
+| `.codex/agents/test-context-search-agent.md` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Mission` ; ts: `ccw/src/tools/index.ts` / `// codex_lens removed - functionality integrated into smart_search` | `Test-Path .codex/agents/test-context-search-agent.md; rg "mcp__ccw-tools__codex_lens" .codex/agents/test-context-search-agent.md` | Subagent definition invoked by the command; ensure tool calls match current CCW tool registry. |
+| `ccw/src/tools/session-manager.ts` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Session Information` ; ts: `ccw/src/tools/session-manager.ts` / `const ACTIVE_BASE = '.workflow/active';` | `Test-Path ccw/src/tools/session-manager.ts; rg "const ACTIVE_BASE = '.workflow/active';" ccw/src/tools/session-manager.ts` | Canonical session + `.process` path conventions for `.workflow/active/{test_session_id}/...`. |
+| `.workflow/active/{test_session_id}/.process/test-context-package.json` | Planned | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Output Requirements` ; ts: `ccw/src/tools/session-manager.ts` / `process: '{base}/.process/{filename}',` | `Test-Path .workflow/active/WFS-test-auth/.process/test-context-package.json` | Primary output artifact produced (or reused) by the command. |
+
+Notes:
+- For TS evidence, anchors are literal substrings that must exist in the file now.
+
+## Execution Process
+
+1. Parse inputs: require `--session <test_session_id>`.
+2. Detection-first:
+   - If `.workflow/active/{test_session_id}/.process/test-context-package.json` exists and is valid, return it (no agent invocation).
+3. Invoke subagent:
+   - `Task(subagent_type="test-context-search-agent", ...)` to run the three mission phases:
+     - Phase 1: Session validation + source context loading
+     - Phase 2: Test coverage analysis
+     - Phase 3: Framework detection + packaging
+4. Output verification:
+   - Confirm `test-context-package.json` exists and has required top-level fields (metadata/source_context/assets).
+
+## Error Handling
+
+- Missing `--session`: fail fast with usage hint.
+- Session metadata missing/invalid: report that the test session cannot be validated.
+- Source session not found / no summaries: instruct to complete the source session first (or fix source reference in test session metadata).
+- Package generation failure: surface subagent failure and point to expected output path for manual inspection.
+
+## Examples
+
+- Collect test context for an existing test session:
+  - `/workflow:tools:test-context-gather --session WFS-test-auth`
+
diff --git a/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/references.json b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/references.json
new file mode 100644
index 0000000000000000000000000000000000000000..9dc60541084e1858d5a87af3e6792f02bc9657da
--- /dev/null
+++ b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/references.json
@@ -0,0 +1,40 @@
+{
+  "candidates": [
+    {
+      "slash": "/workflow:tools:test-context-gather",
+      "file_path": ".claude/commands/workflow/tools/test-context-gather.md",
+      "score": 1.0,
+      "why": "Exact oracle command doc for the requested behavior, headings, artifacts, and agent invocation flow."
+    },
+    {
+      "slash": "/workflow:tools:context-gather",
+      "file_path": ".claude/commands/workflow/tools/context-gather.md",
+      "score": 0.9,
+      "why": "Closest orchestrator pattern (detection-first + Task subagent + standardized package write under .workflow/active/{session}/.process)."
+    },
+    {
+      "slash": "/workflow:tools:tdd-coverage-analysis",
+      "file_path": ".claude/commands/workflow/tools/tdd-coverage-analysis.md",
+      "score": 0.8,
+      "why": "Coverage-oriented analysis patterns and validation steps that align with 'coverage-first' philosophy."
+    },
+    {
+      "slash": "/workflow:tools:test-concept-enhanced",
+      "file_path": ".claude/commands/workflow/tools/test-concept-enhanced.md",
+      "score": 0.75,
+      "why": "Test workflow tool with structured outputs and integration points in the test pipeline."
+    },
+    {
+      "slash": "/workflow:tools:test-task-generate",
+      "file_path": ".claude/commands/workflow/tools/test-task-generate.md",
+      "score": 0.7,
+      "why": "Downstream consumer of test-context packages; useful to keep output schema/artifacts compatible."
+    }
+  ],
+  "selected": {
+    "slash": "/workflow:tools:test-context-gather",
+    "file_path": ".claude/commands/workflow/tools/test-context-gather.md",
+    "why": "Use the dedicated command doc as the primary oracle, then gap-check against tooling (ccw/src/tools registry + session_manager routing)."
+  }
+}
+
diff --git a/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/spec.json b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/spec.json
new file mode 100644
index 0000000000000000000000000000000000000000..a982b1ac509c227d322f218580fa26275cc75679
--- /dev/null
+++ b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/spec.json
@@ -0,0 +1,39 @@
+{
+  "command": {
+    "group": "workflow:tools",
+    "name": "test-context-gather",
+    "description": "Collect test coverage context using test-context-search-agent and package into standardized test-context JSON",
+    "argument_hint": "--session WFS-test-session-id",
+    "allowed_tools": ["Task(*)", "Read(*)", "Glob(*)"]
+  },
+  "intent": {
+    "type": "utility",
+    "interaction": "single-shot",
+    "primary_user_value": "Gather reusable test coverage + framework context for a test session; return an existing valid package when present, otherwise invoke test-context-search-agent and write a standardized test-context-package.json."
+  },
+  "artifacts": {
+    "reads": [
+      ".workflow/active/{test_session_id}/workflow-session.json",
+      ".workflow/active/{test_session_id}/.process/test-context-package.json"
+    ],
+    "writes": [".workflow/active/{test_session_id}/.process/test-context-package.json"]
+  },
+  "constraints": {
+    "max_rounds": 1,
+    "time_budget_seconds": 0,
+    "must_not": [
+      "Do not claim implementation pointers are Existing unless verifiable in the repo now.",
+      "Evidence must be dual-source: docs (.claude/commands/**.md) + ts (ccw/src/**).",
+      "If unsure, mark pointers Planned and include concrete Verify steps."
+    ]
+  },
+  "acceptance": {
+    "p0": [
+      "Frontmatter valid: name/description/allowed-tools present; argument-hint included.",
+      "Allowed-tools matches behavior surface (Task, Read, Glob only).",
+      "Core sections present: Overview, Usage, Inputs, Outputs/Artifacts, Execution Process, Error Handling.",
+      "Writes standardized test-context package at .workflow/active/{test_session_id}/.process/test-context-package.json (or returns existing valid package)."
+    ]
+  }
+}
+


thinking
**Updating plan status**

I see that we've made great progress and passed the evidence gate! I just need to update the plan status now. Step 1 is complete, and I think we wrapped up all necessary outputs and ran verification. So, it's time to mark those plan steps as completed. Letâ€™s dive into that update! It's satisfying to see things move forward.
Plan update
All required output files written from templates; dual-source evidence tables validated with verify-evidence.js.
  âœ“ Load requirement doc + oracle command headings; identify concrete artifacts/constraints for spec.json.
  âœ“ Discover 3+ similar reference commands + relevant ccw/src anchors; write references.json with ranked candidates and selection.
  âœ“ Generate `generated-slash-outline.md` and `generated-agent-outline.md` from templates with filled sections and evidence table (no placeholders).
  âœ“ Generate `gap-report.md` and `fix-plan.md` with evidence table (dual-source) and minimal fixes.
  âœ“ Run `node .../verify-evidence.js` on outline + gap report; iterate until pass; write final files.
file update:
diff --git a/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/fix-plan.md b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/fix-plan.md
new file mode 100644
index 0000000000000000000000000000000000000000..9fa369cb80b2b8d6d6c698d572c459f639ba503f
--- /dev/null
+++ b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/fix-plan.md
@@ -0,0 +1,8 @@
+# Fix Plan: workflow:tools:test-context-gather (Minimal)
+
+1) P0 (docs/agent): Update `.codex/agents/test-context-search-agent.md` to replace `mcp__ccw-tools__codex_lens(...)` usage with currently-supported tooling (`mcp__ccw-tools__smart_search` and/or `codex_lens_lsp`). Add a brief note on the chosen replacement in the agentâ€™s Tool Arsenal section.
+
+2) P1 (docs/command): Normalize output path examples in `.claude/commands/workflow/tools/test-context-gather.md` to consistently use `.workflow/active/{test_session_id}/.process/test-context-package.json` (and keep the curly-brace placeholders consistent across sections).
+
+3) P1 (docs/command): Make the detection-first â€œvalid packageâ€ decision deterministic by listing a small required-key checklist (e.g. `metadata`, `source_context`, `assets`) under the command docâ€™s `Quality Validation` section.
+
diff --git a/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/gap-report.md b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/gap-report.md
new file mode 100644
index 0000000000000000000000000000000000000000..2d79a969cd90931108efe2be2f83788abb7472d5
--- /dev/null
+++ b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/gap-report.md
@@ -0,0 +1,48 @@
+# Gap Report: workflow:tools:test-context-gather
+
+## Reference
+
+- Selected reference: /workflow:tools:test-context-gather (`.claude/commands/workflow/tools/test-context-gather.md`)
+
+## P0 Gaps (Must Fix)
+
+- `test-context-search-agent` doc uses `mcp__ccw-tools__codex_lens(...)` calls, but CCW tool registry indicates `codex_lens` has been removed/integrated into `smart_search`. Align the agent doc tool calls to currently-registered tooling to avoid dead instructions.
+
+## P1 Gaps (Should Fix)
+
+- Output path inconsistency in command doc examples (`.workflow/${test_session_id}/...` vs `.workflow/active/{test_session_id}/...`) risks confusing callers and breaking â€œbroken artifact referenceâ€ checks in downstream tooling/docs.
+- â€œValid packageâ€ criteria is described conceptually; consider adding a small explicit checklist (required top-level keys) in the command docâ€™s Quality Validation section to make the detection-first decision deterministic.
+
+## P2 Gaps (Optional)
+
+- Clarify whether the command should prefer `session_manager` tool routing (`content_type="process"`) when writing/reading the package, or keep direct path reads/writes in the doc examples for simplicity.
+
+## Implementation Pointers (Evidence)
+
+You MUST provide an evidence table for all key implementation pointers mentioned in the outlines.
+
+Rules (P0):
+- Every pointer MUST be labeled `Existing` or `Planned`.
+- `Existing` MUST be verifiable (path exists). Include a concrete `Verify` command for each existing pointer.
+- Do NOT describe `Planned` pointers as â€œvalidated/existsâ€.
+- Evidence MUST reference BOTH sources somewhere in this section:
+  - command docs: `.claude/commands/**.md` (section heading is enough)
+  - TypeScript implementation: `ccw/src/**` (function name / subcommand case / ripgrep-able string)
+
+| Pointer | Status | Evidence | Verify | Notes |
+|---|---|---|---|---|
+| `.claude/commands/workflow/tools/test-context-gather.md` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Execution Flow` ; ts: `ccw/src/tools/session-manager.ts` / `process: '{base}/.process/{filename}',` | `Test-Path .claude/commands/workflow/tools/test-context-gather.md` | Oracle behavior/flow; keep outline aligned to headings and artifacts. |
+| `.codex/agents/test-context-search-agent.md` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Mission` ; ts: `ccw/src/tools/index.ts` / `// codex_lens removed - functionality integrated into smart_search` | `Test-Path .codex/agents/test-context-search-agent.md; rg "mcp__ccw-tools__codex_lens" .codex/agents/test-context-search-agent.md` | Needs tooling call alignment (codex_lens -> smart_search or codex_lens_lsp). |
+| `ccw/src/tools/index.ts` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Integration` ; ts: `ccw/src/tools/index.ts` / `// codex_lens removed - functionality integrated into smart_search` | `Test-Path ccw/src/tools/index.ts; rg \"codex_lens removed\" ccw/src/tools/index.ts` | Tool registry ground-truth for what MCP tools exist. |
+| `ccw/src/tools/session-manager.ts` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Session Information` ; ts: `ccw/src/tools/session-manager.ts` / `const ACTIVE_BASE = '.workflow/active';` | `Test-Path ccw/src/tools/session-manager.ts; rg \"const ACTIVE_BASE = '.workflow/active';\" ccw/src/tools/session-manager.ts` | Session + `.process` routing for `.workflow/active/{session}` artifacts. |
+| `.workflow/active/{test_session_id}/.process/test-context-package.json` | Planned | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Output Requirements` ; ts: `ccw/src/tools/session-manager.ts` / `process: '{base}/.process/{filename}',` | `Test-Path .workflow/active/WFS-test-auth/.process/test-context-package.json` | Output artifact produced/reused by the command. |
+
+## Implementation Hints (Tooling/Server)
+
+- If updating the agent doc away from `codex_lens`, prefer `mcp__ccw-tools__smart_search` for file discovery and symbol search (and/or `codex_lens_lsp` for LSP-backed symbol operations).
+- When documenting filesystem artifacts under `.workflow/active/{session}`, align examples to `session_manager` routing conventions (`content_type="process"`, `path_params.filename="test-context-package.json"`) when possible.
+
+## Proposed Fix Plan (Minimal)
+
+See `fix-plan.md`.
+
diff --git a/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-agent-outline.md b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-agent-outline.md
new file mode 100644
index 0000000000000000000000000000000000000000..1c7ded5ffec1679358626e171fcc740a8c54dfb8
--- /dev/null
+++ b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-agent-outline.md
@@ -0,0 +1,32 @@
+# Agent Outline: workflow:tools:test-context-gather
+
+## Purpose
+
+Implement and/or evolve the slash command according to CCW conventions with minimal regressions.
+
+## Execution Model
+
+- Default: incremental, testable changes
+- Use ACE-tool to find existing patterns before adding new abstractions
+
+## State & Artifacts
+
+- Session folder (existing CCW convention): `.workflow/active/{test_session_id}/...`
+- Required outputs:
+  - Slash MD (command doc): `.claude/commands/workflow/tools/test-context-gather.md`
+  - Subagent doc (invoked by Task): `.codex/agents/test-context-search-agent.md`
+  - Output artifact: `.workflow/active/{test_session_id}/.process/test-context-package.json`
+
+## Tooling
+
+- Allowed tools: Task(*), Read(*), Glob(*)
+- Non-negotiables:
+  - no unrelated changes
+  - verify non-regression against completed corpus
+
+## Validation Strategy
+
+- P0 gates: frontmatter + allowed-tools + core sections + artifact references
+- Deterministic evidence gate: ensure evidence tables in outline/gap-report cite both `.claude/commands/**.md` headings and `ccw/src/**` anchors
+- Regression: compare against snapshots for already-completed commands (if enabled in this cycle)
+
diff --git a/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-slash-outline.md b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-slash-outline.md
new file mode 100644
index 0000000000000000000000000000000000000000..738073d504c173686626740b2b4af4c5c9b2ed9b
--- /dev/null
+++ b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-slash-outline.md
@@ -0,0 +1,89 @@
+---
+name: test-context-gather
+description: Collect test coverage context using test-context-search-agent and package into standardized test-context JSON
+argument-hint: "--session WFS-test-session-id"
+allowed-tools: Task(*), Read(*), Glob(*)
+group: workflow:tools
+---
+
+# Test Context Gather
+
+## Overview
+
+- Goal: Gather reusable test coverage + framework context for a test session; return an existing valid package when present, otherwise invoke `test-context-search-agent` and write a standardized `test-context-package.json`.
+- Command: `/workflow:tools:test-context-gather`
+
+## Usage
+
+```bash
+/workflow:tools:test-context-gather --session WFS-test-session-id
+```
+
+## Inputs
+
+- Required inputs:
+  - `--session <test_session_id>` (e.g. `WFS-test-auth`)
+- Optional inputs:
+  - none
+
+## Outputs / Artifacts
+
+- Writes:
+  - `.workflow/active/{test_session_id}/.process/test-context-package.json`
+- Reads:
+  - `.workflow/active/{test_session_id}/workflow-session.json` (session metadata)
+  - `.workflow/active/{test_session_id}/.process/test-context-package.json` (detection-first early exit)
+
+## Implementation Pointers
+
+- Command doc: `.claude/commands/workflow/tools/test-context-gather.md`
+- Likely code locations:
+  - `.codex/agents/test-context-search-agent.md` (subagent behavior + output schema details)
+  - `ccw/src/tools/session-manager.ts` (canonical `.workflow/active/{session}` + `.process/{filename}` routing)
+  - `ccw/src/tools/index.ts` (tool registry: smart_search replaces codex_lens; impacts agent tool calls)
+
+### Evidence (Existing vs Planned)
+
+You MUST label each pointer as `Existing` (verifiable in repo now) or `Planned` (will be created/modified).
+
+Rules:
+- `Existing` MUST include evidence from BOTH:
+  - a command doc source: `.claude/commands/**.md` (section heading is sufficient)
+  - a TypeScript source: `ccw/src/**` (function name / subcommand case / a ripgrep-able string)
+- If you cannot verify, downgrade to `Planned` and add a concrete `Verify` step (e.g. `Test-Path <path>`, `rg "<pattern>" <path>`).
+
+| Pointer | Status | Evidence (docs + TS) | Verify | Why |
+|---|---|---|---|---|
+| `.claude/commands/workflow/tools/test-context-gather.md` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Overview` ; ts: `ccw/src/tools/session-manager.ts` / `process: '{base}/.process/{filename}',` | `Test-Path .claude/commands/workflow/tools/test-context-gather.md` | Oracle command doc (headings, flow, artifacts). |
+| `.codex/agents/test-context-search-agent.md` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Mission` ; ts: `ccw/src/tools/index.ts` / `// codex_lens removed - functionality integrated into smart_search` | `Test-Path .codex/agents/test-context-search-agent.md; rg "mcp__ccw-tools__codex_lens" .codex/agents/test-context-search-agent.md` | Subagent definition invoked by the command; ensure tool calls match current CCW tool registry. |
+| `ccw/src/tools/session-manager.ts` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Session Information` ; ts: `ccw/src/tools/session-manager.ts` / `const ACTIVE_BASE = '.workflow/active';` | `Test-Path ccw/src/tools/session-manager.ts; rg "const ACTIVE_BASE = '.workflow/active';" ccw/src/tools/session-manager.ts` | Canonical session + `.process` path conventions for `.workflow/active/{test_session_id}/...`. |
+| `.workflow/active/{test_session_id}/.process/test-context-package.json` | Planned | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Output Requirements` ; ts: `ccw/src/tools/session-manager.ts` / `process: '{base}/.process/{filename}',` | `Test-Path .workflow/active/WFS-test-auth/.process/test-context-package.json` | Primary output artifact produced (or reused) by the command. |
+
+Notes:
+- For TS evidence, anchors are literal substrings that must exist in the file now.
+
+## Execution Process
+
+1. Parse inputs: require `--session <test_session_id>`.
+2. Detection-first:
+   - If `.workflow/active/{test_session_id}/.process/test-context-package.json` exists and is valid, return it (no agent invocation).
+3. Invoke subagent:
+   - `Task(subagent_type="test-context-search-agent", ...)` to run the three mission phases:
+     - Phase 1: Session validation + source context loading
+     - Phase 2: Test coverage analysis
+     - Phase 3: Framework detection + packaging
+4. Output verification:
+   - Confirm `test-context-package.json` exists and has required top-level fields (metadata/source_context/assets).
+
+## Error Handling
+
+- Missing `--session`: fail fast with usage hint.
+- Session metadata missing/invalid: report that the test session cannot be validated.
+- Source session not found / no summaries: instruct to complete the source session first (or fix source reference in test session metadata).
+- Package generation failure: surface subagent failure and point to expected output path for manual inspection.
+
+## Examples
+
+- Collect test context for an existing test session:
+  - `/workflow:tools:test-context-gather --session WFS-test-auth`
+
diff --git a/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/references.json b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/references.json
new file mode 100644
index 0000000000000000000000000000000000000000..9dc60541084e1858d5a87af3e6792f02bc9657da
--- /dev/null
+++ b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/references.json
@@ -0,0 +1,40 @@
+{
+  "candidates": [
+    {
+      "slash": "/workflow:tools:test-context-gather",
+      "file_path": ".claude/commands/workflow/tools/test-context-gather.md",
+      "score": 1.0,
+      "why": "Exact oracle command doc for the requested behavior, headings, artifacts, and agent invocation flow."
+    },
+    {
+      "slash": "/workflow:tools:context-gather",
+      "file_path": ".claude/commands/workflow/tools/context-gather.md",
+      "score": 0.9,
+      "why": "Closest orchestrator pattern (detection-first + Task subagent + standardized package write under .workflow/active/{session}/.process)."
+    },
+    {
+      "slash": "/workflow:tools:tdd-coverage-analysis",
+      "file_path": ".claude/commands/workflow/tools/tdd-coverage-analysis.md",
+      "score": 0.8,
+      "why": "Coverage-oriented analysis patterns and validation steps that align with 'coverage-first' philosophy."
+    },
+    {
+      "slash": "/workflow:tools:test-concept-enhanced",
+      "file_path": ".claude/commands/workflow/tools/test-concept-enhanced.md",
+      "score": 0.75,
+      "why": "Test workflow tool with structured outputs and integration points in the test pipeline."
+    },
+    {
+      "slash": "/workflow:tools:test-task-generate",
+      "file_path": ".claude/commands/workflow/tools/test-task-generate.md",
+      "score": 0.7,
+      "why": "Downstream consumer of test-context packages; useful to keep output schema/artifacts compatible."
+    }
+  ],
+  "selected": {
+    "slash": "/workflow:tools:test-context-gather",
+    "file_path": ".claude/commands/workflow/tools/test-context-gather.md",
+    "why": "Use the dedicated command doc as the primary oracle, then gap-check against tooling (ccw/src/tools registry + session_manager routing)."
+  }
+}
+
diff --git a/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/spec.json b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/spec.json
new file mode 100644
index 0000000000000000000000000000000000000000..a982b1ac509c227d322f218580fa26275cc75679
--- /dev/null
+++ b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/spec.json
@@ -0,0 +1,39 @@
+{
+  "command": {
+    "group": "workflow:tools",
+    "name": "test-context-gather",
+    "description": "Collect test coverage context using test-context-search-agent and package into standardized test-context JSON",
+    "argument_hint": "--session WFS-test-session-id",
+    "allowed_tools": ["Task(*)", "Read(*)", "Glob(*)"]
+  },
+  "intent": {
+    "type": "utility",
+    "interaction": "single-shot",
+    "primary_user_value": "Gather reusable test coverage + framework context for a test session; return an existing valid package when present, otherwise invoke test-context-search-agent and write a standardized test-context-package.json."
+  },
+  "artifacts": {
+    "reads": [
+      ".workflow/active/{test_session_id}/workflow-session.json",
+      ".workflow/active/{test_session_id}/.process/test-context-package.json"
+    ],
+    "writes": [".workflow/active/{test_session_id}/.process/test-context-package.json"]
+  },
+  "constraints": {
+    "max_rounds": 1,
+    "time_budget_seconds": 0,
+    "must_not": [
+      "Do not claim implementation pointers are Existing unless verifiable in the repo now.",
+      "Evidence must be dual-source: docs (.claude/commands/**.md) + ts (ccw/src/**).",
+      "If unsure, mark pointers Planned and include concrete Verify steps."
+    ]
+  },
+  "acceptance": {
+    "p0": [
+      "Frontmatter valid: name/description/allowed-tools present; argument-hint included.",
+      "Allowed-tools matches behavior surface (Task, Read, Glob only).",
+      "Core sections present: Overview, Usage, Inputs, Outputs/Artifacts, Execution Process, Error Handling.",
+      "Writes standardized test-context package at .workflow/active/{test_session_id}/.process/test-context-package.json (or returns existing valid package)."
+    ]
+  }
+}
+


thinking
**Checking file readiness**

I need to make sure we keep written files concise and avoid unnecessary extras. Iâ€™ll check that spec.json and references.json are in the right path. Do I need to show file sizes? Maybe not. I also need to ensure that there are no placeholders like "TBD" in the evidence rows. It looks like Iâ€™m all set to produce a final response for the user about what I've done and where everything is located.
exec
"C:\\Program Files\\PowerShell\\7\\pwsh.exe" -Command '[Console]::InputEncoding  = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
Get-ChildItem -File .workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs | Select-Object Name,Length' in C:\Project\Claude-Code-Workflow succeeded in 333ms:

[32;1mName                      [0m[32;1m Length[0m
[32;1m----                      [0m [32;1m------[0m
fix-plan.md                   864
gap-report.md                4404
generated-agent-outline.md   1181
generated-slash-outline.md   5054
references.json              1738
spec.json                    1756

file update:
diff --git a/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/fix-plan.md b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/fix-plan.md
new file mode 100644
index 0000000000000000000000000000000000000000..9fa369cb80b2b8d6d6c698d572c459f639ba503f
--- /dev/null
+++ b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/fix-plan.md
@@ -0,0 +1,8 @@
+# Fix Plan: workflow:tools:test-context-gather (Minimal)
+
+1) P0 (docs/agent): Update `.codex/agents/test-context-search-agent.md` to replace `mcp__ccw-tools__codex_lens(...)` usage with currently-supported tooling (`mcp__ccw-tools__smart_search` and/or `codex_lens_lsp`). Add a brief note on the chosen replacement in the agentâ€™s Tool Arsenal section.
+
+2) P1 (docs/command): Normalize output path examples in `.claude/commands/workflow/tools/test-context-gather.md` to consistently use `.workflow/active/{test_session_id}/.process/test-context-package.json` (and keep the curly-brace placeholders consistent across sections).
+
+3) P1 (docs/command): Make the detection-first â€œvalid packageâ€ decision deterministic by listing a small required-key checklist (e.g. `metadata`, `source_context`, `assets`) under the command docâ€™s `Quality Validation` section.
+
diff --git a/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/gap-report.md b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/gap-report.md
new file mode 100644
index 0000000000000000000000000000000000000000..2d79a969cd90931108efe2be2f83788abb7472d5
--- /dev/null
+++ b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/gap-report.md
@@ -0,0 +1,48 @@
+# Gap Report: workflow:tools:test-context-gather
+
+## Reference
+
+- Selected reference: /workflow:tools:test-context-gather (`.claude/commands/workflow/tools/test-context-gather.md`)
+
+## P0 Gaps (Must Fix)
+
+- `test-context-search-agent` doc uses `mcp__ccw-tools__codex_lens(...)` calls, but CCW tool registry indicates `codex_lens` has been removed/integrated into `smart_search`. Align the agent doc tool calls to currently-registered tooling to avoid dead instructions.
+
+## P1 Gaps (Should Fix)
+
+- Output path inconsistency in command doc examples (`.workflow/${test_session_id}/...` vs `.workflow/active/{test_session_id}/...`) risks confusing callers and breaking â€œbroken artifact referenceâ€ checks in downstream tooling/docs.
+- â€œValid packageâ€ criteria is described conceptually; consider adding a small explicit checklist (required top-level keys) in the command docâ€™s Quality Validation section to make the detection-first decision deterministic.
+
+## P2 Gaps (Optional)
+
+- Clarify whether the command should prefer `session_manager` tool routing (`content_type="process"`) when writing/reading the package, or keep direct path reads/writes in the doc examples for simplicity.
+
+## Implementation Pointers (Evidence)
+
+You MUST provide an evidence table for all key implementation pointers mentioned in the outlines.
+
+Rules (P0):
+- Every pointer MUST be labeled `Existing` or `Planned`.
+- `Existing` MUST be verifiable (path exists). Include a concrete `Verify` command for each existing pointer.
+- Do NOT describe `Planned` pointers as â€œvalidated/existsâ€.
+- Evidence MUST reference BOTH sources somewhere in this section:
+  - command docs: `.claude/commands/**.md` (section heading is enough)
+  - TypeScript implementation: `ccw/src/**` (function name / subcommand case / ripgrep-able string)
+
+| Pointer | Status | Evidence | Verify | Notes |
+|---|---|---|---|---|
+| `.claude/commands/workflow/tools/test-context-gather.md` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Execution Flow` ; ts: `ccw/src/tools/session-manager.ts` / `process: '{base}/.process/{filename}',` | `Test-Path .claude/commands/workflow/tools/test-context-gather.md` | Oracle behavior/flow; keep outline aligned to headings and artifacts. |
+| `.codex/agents/test-context-search-agent.md` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Mission` ; ts: `ccw/src/tools/index.ts` / `// codex_lens removed - functionality integrated into smart_search` | `Test-Path .codex/agents/test-context-search-agent.md; rg "mcp__ccw-tools__codex_lens" .codex/agents/test-context-search-agent.md` | Needs tooling call alignment (codex_lens -> smart_search or codex_lens_lsp). |
+| `ccw/src/tools/index.ts` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Integration` ; ts: `ccw/src/tools/index.ts` / `// codex_lens removed - functionality integrated into smart_search` | `Test-Path ccw/src/tools/index.ts; rg \"codex_lens removed\" ccw/src/tools/index.ts` | Tool registry ground-truth for what MCP tools exist. |
+| `ccw/src/tools/session-manager.ts` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Session Information` ; ts: `ccw/src/tools/session-manager.ts` / `const ACTIVE_BASE = '.workflow/active';` | `Test-Path ccw/src/tools/session-manager.ts; rg \"const ACTIVE_BASE = '.workflow/active';\" ccw/src/tools/session-manager.ts` | Session + `.process` routing for `.workflow/active/{session}` artifacts. |
+| `.workflow/active/{test_session_id}/.process/test-context-package.json` | Planned | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Output Requirements` ; ts: `ccw/src/tools/session-manager.ts` / `process: '{base}/.process/{filename}',` | `Test-Path .workflow/active/WFS-test-auth/.process/test-context-package.json` | Output artifact produced/reused by the command. |
+
+## Implementation Hints (Tooling/Server)
+
+- If updating the agent doc away from `codex_lens`, prefer `mcp__ccw-tools__smart_search` for file discovery and symbol search (and/or `codex_lens_lsp` for LSP-backed symbol operations).
+- When documenting filesystem artifacts under `.workflow/active/{session}`, align examples to `session_manager` routing conventions (`content_type="process"`, `path_params.filename="test-context-package.json"`) when possible.
+
+## Proposed Fix Plan (Minimal)
+
+See `fix-plan.md`.
+
diff --git a/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-agent-outline.md b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-agent-outline.md
new file mode 100644
index 0000000000000000000000000000000000000000..1c7ded5ffec1679358626e171fcc740a8c54dfb8
--- /dev/null
+++ b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-agent-outline.md
@@ -0,0 +1,32 @@
+# Agent Outline: workflow:tools:test-context-gather
+
+## Purpose
+
+Implement and/or evolve the slash command according to CCW conventions with minimal regressions.
+
+## Execution Model
+
+- Default: incremental, testable changes
+- Use ACE-tool to find existing patterns before adding new abstractions
+
+## State & Artifacts
+
+- Session folder (existing CCW convention): `.workflow/active/{test_session_id}/...`
+- Required outputs:
+  - Slash MD (command doc): `.claude/commands/workflow/tools/test-context-gather.md`
+  - Subagent doc (invoked by Task): `.codex/agents/test-context-search-agent.md`
+  - Output artifact: `.workflow/active/{test_session_id}/.process/test-context-package.json`
+
+## Tooling
+
+- Allowed tools: Task(*), Read(*), Glob(*)
+- Non-negotiables:
+  - no unrelated changes
+  - verify non-regression against completed corpus
+
+## Validation Strategy
+
+- P0 gates: frontmatter + allowed-tools + core sections + artifact references
+- Deterministic evidence gate: ensure evidence tables in outline/gap-report cite both `.claude/commands/**.md` headings and `ccw/src/**` anchors
+- Regression: compare against snapshots for already-completed commands (if enabled in this cycle)
+
diff --git a/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-slash-outline.md b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-slash-outline.md
new file mode 100644
index 0000000000000000000000000000000000000000..738073d504c173686626740b2b4af4c5c9b2ed9b
--- /dev/null
+++ b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-slash-outline.md
@@ -0,0 +1,89 @@
+---
+name: test-context-gather
+description: Collect test coverage context using test-context-search-agent and package into standardized test-context JSON
+argument-hint: "--session WFS-test-session-id"
+allowed-tools: Task(*), Read(*), Glob(*)
+group: workflow:tools
+---
+
+# Test Context Gather
+
+## Overview
+
+- Goal: Gather reusable test coverage + framework context for a test session; return an existing valid package when present, otherwise invoke `test-context-search-agent` and write a standardized `test-context-package.json`.
+- Command: `/workflow:tools:test-context-gather`
+
+## Usage
+
+```bash
+/workflow:tools:test-context-gather --session WFS-test-session-id
+```
+
+## Inputs
+
+- Required inputs:
+  - `--session <test_session_id>` (e.g. `WFS-test-auth`)
+- Optional inputs:
+  - none
+
+## Outputs / Artifacts
+
+- Writes:
+  - `.workflow/active/{test_session_id}/.process/test-context-package.json`
+- Reads:
+  - `.workflow/active/{test_session_id}/workflow-session.json` (session metadata)
+  - `.workflow/active/{test_session_id}/.process/test-context-package.json` (detection-first early exit)
+
+## Implementation Pointers
+
+- Command doc: `.claude/commands/workflow/tools/test-context-gather.md`
+- Likely code locations:
+  - `.codex/agents/test-context-search-agent.md` (subagent behavior + output schema details)
+  - `ccw/src/tools/session-manager.ts` (canonical `.workflow/active/{session}` + `.process/{filename}` routing)
+  - `ccw/src/tools/index.ts` (tool registry: smart_search replaces codex_lens; impacts agent tool calls)
+
+### Evidence (Existing vs Planned)
+
+You MUST label each pointer as `Existing` (verifiable in repo now) or `Planned` (will be created/modified).
+
+Rules:
+- `Existing` MUST include evidence from BOTH:
+  - a command doc source: `.claude/commands/**.md` (section heading is sufficient)
+  - a TypeScript source: `ccw/src/**` (function name / subcommand case / a ripgrep-able string)
+- If you cannot verify, downgrade to `Planned` and add a concrete `Verify` step (e.g. `Test-Path <path>`, `rg "<pattern>" <path>`).
+
+| Pointer | Status | Evidence (docs + TS) | Verify | Why |
+|---|---|---|---|---|
+| `.claude/commands/workflow/tools/test-context-gather.md` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Overview` ; ts: `ccw/src/tools/session-manager.ts` / `process: '{base}/.process/{filename}',` | `Test-Path .claude/commands/workflow/tools/test-context-gather.md` | Oracle command doc (headings, flow, artifacts). |
+| `.codex/agents/test-context-search-agent.md` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Mission` ; ts: `ccw/src/tools/index.ts` / `// codex_lens removed - functionality integrated into smart_search` | `Test-Path .codex/agents/test-context-search-agent.md; rg "mcp__ccw-tools__codex_lens" .codex/agents/test-context-search-agent.md` | Subagent definition invoked by the command; ensure tool calls match current CCW tool registry. |
+| `ccw/src/tools/session-manager.ts` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Session Information` ; ts: `ccw/src/tools/session-manager.ts` / `const ACTIVE_BASE = '.workflow/active';` | `Test-Path ccw/src/tools/session-manager.ts; rg "const ACTIVE_BASE = '.workflow/active';" ccw/src/tools/session-manager.ts` | Canonical session + `.process` path conventions for `.workflow/active/{test_session_id}/...`. |
+| `.workflow/active/{test_session_id}/.process/test-context-package.json` | Planned | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Output Requirements` ; ts: `ccw/src/tools/session-manager.ts` / `process: '{base}/.process/{filename}',` | `Test-Path .workflow/active/WFS-test-auth/.process/test-context-package.json` | Primary output artifact produced (or reused) by the command. |
+
+Notes:
+- For TS evidence, anchors are literal substrings that must exist in the file now.
+
+## Execution Process
+
+1. Parse inputs: require `--session <test_session_id>`.
+2. Detection-first:
+   - If `.workflow/active/{test_session_id}/.process/test-context-package.json` exists and is valid, return it (no agent invocation).
+3. Invoke subagent:
+   - `Task(subagent_type="test-context-search-agent", ...)` to run the three mission phases:
+     - Phase 1: Session validation + source context loading
+     - Phase 2: Test coverage analysis
+     - Phase 3: Framework detection + packaging
+4. Output verification:
+   - Confirm `test-context-package.json` exists and has required top-level fields (metadata/source_context/assets).
+
+## Error Handling
+
+- Missing `--session`: fail fast with usage hint.
+- Session metadata missing/invalid: report that the test session cannot be validated.
+- Source session not found / no summaries: instruct to complete the source session first (or fix source reference in test session metadata).
+- Package generation failure: surface subagent failure and point to expected output path for manual inspection.
+
+## Examples
+
+- Collect test context for an existing test session:
+  - `/workflow:tools:test-context-gather --session WFS-test-auth`
+
diff --git a/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/references.json b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/references.json
new file mode 100644
index 0000000000000000000000000000000000000000..9dc60541084e1858d5a87af3e6792f02bc9657da
--- /dev/null
+++ b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/references.json
@@ -0,0 +1,40 @@
+{
+  "candidates": [
+    {
+      "slash": "/workflow:tools:test-context-gather",
+      "file_path": ".claude/commands/workflow/tools/test-context-gather.md",
+      "score": 1.0,
+      "why": "Exact oracle command doc for the requested behavior, headings, artifacts, and agent invocation flow."
+    },
+    {
+      "slash": "/workflow:tools:context-gather",
+      "file_path": ".claude/commands/workflow/tools/context-gather.md",
+      "score": 0.9,
+      "why": "Closest orchestrator pattern (detection-first + Task subagent + standardized package write under .workflow/active/{session}/.process)."
+    },
+    {
+      "slash": "/workflow:tools:tdd-coverage-analysis",
+      "file_path": ".claude/commands/workflow/tools/tdd-coverage-analysis.md",
+      "score": 0.8,
+      "why": "Coverage-oriented analysis patterns and validation steps that align with 'coverage-first' philosophy."
+    },
+    {
+      "slash": "/workflow:tools:test-concept-enhanced",
+      "file_path": ".claude/commands/workflow/tools/test-concept-enhanced.md",
+      "score": 0.75,
+      "why": "Test workflow tool with structured outputs and integration points in the test pipeline."
+    },
+    {
+      "slash": "/workflow:tools:test-task-generate",
+      "file_path": ".claude/commands/workflow/tools/test-task-generate.md",
+      "score": 0.7,
+      "why": "Downstream consumer of test-context packages; useful to keep output schema/artifacts compatible."
+    }
+  ],
+  "selected": {
+    "slash": "/workflow:tools:test-context-gather",
+    "file_path": ".claude/commands/workflow/tools/test-context-gather.md",
+    "why": "Use the dedicated command doc as the primary oracle, then gap-check against tooling (ccw/src/tools registry + session_manager routing)."
+  }
+}
+
diff --git a/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/spec.json b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/spec.json
new file mode 100644
index 0000000000000000000000000000000000000000..a982b1ac509c227d322f218580fa26275cc75679
--- /dev/null
+++ b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/spec.json
@@ -0,0 +1,39 @@
+{
+  "command": {
+    "group": "workflow:tools",
+    "name": "test-context-gather",
+    "description": "Collect test coverage context using test-context-search-agent and package into standardized test-context JSON",
+    "argument_hint": "--session WFS-test-session-id",
+    "allowed_tools": ["Task(*)", "Read(*)", "Glob(*)"]
+  },
+  "intent": {
+    "type": "utility",
+    "interaction": "single-shot",
+    "primary_user_value": "Gather reusable test coverage + framework context for a test session; return an existing valid package when present, otherwise invoke test-context-search-agent and write a standardized test-context-package.json."
+  },
+  "artifacts": {
+    "reads": [
+      ".workflow/active/{test_session_id}/workflow-session.json",
+      ".workflow/active/{test_session_id}/.process/test-context-package.json"
+    ],
+    "writes": [".workflow/active/{test_session_id}/.process/test-context-package.json"]
+  },
+  "constraints": {
+    "max_rounds": 1,
+    "time_budget_seconds": 0,
+    "must_not": [
+      "Do not claim implementation pointers are Existing unless verifiable in the repo now.",
+      "Evidence must be dual-source: docs (.claude/commands/**.md) + ts (ccw/src/**).",
+      "If unsure, mark pointers Planned and include concrete Verify steps."
+    ]
+  },
+  "acceptance": {
+    "p0": [
+      "Frontmatter valid: name/description/allowed-tools present; argument-hint included.",
+      "Allowed-tools matches behavior surface (Task, Read, Glob only).",
+      "Core sections present: Overview, Usage, Inputs, Outputs/Artifacts, Execution Process, Error Handling.",
+      "Writes standardized test-context package at .workflow/active/{test_session_id}/.process/test-context-package.json (or returns existing valid package)."
+    ]
+  }
+}
+


thinking
**Finalizing response details**

I need to make sure there are no extra files created. So, in my final response, I'll mention the files that were created and confirm that the evidence gate was passed with the node script. I should include the specific command referenced as `CMD-065`, just to keep everything clear and organized. It's important to be precise about this, to avoid any confusion for whoever reviews it later.
codex
Wrote CMD-065 outputs (per slash-command-outliner templates) to:
- `.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/spec.json`
- `.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/references.json`
- `.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-slash-outline.md`
- `.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-agent-outline.md`
- `.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/gap-report.md`
- `.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/fix-plan.md`

Deterministic evidence gate passed:
- `node .codex/skills/slash-command-outliner/scripts/verify-evidence.js --file=.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/gap-report.md --file=.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-slash-outline.md`
file update:
diff --git a/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/fix-plan.md b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/fix-plan.md
new file mode 100644
index 0000000000000000000000000000000000000000..9fa369cb80b2b8d6d6c698d572c459f639ba503f
--- /dev/null
+++ b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/fix-plan.md
@@ -0,0 +1,8 @@
+# Fix Plan: workflow:tools:test-context-gather (Minimal)
+
+1) P0 (docs/agent): Update `.codex/agents/test-context-search-agent.md` to replace `mcp__ccw-tools__codex_lens(...)` usage with currently-supported tooling (`mcp__ccw-tools__smart_search` and/or `codex_lens_lsp`). Add a brief note on the chosen replacement in the agentâ€™s Tool Arsenal section.
+
+2) P1 (docs/command): Normalize output path examples in `.claude/commands/workflow/tools/test-context-gather.md` to consistently use `.workflow/active/{test_session_id}/.process/test-context-package.json` (and keep the curly-brace placeholders consistent across sections).
+
+3) P1 (docs/command): Make the detection-first â€œvalid packageâ€ decision deterministic by listing a small required-key checklist (e.g. `metadata`, `source_context`, `assets`) under the command docâ€™s `Quality Validation` section.
+
diff --git a/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/gap-report.md b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/gap-report.md
new file mode 100644
index 0000000000000000000000000000000000000000..2d79a969cd90931108efe2be2f83788abb7472d5
--- /dev/null
+++ b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/gap-report.md
@@ -0,0 +1,48 @@
+# Gap Report: workflow:tools:test-context-gather
+
+## Reference
+
+- Selected reference: /workflow:tools:test-context-gather (`.claude/commands/workflow/tools/test-context-gather.md`)
+
+## P0 Gaps (Must Fix)
+
+- `test-context-search-agent` doc uses `mcp__ccw-tools__codex_lens(...)` calls, but CCW tool registry indicates `codex_lens` has been removed/integrated into `smart_search`. Align the agent doc tool calls to currently-registered tooling to avoid dead instructions.
+
+## P1 Gaps (Should Fix)
+
+- Output path inconsistency in command doc examples (`.workflow/${test_session_id}/...` vs `.workflow/active/{test_session_id}/...`) risks confusing callers and breaking â€œbroken artifact referenceâ€ checks in downstream tooling/docs.
+- â€œValid packageâ€ criteria is described conceptually; consider adding a small explicit checklist (required top-level keys) in the command docâ€™s Quality Validation section to make the detection-first decision deterministic.
+
+## P2 Gaps (Optional)
+
+- Clarify whether the command should prefer `session_manager` tool routing (`content_type="process"`) when writing/reading the package, or keep direct path reads/writes in the doc examples for simplicity.
+
+## Implementation Pointers (Evidence)
+
+You MUST provide an evidence table for all key implementation pointers mentioned in the outlines.
+
+Rules (P0):
+- Every pointer MUST be labeled `Existing` or `Planned`.
+- `Existing` MUST be verifiable (path exists). Include a concrete `Verify` command for each existing pointer.
+- Do NOT describe `Planned` pointers as â€œvalidated/existsâ€.
+- Evidence MUST reference BOTH sources somewhere in this section:
+  - command docs: `.claude/commands/**.md` (section heading is enough)
+  - TypeScript implementation: `ccw/src/**` (function name / subcommand case / ripgrep-able string)
+
+| Pointer | Status | Evidence | Verify | Notes |
+|---|---|---|---|---|
+| `.claude/commands/workflow/tools/test-context-gather.md` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Execution Flow` ; ts: `ccw/src/tools/session-manager.ts` / `process: '{base}/.process/{filename}',` | `Test-Path .claude/commands/workflow/tools/test-context-gather.md` | Oracle behavior/flow; keep outline aligned to headings and artifacts. |
+| `.codex/agents/test-context-search-agent.md` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Mission` ; ts: `ccw/src/tools/index.ts` / `// codex_lens removed - functionality integrated into smart_search` | `Test-Path .codex/agents/test-context-search-agent.md; rg "mcp__ccw-tools__codex_lens" .codex/agents/test-context-search-agent.md` | Needs tooling call alignment (codex_lens -> smart_search or codex_lens_lsp). |
+| `ccw/src/tools/index.ts` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Integration` ; ts: `ccw/src/tools/index.ts` / `// codex_lens removed - functionality integrated into smart_search` | `Test-Path ccw/src/tools/index.ts; rg \"codex_lens removed\" ccw/src/tools/index.ts` | Tool registry ground-truth for what MCP tools exist. |
+| `ccw/src/tools/session-manager.ts` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Session Information` ; ts: `ccw/src/tools/session-manager.ts` / `const ACTIVE_BASE = '.workflow/active';` | `Test-Path ccw/src/tools/session-manager.ts; rg \"const ACTIVE_BASE = '.workflow/active';\" ccw/src/tools/session-manager.ts` | Session + `.process` routing for `.workflow/active/{session}` artifacts. |
+| `.workflow/active/{test_session_id}/.process/test-context-package.json` | Planned | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Output Requirements` ; ts: `ccw/src/tools/session-manager.ts` / `process: '{base}/.process/{filename}',` | `Test-Path .workflow/active/WFS-test-auth/.process/test-context-package.json` | Output artifact produced/reused by the command. |
+
+## Implementation Hints (Tooling/Server)
+
+- If updating the agent doc away from `codex_lens`, prefer `mcp__ccw-tools__smart_search` for file discovery and symbol search (and/or `codex_lens_lsp` for LSP-backed symbol operations).
+- When documenting filesystem artifacts under `.workflow/active/{session}`, align examples to `session_manager` routing conventions (`content_type="process"`, `path_params.filename="test-context-package.json"`) when possible.
+
+## Proposed Fix Plan (Minimal)
+
+See `fix-plan.md`.
+
diff --git a/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-agent-outline.md b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-agent-outline.md
new file mode 100644
index 0000000000000000000000000000000000000000..1c7ded5ffec1679358626e171fcc740a8c54dfb8
--- /dev/null
+++ b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-agent-outline.md
@@ -0,0 +1,32 @@
+# Agent Outline: workflow:tools:test-context-gather
+
+## Purpose
+
+Implement and/or evolve the slash command according to CCW conventions with minimal regressions.
+
+## Execution Model
+
+- Default: incremental, testable changes
+- Use ACE-tool to find existing patterns before adding new abstractions
+
+## State & Artifacts
+
+- Session folder (existing CCW convention): `.workflow/active/{test_session_id}/...`
+- Required outputs:
+  - Slash MD (command doc): `.claude/commands/workflow/tools/test-context-gather.md`
+  - Subagent doc (invoked by Task): `.codex/agents/test-context-search-agent.md`
+  - Output artifact: `.workflow/active/{test_session_id}/.process/test-context-package.json`
+
+## Tooling
+
+- Allowed tools: Task(*), Read(*), Glob(*)
+- Non-negotiables:
+  - no unrelated changes
+  - verify non-regression against completed corpus
+
+## Validation Strategy
+
+- P0 gates: frontmatter + allowed-tools + core sections + artifact references
+- Deterministic evidence gate: ensure evidence tables in outline/gap-report cite both `.claude/commands/**.md` headings and `ccw/src/**` anchors
+- Regression: compare against snapshots for already-completed commands (if enabled in this cycle)
+
diff --git a/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-slash-outline.md b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-slash-outline.md
new file mode 100644
index 0000000000000000000000000000000000000000..738073d504c173686626740b2b4af4c5c9b2ed9b
--- /dev/null
+++ b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/generated-slash-outline.md
@@ -0,0 +1,89 @@
+---
+name: test-context-gather
+description: Collect test coverage context using test-context-search-agent and package into standardized test-context JSON
+argument-hint: "--session WFS-test-session-id"
+allowed-tools: Task(*), Read(*), Glob(*)
+group: workflow:tools
+---
+
+# Test Context Gather
+
+## Overview
+
+- Goal: Gather reusable test coverage + framework context for a test session; return an existing valid package when present, otherwise invoke `test-context-search-agent` and write a standardized `test-context-package.json`.
+- Command: `/workflow:tools:test-context-gather`
+
+## Usage
+
+```bash
+/workflow:tools:test-context-gather --session WFS-test-session-id
+```
+
+## Inputs
+
+- Required inputs:
+  - `--session <test_session_id>` (e.g. `WFS-test-auth`)
+- Optional inputs:
+  - none
+
+## Outputs / Artifacts
+
+- Writes:
+  - `.workflow/active/{test_session_id}/.process/test-context-package.json`
+- Reads:
+  - `.workflow/active/{test_session_id}/workflow-session.json` (session metadata)
+  - `.workflow/active/{test_session_id}/.process/test-context-package.json` (detection-first early exit)
+
+## Implementation Pointers
+
+- Command doc: `.claude/commands/workflow/tools/test-context-gather.md`
+- Likely code locations:
+  - `.codex/agents/test-context-search-agent.md` (subagent behavior + output schema details)
+  - `ccw/src/tools/session-manager.ts` (canonical `.workflow/active/{session}` + `.process/{filename}` routing)
+  - `ccw/src/tools/index.ts` (tool registry: smart_search replaces codex_lens; impacts agent tool calls)
+
+### Evidence (Existing vs Planned)
+
+You MUST label each pointer as `Existing` (verifiable in repo now) or `Planned` (will be created/modified).
+
+Rules:
+- `Existing` MUST include evidence from BOTH:
+  - a command doc source: `.claude/commands/**.md` (section heading is sufficient)
+  - a TypeScript source: `ccw/src/**` (function name / subcommand case / a ripgrep-able string)
+- If you cannot verify, downgrade to `Planned` and add a concrete `Verify` step (e.g. `Test-Path <path>`, `rg "<pattern>" <path>`).
+
+| Pointer | Status | Evidence (docs + TS) | Verify | Why |
+|---|---|---|---|---|
+| `.claude/commands/workflow/tools/test-context-gather.md` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Overview` ; ts: `ccw/src/tools/session-manager.ts` / `process: '{base}/.process/{filename}',` | `Test-Path .claude/commands/workflow/tools/test-context-gather.md` | Oracle command doc (headings, flow, artifacts). |
+| `.codex/agents/test-context-search-agent.md` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Mission` ; ts: `ccw/src/tools/index.ts` / `// codex_lens removed - functionality integrated into smart_search` | `Test-Path .codex/agents/test-context-search-agent.md; rg "mcp__ccw-tools__codex_lens" .codex/agents/test-context-search-agent.md` | Subagent definition invoked by the command; ensure tool calls match current CCW tool registry. |
+| `ccw/src/tools/session-manager.ts` | Existing | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Session Information` ; ts: `ccw/src/tools/session-manager.ts` / `const ACTIVE_BASE = '.workflow/active';` | `Test-Path ccw/src/tools/session-manager.ts; rg "const ACTIVE_BASE = '.workflow/active';" ccw/src/tools/session-manager.ts` | Canonical session + `.process` path conventions for `.workflow/active/{test_session_id}/...`. |
+| `.workflow/active/{test_session_id}/.process/test-context-package.json` | Planned | docs: `.claude/commands/workflow/tools/test-context-gather.md` / `Output Requirements` ; ts: `ccw/src/tools/session-manager.ts` / `process: '{base}/.process/{filename}',` | `Test-Path .workflow/active/WFS-test-auth/.process/test-context-package.json` | Primary output artifact produced (or reused) by the command. |
+
+Notes:
+- For TS evidence, anchors are literal substrings that must exist in the file now.
+
+## Execution Process
+
+1. Parse inputs: require `--session <test_session_id>`.
+2. Detection-first:
+   - If `.workflow/active/{test_session_id}/.process/test-context-package.json` exists and is valid, return it (no agent invocation).
+3. Invoke subagent:
+   - `Task(subagent_type="test-context-search-agent", ...)` to run the three mission phases:
+     - Phase 1: Session validation + source context loading
+     - Phase 2: Test coverage analysis
+     - Phase 3: Framework detection + packaging
+4. Output verification:
+   - Confirm `test-context-package.json` exists and has required top-level fields (metadata/source_context/assets).
+
+## Error Handling
+
+- Missing `--session`: fail fast with usage hint.
+- Session metadata missing/invalid: report that the test session cannot be validated.
+- Source session not found / no summaries: instruct to complete the source session first (or fix source reference in test session metadata).
+- Package generation failure: surface subagent failure and point to expected output path for manual inspection.
+
+## Examples
+
+- Collect test context for an existing test session:
+  - `/workflow:tools:test-context-gather --session WFS-test-auth`
+
diff --git a/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/references.json b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/references.json
new file mode 100644
index 0000000000000000000000000000000000000000..9dc60541084e1858d5a87af3e6792f02bc9657da
--- /dev/null
+++ b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/references.json
@@ -0,0 +1,40 @@
+{
+  "candidates": [
+    {
+      "slash": "/workflow:tools:test-context-gather",
+      "file_path": ".claude/commands/workflow/tools/test-context-gather.md",
+      "score": 1.0,
+      "why": "Exact oracle command doc for the requested behavior, headings, artifacts, and agent invocation flow."
+    },
+    {
+      "slash": "/workflow:tools:context-gather",
+      "file_path": ".claude/commands/workflow/tools/context-gather.md",
+      "score": 0.9,
+      "why": "Closest orchestrator pattern (detection-first + Task subagent + standardized package write under .workflow/active/{session}/.process)."
+    },
+    {
+      "slash": "/workflow:tools:tdd-coverage-analysis",
+      "file_path": ".claude/commands/workflow/tools/tdd-coverage-analysis.md",
+      "score": 0.8,
+      "why": "Coverage-oriented analysis patterns and validation steps that align with 'coverage-first' philosophy."
+    },
+    {
+      "slash": "/workflow:tools:test-concept-enhanced",
+      "file_path": ".claude/commands/workflow/tools/test-concept-enhanced.md",
+      "score": 0.75,
+      "why": "Test workflow tool with structured outputs and integration points in the test pipeline."
+    },
+    {
+      "slash": "/workflow:tools:test-task-generate",
+      "file_path": ".claude/commands/workflow/tools/test-task-generate.md",
+      "score": 0.7,
+      "why": "Downstream consumer of test-context packages; useful to keep output schema/artifacts compatible."
+    }
+  ],
+  "selected": {
+    "slash": "/workflow:tools:test-context-gather",
+    "file_path": ".claude/commands/workflow/tools/test-context-gather.md",
+    "why": "Use the dedicated command doc as the primary oracle, then gap-check against tooling (ccw/src/tools registry + session_manager routing)."
+  }
+}
+
diff --git a/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/spec.json b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/spec.json
new file mode 100644
index 0000000000000000000000000000000000000000..a982b1ac509c227d322f218580fa26275cc75679
--- /dev/null
+++ b/.workflow/.cycle/cycle-auto-20260205T010617-slashcmdoutliner-codex.progress/llm/CMD-065/specs/outputs/spec.json
@@ -0,0 +1,39 @@
+{
+  "command": {
+    "group": "workflow:tools",
+    "name": "test-context-gather",
+    "description": "Collect test coverage context using test-context-search-agent and package into standardized test-context JSON",
+    "argument_hint": "--session WFS-test-session-id",
+    "allowed_tools": ["Task(*)", "Read(*)", "Glob(*)"]
+  },
+  "intent": {
+    "type": "utility",
+    "interaction": "single-shot",
+    "primary_user_value": "Gather reusable test coverage + framework context for a test session; return an existing valid package when present, otherwise invoke test-context-search-agent and write a standardized test-context-package.json."
+  },
+  "artifacts": {
+    "reads": [
+      ".workflow/active/{test_session_id}/workflow-session.json",
+      ".workflow/active/{test_session_id}/.process/test-context-package.json"
+    ],
+    "writes": [".workflow/active/{test_session_id}/.process/test-context-package.json"]
+  },
+  "constraints": {
+    "max_rounds": 1,
+    "time_budget_seconds": 0,
+    "must_not": [
+      "Do not claim implementation pointers are Existing unless verifiable in the repo now.",
+      "Evidence must be dual-source: docs (.claude/commands/**.md) + ts (ccw/src/**).",
+      "If unsure, mark pointers Planned and include concrete Verify steps."
+    ]
+  },
+  "acceptance": {
+    "p0": [
+      "Frontmatter valid: name/description/allowed-tools present; argument-hint included.",
+      "Allowed-tools matches behavior surface (Task, Read, Glob only).",
+      "Core sections present: Overview, Usage, Inputs, Outputs/Artifacts, Execution Process, Error Handling.",
+      "Writes standardized test-context package at .workflow/active/{test_session_id}/.process/test-context-package.json (or returns existing valid package)."
+    ]
+  }
+}
+

tokens used
91,676
