# Requirement (non-leaky): /ccw-plan

## Source

- Command doc (oracle, do not paste full contents into spec): `.claude/commands/ccw-plan.md`

## Command Identity

- group: (none)
- name: ccw-plan
- description: Planning coordinator - analyze requirements, select planning strategy, execute planning workflow in main process
- argument-hint: [--mode lite|multi-cli|full|plan-verify|replan|cli|issue|rapid-to-issue|brainstorm-with-file|analyze-with-file] [--yes|-y] \"task description\"
- allowed-tools: Skill(*), TodoWrite(*), AskUserQuestion(*), Read(*), Grep(*), Glob(*)

## Structure Hints (Headings Only)

- CCW-Plan Command - Planning Coordinator
  - Core Concept: Planning Units (规划单元)
  - Execution Model
  - 5-Phase Workflow
    - Phase 1: Analyze Requirements
    - Phase 1.5: Requirement Clarification (if clarity < 2)
    - Phase 2: Select Planning Strategy & Build Command Chain
      - Mode Detection (Priority Order)
      - Command Chain Mapping
    - Phase 3: User Confirmation
    - Phase 4: Setup TODO Tracking & Status File
    - Phase 5: Execute Planning Chain
      - For Plan-Verify Mode (Quality Gate)
      - Error Handling Pattern
  - Planning Pipeline Examples
  - State Management
    - Dual Tracking System
  - Extended Planning Modes
    - CLI-Assisted Planning (cli mode)
    - With-File Planning Workflows
    - Issue Workflow Integration
  - Key Design Principles
  - Usage
- Auto-select mode (keyword-based detection)
- Standard planning modes
- CLI-assisted planning (quick recommendations)
- With-File workflows (multi-CLI collaboration)
- Issue workflow integration
- Auto mode (skip confirmations)
  - Mode Selection Decision Tree

## Hard Constraints (P0)

- Do not claim a pointer is `Existing` unless it is verifiable in the repo now.
- Evidence must be dual-source: docs (.claude/commands/**.md) + ts (ccw/src/**).
- If unsure, mark as `Planned` and add a concrete `Verify` step.
