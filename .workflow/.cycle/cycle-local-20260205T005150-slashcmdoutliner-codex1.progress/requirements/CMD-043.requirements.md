# Requirement (non-leaky): /workflow:plan

## Source

- Command doc (oracle, do not paste full contents into spec): `.claude/commands/workflow/plan.md`

## Command Identity

- group: workflow
- name: plan
- description: 5-phase planning workflow with action-planning-agent task generation, outputs IMPL_PLAN.md and task JSONs
- argument-hint: [-y|--yes] \"text description\"|file.md
- allowed-tools: Skill(*), TodoWrite(*), Read(*), Bash(*)

## Structure Hints (Headings Only)

  - Auto Mode
- Workflow Plan Command (/workflow:plan)
  - Coordinator Role
  - Core Rules
  - Execution Process
  - 5-Phase Execution
    - Phase 1: Session Discovery
  - User Intent (Phase 1)
  - Context Findings (Phase 2)
  - Conflict Decisions (Phase 3)
  - Consolidated Constraints (Phase 4 Input)
  - Task Generation (Phase 4)
  - N+1 Context
    - Decisions
    - Deferred
    - Phase 2: Context Gathering
    - Phase 3: Conflict Resolution
    - Phase 3.5: Pre-Task Generation Validation (Optional Quality Gate)
    - Phase 4: Task Generation
  - TodoWrite Pattern
    - Key Principles
  - Input Processing
  - Data Flow
  - Execution Flow Diagram
  - Error Handling
  - Coordinator Checklist
  - Structure Template Reference
- Phase 1
- Phase 2
  - Related Commands

## Hard Constraints (P0)

- Do not claim a pointer is `Existing` unless it is verifiable in the repo now.
- Evidence must be dual-source: docs (.claude/commands/**.md) + ts (ccw/src/**).
- If unsure, mark as `Planned` and add a concrete `Verify` step.
