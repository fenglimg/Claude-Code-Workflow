# Requirement (non-leaky): /workflow:animation-extract

## Source

- Command doc (oracle, do not paste full contents into spec): `.claude/commands/workflow/ui-design/animation-extract.md`

## Command Identity

- group: workflow
- name: animation-extract
- description: Extract animation and transition patterns from prompt inference and image references for design system documentation
- argument-hint: [-y|--yes] [--design-id <id>] [--session <id>] [--images "<glob>"] [--focus "<types>"] [--interactive] [--refine]
- allowed-tools: TodoWrite(*), Read(*), Write(*), Glob(*), Bash(*), AskUserQuestion(*), Task(ui-design-agent)

## Structure Hints (Headings Only)

  - Auto Mode
- Animation Extraction Command
  - Overview
  - Execution Process
  - Phase 0: Setup & Input Validation
    - Step 1: Detect Input Mode & Base Path
- Detect input source
- Priority: --images → visual references available | no --images → prompt-only mode
- Parse images if provided (glob pattern)
- Parse animation focus (if provided)
- Check interactive mode flag
- Check refinement mode flag
- Determine base path with priority: --design-id > --session > auto-detect
- Validate and convert to absolute path
    - Step 2: Prepare Image References (If Available)
- Load image references if provided
    - Step 3: Load Design Tokens Context
- Load existing design tokens for duration/easing alignment
- Create output directory
    - Step 4: Memory Check
- Check if output already exists
  - Phase 1: Animation Specification Generation
    - Step 1: Load Project Context
- Load brainstorming context if available
- Load image references if available
    - Step 2: Generate Animation Specification Options (Agent Task 1)
    - Step 3: Verify Options File Created
  - Phase 1.5: User Confirmation (Optional - Triggered by --interactive)
    - Step 1: Check Interactive Flag
- Skip this entire phase if --interactive flag is not present
    - Step 2: Load and Present Options
- Read options file based on mode
    - Step 3: Present Options to User
    - Step 4: Capture User Selection
    - Step 5: Update Options File with User Selection
    - Step 6: Confirmation Message
  - Phase 2: Animation System Generation (Agent Task 2)
    - Step 1: Load User Selection or Use Defaults
- Load image references if available for agent context
    - Step 2: Create Output Directory
- Create directory for animation system
    - Step 3: Launch Animation Generation Task
  - Phase 3: Verify Output
    - Step 1: Check Files Created
- Verify animation system created
- Validate structure
    - Step 2: Verify File Sizes
  - Completion
    - Todo Update
    - Output Message
  - Simple Bash Commands
    - Path Operations
- Find design directory
- Create output directories
    - Validation Commands
- Check if already extracted
- Validate JSON structure
- Count animation types
    - File Operations
- Load design tokens context
- Verify output
  - Output Structure
  - animation-tokens.json Format
  - Error Handling
    - Common Errors
    - Recovery Strategies
  - Key Features

## Hard Constraints (P0)

- Do not claim a pointer is `Existing` unless it is verifiable in the repo now.
- Evidence must be dual-source: docs (.claude/commands/**.md) + ts (ccw/src/**).
- If unsure, mark as `Planned` and add a concrete `Verify` step.
