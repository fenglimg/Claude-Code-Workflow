# Requirement (non-leaky): /workflow:generate

## Source

- Command doc (oracle, do not paste full contents into spec): `.claude/commands/workflow/ui-design/generate.md`

## Command Identity

- group: workflow
- name: generate
- description: Assemble UI prototypes by combining layout templates with design tokens (default animation support), pure assembler without new content generation
- argument-hint: [--design-id <id>] [--session <id>]
- allowed-tools: TodoWrite(*), Read(*), Write(*), Task(ui-design-agent), Bash(*)

## Structure Hints (Headings Only)

- Generate UI Prototypes (/workflow:ui-design:generate)
  - Overview
  - Execution Process
  - Phase 1: Setup & Validation
    - Step 1: Resolve Base Path & Parse Configuration
- Determine base path with priority: --design-id > --session > auto-detect
- Validate and convert to absolute path
- Get style count
- Image reference auto-detected from layout template source_image_path
    - Step 2: Load Layout Templates
- Check layout templates exist (multi-file pattern)
- Get list of all layout files
- Load each layout template file
- Aggregate: targets[], layout_variants count, device_type, all template structures
    - Step 3: Validate Design Tokens
- Check design tokens exist for all styles
- For each style variant: Load design tokens
    - Step 4: Load Animation Tokens (Optional)
- Check if animation tokens exist
- Load animation tokens if available
  - Phase 2: Assembly (Agent)
    - Agent Grouping Strategy
- First 'remainder' agents get (base_count + 1), others get base_count
    - Step 1: Calculate Agent Grouping Plan
    - Step 2: Launch Batched Assembly Tasks
- After each batch completes
    - Step 3: Verify Generated Files
- Count expected vs found (should equal S × L × T)
- Validate samples
- Check: <!DOCTYPE html>, correct CSS href, sufficient CSS length
  - Phase 3: Generate Preview Files
    - Step 1: Run Preview Generation Script
    - Step 2: Verify Preview Files
  - Completion
    - Todo Update
    - Output Message
  - Simple Bash Commands
    - Path Operations
- Find design directory
- Count style variants
    - Validation Commands
- Check layout templates exist (multi-file pattern)
- Count layout files
- Check design tokens exist
- Count generated files
- Verify preview
    - File Operations
- Create directories
- Run preview script
  - Output Structure
  - Error Handling
    - Common Errors
    - Recovery Strategies
  - Quality Checklist
  - Key Features
  - Integration

## Hard Constraints (P0)

- Do not claim a pointer is `Existing` unless it is verifiable in the repo now.
- Evidence must be dual-source: docs (.claude/commands/**.md) + ts (ccw/src/**).
- If unsure, mark as `Planned` and add a concrete `Verify` step.
